!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("canvas")):"function"==typeof define&&define.amd?define(["canvas"],factory):"object"==typeof exports?exports.ImglyKit=factory(require("canvas")):root.ImglyKit=factory(root.canvas)}(this,function(__WEBPACK_EXTERNAL_MODULE_53__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_libRenderImage=__webpack_require__(2),_libRenderImage2=_interopRequireDefault(_libRenderImage),_libImageExporter=__webpack_require__(3),_libImageExporter2=_interopRequireDefault(_libImageExporter),_libVersionChecker=__webpack_require__(4),_libVersionChecker2=_interopRequireDefault(_libVersionChecker),_constants=__webpack_require__(5),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),VERSION="2.0.0-beta.13",ImglyKit=function(){function ImglyKit(options){if(_classCallCheck(this,ImglyKit),"undefined"==typeof options)throw new Error("No options given.");if(options=_lodash2["default"].defaults(options,{assetsUrl:"assets",container:null,renderOnWindowResize:!1}),options.ui=options.ui||{},options.ui=_lodash2["default"].defaults(options.ui,{enabled:!0}),"undefined"==typeof options.image&&!options.ui.enabled)throw new Error("`options.image` needs to be set when UI is disabled.");this._options=options,this.operationsStack=[],this._registeredUIs={},this._registerUIs(),this._registeredOperations={},this._registerOperations(),"undefined"!=typeof window&&(this._versionChecker=new _libVersionChecker2["default"](VERSION)),this._options.ui.enabled&&(this._initUI(),this._options.renderOnWindowResize&&this._handleWindowResize())}return _createClass(ImglyKit,[{key:"render",value:function(renderType,imageFormat,dimensions,quality){var _this=this,settings=_libImageExporter2["default"].validateSettings(renderType,imageFormat);renderType=settings.renderType,imageFormat=settings.imageFormat;for(var renderImage=new _libRenderImage2["default"](this._options.image,this.operationsStack,dimensions,this._options.renderer),i=0;i<this.operationsStack.length;i++){var operation=this.operationsStack[i];operation&&(operation.dirty=!0)}return renderImage.render().then(function(){var canvas=renderImage.getRenderer().getCanvas();return _libImageExporter2["default"]["export"](_this._options.image,canvas,renderType,imageFormat,quality)})}},{key:"reset",value:function(){}},{key:"getAssetPath",value:function(asset){var isBrowser="undefined"!=typeof window;if(isBrowser)return this._options.assetsUrl+"/"+asset;var path=__webpack_require__(52);return path.resolve(this._options.assetsUrl,asset)}},{key:"_handleWindowResize",value:function(){var _this2=this,timer=null;window.addEventListener("resize",function(){null!==timer&&clearTimeout(timer),timer=setTimeout(function(){timer=null,_this2.ui.render()},300)})}},{key:"_registerUIs",value:function(){this.registerUI(ImglyKit.NightUI)}},{key:"_registerOperations",value:function(){for(var operationName in ImglyKit.Operations)this.registerOperation(ImglyKit.Operations[operationName])}},{key:"registerOperation",value:function(operation){this._registeredOperations[operation.prototype.identifier]=operation,this.ui&&this.ui.addOperation(operation)}},{key:"registerUI",value:function(ui){this._registeredUIs[ui.prototype.identifier]=ui}},{key:"_initUI",value:function(){var UI;this._options.ui.enabled===!0&&(UI=_libUtils2["default"].values(this._registeredUIs)[0]),UI&&(this.ui=new UI(this,this._options))}},{key:"getOperationFromStack",value:function(identifier){var operation=this.operationsStack.filter(function(operation){return operation.identifier===identifier})[0];return operation}},{key:"run",value:function(){"undefined"!=typeof this.ui&&this.ui.run()}},{key:"registeredOperations",get:function(){return this._registeredOperations}}]),ImglyKit}();ImglyKit.version=VERSION,ImglyKit.RenderImage=_libRenderImage2["default"],ImglyKit.Color=__webpack_require__(7),ImglyKit.Filter=__webpack_require__(8),ImglyKit.Operation=__webpack_require__(9),ImglyKit.Operations={},ImglyKit.Operations.Filters=__webpack_require__(10),ImglyKit.Operations.Crop=__webpack_require__(11),ImglyKit.Operations.Rotation=__webpack_require__(12),ImglyKit.Operations.Saturation=__webpack_require__(13),ImglyKit.Operations.Contrast=__webpack_require__(14),ImglyKit.Operations.Brightness=__webpack_require__(15),ImglyKit.Operations.Flip=__webpack_require__(16),ImglyKit.Operations.TiltShift=__webpack_require__(17),ImglyKit.Operations.RadialBlur=__webpack_require__(18),ImglyKit.Operations.Text=__webpack_require__(19),ImglyKit.Operations.Stickers=__webpack_require__(20),ImglyKit.Operations.Frames=__webpack_require__(21),ImglyKit.Filters={},ImglyKit.Filters.A15=__webpack_require__(22),ImglyKit.Filters.Breeze=__webpack_require__(23),ImglyKit.Filters.BW=__webpack_require__(24),ImglyKit.Filters.BWHard=__webpack_require__(25),ImglyKit.Filters.Celsius=__webpack_require__(26),ImglyKit.Filters.Chest=__webpack_require__(27),ImglyKit.Filters.Fixie=__webpack_require__(28),ImglyKit.Filters.Food=__webpack_require__(29),ImglyKit.Filters.Fridge=__webpack_require__(30),ImglyKit.Filters.Front=__webpack_require__(31),ImglyKit.Filters.Glam=__webpack_require__(32),ImglyKit.Filters.Gobblin=__webpack_require__(33),ImglyKit.Filters.K1=__webpack_require__(34),ImglyKit.Filters.K2=__webpack_require__(35),ImglyKit.Filters.K6=__webpack_require__(36),ImglyKit.Filters.KDynamic=__webpack_require__(37),ImglyKit.Filters.Lenin=__webpack_require__(38),ImglyKit.Filters.Lomo=__webpack_require__(39),ImglyKit.Filters.Mellow=__webpack_require__(40),ImglyKit.Filters.Morning=__webpack_require__(41),ImglyKit.Filters.Orchid=__webpack_require__(42),ImglyKit.Filters.Pola=__webpack_require__(43),ImglyKit.Filters.Pola669=__webpack_require__(44),ImglyKit.Filters.Quozi=__webpack_require__(45),ImglyKit.Filters.Semired=__webpack_require__(46),ImglyKit.Filters.Sunny=__webpack_require__(47),ImglyKit.Filters.Texas=__webpack_require__(48),ImglyKit.Filters.X400=__webpack_require__(49),ImglyKit.RenderType=_constants.RenderType,ImglyKit.ImageFormat=_constants.ImageFormat,ImglyKit.Vector2=__webpack_require__(50),ImglyKit.NightUI=__webpack_require__(51),exports["default"]=ImglyKit,module.exports=exports["default"]},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(module,global){"use strict";(function(){function slice(array,start,end){start||(start=0),"undefined"==typeof end&&(end=array?array.length:0);for(var index=-1,length=end-start||0,result=Array(0>length?0:length);++index<length;)result[index]=array[start+index];return result}function lodash(){}function baseBind(bindData){function bound(){if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if(this instanceof bound){var thisBinding=baseCreate(func.prototype),result=func.apply(thisBinding,args||arguments);return isObject(result)?result:thisBinding}return func.apply(thisArg,args||arguments)}var func=bindData[0],partialArgs=bindData[2],thisArg=bindData[4];return setBindData(bound,bindData),bound}function baseCreate(prototype,properties){return isObject(prototype)?nativeCreate(prototype):{}}function baseCreateCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if("undefined"==typeof thisArg||!("prototype"in func))return func;var bindData=func.__bindData__;if("undefined"==typeof bindData&&(support.funcNames&&(bindData=!func.name),bindData=bindData||!support.funcDecomp,!bindData)){var source=fnToString.call(func);support.funcNames||(bindData=!reFuncName.test(source)),bindData||(bindData=reThis.test(source),setBindData(func,bindData))}if(bindData===!1||bindData!==!0&&1&bindData[1])return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return bind(func,thisArg)}function baseCreateWrapper(bindData){function bound(){var thisBinding=isBind?thisArg:this;if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if((partialRightArgs||isCurry)&&(args||(args=slice(arguments)),partialRightArgs&&push.apply(args,partialRightArgs),isCurry&&args.length<arity))return bitmask|=16,baseCreateWrapper([func,isCurryBound?bitmask:-4&bitmask,args,null,thisArg,arity]);if(args||(args=arguments),isBindKey&&(func=thisBinding[key]),this instanceof bound){thisBinding=baseCreate(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}var func=bindData[0],bitmask=bindData[1],partialArgs=bindData[2],partialRightArgs=bindData[3],thisArg=bindData[4],arity=bindData[5],isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isCurryBound=8&bitmask,key=func;return setBindData(bound,bindData),bound}function createWrapper(_x,_x2,_x3,_x4,_x5,_x6){for(var _arguments=arguments,_again=!0;_again;){var func=_x,bitmask=_x2,partialArgs=_x3,partialRightArgs=_x4,thisArg=_x5,arity=_x6;isBind=isBindKey=isCurry=isCurryBound=isPartial=isPartialRight=bindData=creater=void 0,_again=!1;var isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isCurryBound=8&bitmask,isPartial=16&bitmask,isPartialRight=32&bitmask;if(!isBindKey&&!isFunction(func))throw new TypeError;isPartial&&!partialArgs.length&&(bitmask&=-17,isPartial=partialArgs=!1),isPartialRight&&!partialRightArgs.length&&(bitmask&=-33,isPartialRight=partialRightArgs=!1);var bindData=func&&func.__bindData__;if(!bindData||bindData===!0){var creater=1==bitmask||17===bitmask?baseBind:baseCreateWrapper;return creater([func,bitmask,partialArgs,partialRightArgs,thisArg,arity])}bindData=slice(bindData),bindData[2]&&(bindData[2]=slice(bindData[2])),bindData[3]&&(bindData[3]=slice(bindData[3])),!isBind||1&bindData[1]||(bindData[4]=thisArg),!isBind&&1&bindData[1]&&(bitmask|=8),!isCurry||4&bindData[1]||(bindData[5]=arity),isPartial&&push.apply(bindData[2]||(bindData[2]=[]),partialArgs),isPartialRight&&unshift.apply(bindData[3]||(bindData[3]=[]),partialRightArgs),bindData[1]|=bitmask,_arguments=bindData,_x=_arguments[0],_x2=_arguments[1],_x3=_arguments[2],_x4=_arguments[3],_x5=_arguments[4],_x6=_arguments[5],_again=!0}}function createIterator(){iteratorData.shadowedProps=shadowedProps,iteratorData.array=iteratorData.bottom=iteratorData.loop=iteratorData.top="",iteratorData.init="iterable",iteratorData.useHas=!0;for(var object,index=0;object=arguments[index];index++)for(var key in object)iteratorData[key]=object[key];var args=iteratorData.args;iteratorData.firstArg=/^[^,]+/.exec(args)[0];var factory=Function("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+args+") {\n"+iteratorTemplate(iteratorData)+"\n}");return factory(baseCreateCallback,errorClass,errorProto,hasOwnProperty,indicatorObject,isArguments,isArray,isString,iteratorData.keys,objectProto,objectTypes,nonEnumProps,stringClass,stringProto,toString)}function isNative(value){return"function"==typeof value&&reNative.test(value)}function isArguments(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==argsClass||!1}function isFunction(value){return"function"==typeof value}function isObject(value){return!(!value||!objectTypes[typeof value])}function isString(value){return"string"==typeof value||value&&"object"==typeof value&&toString.call(value)==stringClass||!1}function bind(func,thisArg){return arguments.length>2?createWrapper(func,17,slice(arguments,2),null,thisArg):createWrapper(func,1,null,null,thisArg)}function identity(value){return value}function noop(){}var indicatorObject={},reFuncName=/^\s*function[ \n\r\t]+\w/,reThis=/\bthis\b/,shadowedProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",errorClass="[object Error]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]",descriptor={configurable:!1,enumerable:!1,value:null,writable:!1},iteratorData={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},root=objectTypes[typeof window]&&window||this,freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=(freeModule&&freeModule.exports===freeExports&&freeExports,objectTypes[typeof global]&&global);!freeGlobal||freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal||(root=freeGlobal);var arrayRef=[],errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype,toString=objectProto.toString,reNative=RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,propertyIsEnumerable=objectProto.propertyIsEnumerable,unshift=arrayRef.unshift,defineProperty=function(){try{var o={},func=isNative(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}return result}(),nativeCreate=isNative(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,nonEnumProps={};nonEnumProps[arrayClass]=nonEnumProps[dateClass]=nonEnumProps[numberClass]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},nonEnumProps[boolClass]=nonEnumProps[stringClass]={constructor:!0,toString:!0,valueOf:!0},nonEnumProps[errorClass]=nonEnumProps[funcClass]=nonEnumProps[regexpClass]={constructor:!0,toString:!0},nonEnumProps[objectClass]={constructor:!0},function(){for(var length=shadowedProps.length;length--;){var key=shadowedProps[length];for(var className in nonEnumProps)hasOwnProperty.call(nonEnumProps,className)&&!hasOwnProperty.call(nonEnumProps[className],key)&&(nonEnumProps[className][key]=!1)}}();var support=lodash.support={};!function(){var ctor=function(){this.x=1},object={0:1,length:1},props=[];ctor.prototype={valueOf:1,y:1};for(var key in new ctor)props.push(key);for(key in arguments);support.argsClass=toString.call(arguments)==argsClass,support.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name"),support.enumPrototypes=propertyIsEnumerable.call(ctor,"prototype"),support.funcDecomp=!isNative(root.WinRTError)&&reThis.test(function(){return this}),support.funcNames="string"==typeof Function.name,support.nonEnumArgs=0!=key,support.nonEnumShadows=!/valueOf/.test(props),support.spliceObjects=(arrayRef.splice.call(object,0,1),!object[0]),support.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1);var iteratorTemplate=function(obj){var __p="var index, iterable = "+obj.firstArg+", result = "+obj.init+";\nif (!iterable) return result;\n"+obj.top+";";obj.array?(__p+="\nvar length = iterable.length; index = -1;\nif ("+obj.array+") {  ",support.unindexedChars&&(__p+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),__p+="\n  while (++index < length) {\n    "+obj.loop+";\n  }\n}\nelse {  "):support.nonEnumArgs&&(__p+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+obj.loop+";\n    }\n  } else {  "),support.enumPrototypes&&(__p+="\n  var skipProto = typeof iterable == 'function';\n  "),support.enumErrorProps&&(__p+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var conditions=[];if(support.enumPrototypes&&conditions.push('!(skipProto && index == "prototype")'),support.enumErrorProps&&conditions.push('!(skipErrorProps && (index == "message" || index == "name"))'),obj.useHas&&obj.keys)__p+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }  ";else if(__p+="\n  for (index in iterable) {\n",obj.useHas&&conditions.push("hasOwnProperty.call(iterable, index)"),conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }    ",support.nonEnumShadows){for(__p+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)__p+="\n    index = '"+obj.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",obj.useHas||(__p+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),__p+=") {\n      "+obj.loop+";\n    }      ";__p+="\n  }    "}return(obj.array||support.nonEnumArgs)&&(__p+="\n}"),__p+=obj.bottom+";\nreturn result"};nativeCreate||(baseCreate=function(){function Object(){}return function(prototype){if(isObject(prototype)){Object.prototype=prototype;var result=new Object;Object.prototype=null}return result||root.Object()}}());var setBindData=defineProperty?function(func,value){descriptor.value=value,defineProperty(func,"__bindData__",descriptor)}:noop;support.argsClass||(isArguments=function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")||!1});var isArray=nativeIsArray||function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==arrayClass||!1},shimKeys=createIterator({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),keys=nativeKeys?function(object){return isObject(object)?support.enumPrototypes&&"function"==typeof object||support.nonEnumArgs&&object.length&&isArguments(object)?shimKeys(object):nativeKeys(object):[]}:shimKeys,defaultsIteratorOptions={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:keys,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},assign=createIterator(defaultsIteratorOptions,{top:defaultsIteratorOptions.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),defaults=createIterator(defaultsIteratorOptions);isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&toString.call(value)==funcClass}),lodash.assign=assign,lodash.bind=bind,lodash.defaults=defaults,lodash.keys=keys,lodash.extend=assign,lodash.identity=identity,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isFunction=isFunction,lodash.isObject=isObject,lodash.isString=isString,lodash.noop=noop,lodash.VERSION="2.4.1",root._=lodash,__WEBPACK_AMD_DEFINE_RESULT__=function(){return lodash}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}).call(void 0)}).call(exports,__webpack_require__(93)(module),function(){return this}())},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_imageDimensions=__webpack_require__(54),_imageDimensions2=_interopRequireDefault(_imageDimensions),_mathVector2=__webpack_require__(50),_mathVector22=_interopRequireDefault(_mathVector2),_renderersCanvasRenderer=__webpack_require__(55),_renderersCanvasRenderer2=_interopRequireDefault(_renderersCanvasRenderer),_renderersWebglRenderer=__webpack_require__(56),_renderersWebglRenderer2=_interopRequireDefault(_renderersWebglRenderer),RenderImage=function(){function RenderImage(image,operationsStack,dimensions,preferredRenderer){_classCallCheck(this,RenderImage),this._options={preferredRenderer:preferredRenderer},this._webglEnabled=!1,this._renderer=null,this._image=image,this._stack=operationsStack,this._dimensions=new _imageDimensions2["default"](dimensions),this._initialDimensions=new _mathVector22["default"](this._image.width,this._image.height),this._initRenderer()}return _createClass(RenderImage,[{key:"_initRenderer",value:function(){if(_renderersWebglRenderer2["default"].isSupported()&&"canvas"!==this._options.preferredRenderer?(this._renderer=new _renderersWebglRenderer2["default"](this._initialDimensions),this._webglEnabled=!0):_renderersCanvasRenderer2["default"].isSupported()&&(this._renderer=new _renderersCanvasRenderer2["default"](this._initialDimensions),this._webglEnabled=!1),null===this._renderer)throw new Error("Neither Canvas nor WebGL renderer are supported.");this._renderer.drawImage(this._image)}},{key:"render",value:function(){for(var _this=this,stack=this.sanitizedStack,validationPromises=[],i=0;i<stack.length;i++){var operation=stack[i];validationPromises.push(operation.validateSettings())}return Promise.all(validationPromises).then(function(){for(var promises=[],i=0;i<stack.length;i++){var operation=stack[i];promises.push(operation.render(_this._renderer))}return Promise.all(promises)}).then(function(){return _this._renderer.renderFinal()}).then(function(){var initialSize=_this._renderer.getSize(),finalDimensions=_this._dimensions.calculateFinalDimensions(initialSize);return finalDimensions.equals(initialSize)?void 0:_this._renderer.resizeTo(finalDimensions)})}},{key:"getRenderer",value:function(){return this._renderer}},{key:"sanitizedStack",get:function(){for(var sanitizedStack=[],i=0;i<this._stack.length;i++){var operation=this._stack[i];operation&&sanitizedStack.push(operation)}return sanitizedStack}}]),RenderImage}();exports["default"]=RenderImage,module.exports=exports["default"]},function(module,exports,__webpack_require__){(function(process){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_constants=__webpack_require__(5),_exifRestorer=__webpack_require__(57),_exifRestorer2=_interopRequireDefault(_exifRestorer),_utils=__webpack_require__(6),_utils2=_interopRequireDefault(_utils),ImageExporter=function(){function ImageExporter(){_classCallCheck(this,ImageExporter)}return _createClass(ImageExporter,null,[{key:"validateSettings",value:function(renderType,imageFormat){var settings={renderType:renderType,imageFormat:imageFormat};if("undefined"!=typeof settings.renderType&&null!==settings.renderType&&-1===_utils2["default"].values(_constants.RenderType).indexOf(settings.renderType))throw new Error("Invalid render type: "+settings.renderType);if("undefined"==typeof renderType&&(settings.renderType=_constants.RenderType.DATAURL),"undefined"!=typeof settings.imageFormat&&null!==settings.imageFormat&&-1===_utils2["default"].values(_constants.ImageFormat).indexOf(settings.imageFormat))throw new Error("Invalid image format: "+settings.imageFormat);if("undefined"==typeof imageFormat&&(settings.imageFormat=_constants.ImageFormat.PNG),settings.renderType===_constants.RenderType.BUFFER&&"undefined"==typeof process)throw new Error("Render type 'buffer' is only available when using node.js");return settings}},{key:"export",value:function(image,canvas,renderType,imageFormat){var quality=void 0===arguments[4]?.8:arguments[4];return new Promise(function(resolve,reject){var result=void 0;if(renderType===_constants.RenderType.IMAGE||renderType===_constants.RenderType.DATAURL){result="undefined"==typeof window?canvas.toDataURL(imageFormat):canvas.toDataURL(imageFormat,quality);var jpegMatch=/^data:image\/jpeg/i;image.src.match(jpegMatch)&&result.match(jpegMatch)&&(result=_exifRestorer2["default"].restore(image.src,result))}if(renderType===_constants.RenderType.IMAGE){var outputImage=void 0;if("undefined"==typeof window){var CanvasImage=__webpack_require__(53).Image;outputImage=new CanvasImage}else outputImage=new Image;outputImage.src=result,resolve(outputImage)}else renderType===_constants.RenderType.DATAURL?resolve(result):renderType===_constants.RenderType.BUFFER?resolve(canvas.toBuffer()):renderType===_constants.RenderType.BLOB&&canvas.toBlob(function(blob){resolve(blob)},imageFormat,quality)})}}]),ImageExporter}();exports["default"]=ImageExporter,module.exports=exports["default"]}).call(exports,__webpack_require__(74))},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),VERSION_CHECK_FN="imglySDKVersionCallback",VERSION_CHECK_URL="http://sdk.img.ly/version.json?sdk=html5&jsoncallback="+VERSION_CHECK_FN,VersionChecker=function(){function VersionChecker(version){_classCallCheck(this,VersionChecker),this._version=version,this._check()}return _createClass(VersionChecker,[{key:"_check",value:function(){var self=this;window[VERSION_CHECK_FN]=function(response){response.outdated&&(console.warn("imgly-sdk-html5: Your version "+self._version+" is outdated."),console.warn("imgly-sdk-html5: Current version is "+response.version+"."))};var script=document.createElement("script");script.src=VERSION_CHECK_URL+"&version="+this._version,script.async=!0,document.getElementsByTagName("head")[0].appendChild(script)}}]),VersionChecker}();exports["default"]=VersionChecker,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var RenderType={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob"};exports.RenderType=RenderType;var ImageFormat={PNG:"image/png",JPEG:"image/jpeg"};exports.ImageFormat=ImageFormat},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_mathVector2=__webpack_require__(50),_mathVector22=_interopRequireDefault(_mathVector2),Utils=function(){function Utils(){_classCallCheck(this,Utils)}return _createClass(Utils,null,[{key:"isArray",value:function(object){return"[object Array]"===Object.prototype.toString.call(object)}},{key:"select",value:function(items){var selector=void 0===arguments[1]?null:arguments[1];if(null===selector)return items;if("string"==typeof selector&&(selector=selector.split(",").map(function(identifier){return identifier.trim()})),Utils.isArray(selector)&&(selector={only:selector}),"undefined"!=typeof selector.only)return"string"==typeof selector.only&&(selector.only=selector.only.split(",").map(function(identifier){return identifier.trim()})),items.filter(function(item){return-1!==selector.only.indexOf(item)});if("undefined"!=typeof selector.except)return"string"==typeof selector.except&&(selector.except=selector.except.split(",").map(function(identifier){return identifier.trim()})),items.filter(function(item){return-1===selector.except.indexOf(item)});throw new Error("Utils#select failed to filter items.")}},{key:"values",value:function values(object){
var values=[];for(var key in object)values.push(object[key]);return values}},{key:"isDOMElement",value:function(o){return"object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&null!==o&&1===o.nodeType&&"string"==typeof o.nodeName}},{key:"getEventPosition",value:function(e){var x=e.pageX,y=e.pageY;return-1!==e.type.indexOf("touch")&&(x=e.touches[0].pageX,y=e.touches[0].pageY),new _mathVector22["default"](x,y)}}]),Utils}();exports["default"]=Utils,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Color=function(){function Color(r,g,b,a){_classCallCheck(this,Color),"undefined"==typeof a&&(a=1),this.r=r,this.g=g,this.b=b,this.a=a}return _createClass(Color,[{key:"toRGBA",value:function(){var colors=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b),this.a];return"rgba("+colors.join(",")+")"}},{key:"toHex",value:function(){var components=[this._componentToHex(Math.round(255*this.r)),this._componentToHex(Math.round(255*this.g)),this._componentToHex(Math.round(255*this.b))];return"#"+components.join("")}},{key:"toGLColor",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toRGBGLColor",value:function(){return[this.r,this.g,this.b]}},{key:"toHSV",value:function(){var max=Math.max(this.r,this.g,this.b),min=Math.min(this.r,this.g,this.b),h=void 0,s=void 0,v=max,d=max-min;if(s=0===max?0:d/max,max===min)h=0;else{switch(max){case this.r:h=(this.g-this.b)/d+(this.g<this.b?6:0);break;case this.g:h=(this.b-this.r)/d+2;break;case this.b:h=(this.r-this.g)/d+4}h/=6}return[h,s,v]}},{key:"fromHSV",value:function(h,s,v){var r=this.r,g=this.g,b=this.b,i=Math.floor(6*h),f=6*h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}this.r=r,this.g=g,this.b=b}},{key:"clone",value:function(){return new Color(this.r,this.g,this.b,this.a)}},{key:"_componentToHex",value:function(component){var hex=component.toString(16);return 1===hex.length?"0"+hex:hex}},{key:"toString",value:function(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}]),Color}();exports["default"]=Color,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Filter=function(){function Filter(){_classCallCheck(this,Filter)}return _createClass(Filter,[{key:"render",value:function(renderer){throw new Error("Filter#render is abstract and not implemented in inherited class.")}}],[{key:"identifier",get:function(){return null}}]),Filter}();Filter.extend=__webpack_require__(58),Filter.PrimitivesStack=__webpack_require__(59),Filter.Primitives={},Filter.Primitives.Saturation=__webpack_require__(60),Filter.Primitives.LookupTable=__webpack_require__(61),Filter.Primitives.ToneCurve=__webpack_require__(62),Filter.Primitives.SoftColorOverlay=__webpack_require__(63),Filter.Primitives.Desaturation=__webpack_require__(64),Filter.Primitives.X400=__webpack_require__(65),Filter.Primitives.Grayscale=__webpack_require__(66),Filter.Primitives.Contrast=__webpack_require__(67),Filter.Primitives.Glow=__webpack_require__(68),Filter.Primitives.Gobblin=__webpack_require__(69),Filter.Primitives.Brightness=__webpack_require__(70),exports["default"]=Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),_libExtend=__webpack_require__(58),_libExtend2=_interopRequireDefault(_libExtend),Operation=function(_EventEmitter){function Operation(kit,options){if(_classCallCheck(this,Operation),_get(Object.getPrototypeOf(Operation.prototype),"constructor",this).call(this),"ImglyKit"!==kit.constructor.name)throw new Error("Operation: First parameter for constructor has to be an ImglyKit instance.");this._kit=kit,this.availableOptions=_lodash2["default"].extend(this.availableOptions||{},{numberFormat:{type:"string","default":"relative",available:["absolute","relative"]}}),this._dirty=!0,this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"===c?r:3&r|8;return v.toString(16)}),this._initOptions(options||{})}return _inherits(Operation,_EventEmitter),_createClass(Operation,[{key:"validateSettings",value:function(){var _this=this,identifier=this.identifier;return new Promise(function(resolve,reject){for(var optionName in _this.availableOptions){var optionConfig=_this.availableOptions[optionName];if(optionConfig.required&&"undefined"==typeof _this._options[optionName])return reject(new Error("Operation `"+identifier+"`: Option `"+optionName+"` is required."))}resolve()})}},{key:"render",value:function(renderer){var renderFn=void 0;renderFn="webgl"===renderer.identifier?this._renderWebGL.bind(this):this._renderCanvas.bind(this),this._dirty?(renderFn(renderer),renderer.cache(this._uuid),this._dirty=!1):renderer.drawCached(this._uuid)}},{key:"_renderWebGL",value:function(){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}},{key:"_renderCanvas",value:function(){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}},{key:"_initOptions",value:function(userOptions){this._options={};var optionName,option,capitalized,self=this;for(optionName in this.availableOptions){capitalized=optionName.charAt(0).toUpperCase()+optionName.slice(1),option=this.availableOptions[optionName];var fn=function(optionName,option){self["set"+capitalized]=function(value){self._setOption(optionName,value)},self["get"+capitalized]=function(){return self._getOption(optionName)}};fn(optionName,option),"undefined"!=typeof option["default"]&&this["set"+capitalized](option["default"])}for(optionName in userOptions){if("undefined"==typeof this.availableOptions[optionName])throw new Error("Invalid option: "+optionName);capitalized=optionName.charAt(0).toUpperCase()+optionName.slice(1),this["set"+capitalized](userOptions[optionName])}}},{key:"set",value:function(options){for(var optionName in options)this._setOption(optionName,options[optionName],!1);this.emit("update")}},{key:"_getOption",value:function(optionName){return this._options[optionName]}},{key:"_setOption",value:function(optionName,value){var update=void 0===arguments[2]?!0:arguments[2],optionConfig=this.availableOptions[optionName],identifier=this.identifier;switch("undefined"!=typeof optionConfig.setter&&(value=optionConfig.setter.call(this,value)),"undefined"!=typeof optionConfig.validation&&optionConfig.validation(value),optionConfig.type){case"string":if("string"!=typeof value)throw new Error("Operation `"+identifier+"`: Option `"+optionName+"` has to be a string.");var available=optionConfig.available;if("undefined"!=typeof available&&-1===available.indexOf(value))throw new Error("Operation `"+identifier+"`: Invalid value for `"+optionName+"` (valid values are: "+optionConfig.available.join(", ")+")");this._options[optionName]=value;break;case"number":if("number"!=typeof value)throw new Error("Operation `"+identifier+"`: Option `"+optionName+"` has to be a number.");this._options[optionName]=value;break;case"boolean":if("boolean"!=typeof value)throw new Error("Operation `"+identifier+"`: Option `"+optionName+"` has to be a boolean.");this._options[optionName]=value;break;case"vector2":if(!(value instanceof _libMathVector22["default"]))throw new Error("Operation `"+identifier+"`: Option `"+optionName+"` has to be an instance of ImglyKit.Vector2.");this._options[optionName]=value.clone();break;case"color":if(!(value instanceof _libColor2["default"]))throw new Error("Operation `"+identifier+"`: Option `"+optionName+"` has to be an instance of ImglyKit.Color.");this._options[optionName]=value;break;case"object":this._options[optionName]=value}this._dirty=!0,update&&this.emit("update")}},{key:"getNewDimensions",value:function(renderer,dimensions){var canvas=renderer.getCanvas();return dimensions=dimensions||new _libMathVector22["default"](canvas.width,canvas.height)}},{key:"dirty",set:function(dirty){this._dirty=dirty},get:function(){return this._dirty}}]),Operation}(_libEventEmitter2["default"]);Operation.prototype.identifier=null,Operation.extend=_libExtend2["default"],exports["default"]=Operation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_filtersIdentityFilter=__webpack_require__(71),_filtersIdentityFilter2=_interopRequireDefault(_filtersIdentityFilter),FiltersOperation=function(_Operation){function FiltersOperation(){_classCallCheck(this,FiltersOperation),null!=_Operation&&_Operation.apply(this,arguments)}return _inherits(FiltersOperation,_Operation),_createClass(FiltersOperation,[{key:"_renderWebGL",value:function(renderer){this._render(renderer)}},{key:"_renderCanvas",value:function(renderer){this._render(renderer)}},{key:"_render",value:function(renderer){this._selectedFilter.render(renderer)}}]),FiltersOperation}(_operation2["default"]);FiltersOperation.prototype.identifier="filters",FiltersOperation.prototype.availableOptions={filter:{type:"object","default":_filtersIdentityFilter2["default"],setter:function(Filter){return this._selectedFilter=new Filter,Filter}}},exports["default"]=FiltersOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),CropOperation=function(_Operation){function CropOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,CropOperation),_get(Object.getPrototypeOf(CropOperation.prototype),"constructor",this).apply(this,args),this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform vec2 u_cropStart;\n      uniform vec2 u_cropEnd;\n\n      void main() {\n        vec2 size = u_cropEnd - u_cropStart;\n        gl_FragColor = texture2D(u_image, v_texCoord * size + u_cropStart);\n      }\n    "}return _inherits(CropOperation,_Operation),_createClass(CropOperation,[{key:"_renderWebGL",value:function(renderer){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),start=this._options.start.clone(),end=this._options.end.clone();"absolute"===this._options.numberFormat&&(start.divide(canvasSize),end.divide(canvasSize));var originalStartY=start.y;start.y=1-end.y,end.y=1-originalStartY;var newDimensions=this.getNewDimensions(renderer);canvas.width=newDimensions.x,canvas.height=newDimensions.y,renderer.runShader(null,this.fragmentShader,{uniforms:{u_cropStart:{type:"2f",value:[start.x,start.y]},u_cropEnd:{type:"2f",value:[end.x,end.y]}}})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),dimensions=new _libMathVector22["default"](canvas.width,canvas.height),newDimensions=this.getNewDimensions(renderer),newCanvas=renderer.createCanvas();newCanvas.width=newDimensions.x,newCanvas.height=newDimensions.y;var newContext=newCanvas.getContext("2d"),startPosition=this._options.start.clone();"relative"===this._options.numberFormat&&startPosition.multiply(dimensions),newContext.drawImage(canvas,startPosition.x,startPosition.y,newDimensions.x,newDimensions.y,0,0,newDimensions.x,newDimensions.y),renderer.setCanvas(newCanvas)}},{key:"getNewDimensions",value:function(renderer,dimensions){var canvas=renderer.getCanvas();dimensions=dimensions||new _libMathVector22["default"](canvas.width,canvas.height);var newDimensions=this._options.end.clone().subtract(this._options.start);return"relative"===this._options.numberFormat&&newDimensions.multiply(dimensions),newDimensions}}]),CropOperation}(_operation2["default"]);CropOperation.prototype.identifier="crop",CropOperation.prototype.availableOptions={start:{type:"vector2",required:!0,"default":new _libMathVector22["default"](0,0)},end:{type:"vector2",required:!0,"default":new _libMathVector22["default"](1,1)}},exports["default"]=CropOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),RotationOperation=function(_Operation){function RotationOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,RotationOperation),_get(Object.getPrototypeOf(RotationOperation.prototype),"constructor",this).apply(this,args),this.vertexShader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n      uniform mat3 u_matrix;\n\n      void main() {\n        gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    "}return _inherits(RotationOperation,_Operation),_createClass(RotationOperation,[{key:"_renderWebGL",value:function(renderer){var canvas=renderer.getCanvas(),actualDegrees=this._options.degrees%360;if(actualDegrees%180!==0){var newDimensions=this.getNewDimensions(renderer);canvas.width=newDimensions.x,canvas.height=newDimensions.y}var radians=actualDegrees*(Math.PI/180),c=Math.cos(radians),s=Math.sin(radians),rotationMatrix=[c,-s,0,s,c,0,0,0,1];renderer.runShader(this.vertexShader,null,{uniforms:{u_matrix:{type:"mat3fv",value:rotationMatrix}}})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),actualDegrees=this._options.degrees%360,newDimensions=this.getNewDimensions(renderer),newCanvas=renderer.createCanvas();newCanvas.width=newDimensions.x,newCanvas.height=newDimensions.y;var newContext=newCanvas.getContext("2d");newContext.save(),newContext.translate(newCanvas.width/2,newCanvas.height/2),newContext.rotate(actualDegrees*(Math.PI/180));var tempCanvas=renderer.cloneCanvas();newContext.drawImage(tempCanvas,-canvas.width/2,-canvas.height/2),newContext.restore(),renderer.setCanvas(newCanvas)}},{key:"getNewDimensions",value:function(renderer,dimensions){var canvas=renderer.getCanvas();dimensions=dimensions||new _libMathVector22["default"](canvas.width,canvas.height);var actualDegrees=this._options.degrees%360;if(actualDegrees%180!==0){var tempX=dimensions.x;dimensions.x=dimensions.y,dimensions.y=tempX}return dimensions}}]),RotationOperation}(_operation2["default"]);RotationOperation.prototype.identifier="rotation",RotationOperation.prototype.availableOptions={degrees:{type:"number","default":0,validation:function(value){if(value%90!==0)throw new Error("RotationOperation: `rotation` has to be a multiple of 90.")}}},exports["default"]=RotationOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_filtersPrimitivesStack=__webpack_require__(59),_filtersPrimitivesStack2=_interopRequireDefault(_filtersPrimitivesStack),_filtersPrimitivesSaturation=__webpack_require__(60),_filtersPrimitivesSaturation2=_interopRequireDefault(_filtersPrimitivesSaturation),SaturationOperation=function(_Operation){function SaturationOperation(){_classCallCheck(this,SaturationOperation),null!=_Operation&&_Operation.apply(this,arguments)}return _inherits(SaturationOperation,_Operation),_createClass(SaturationOperation,[{key:"_renderWebGL",value:function(renderer){this._render(renderer)}},{key:"_renderCanvas",value:function(renderer){this._render(renderer)}},{key:"_render",value:function(renderer){var stack=new _filtersPrimitivesStack2["default"];stack.add(new _filtersPrimitivesSaturation2["default"]({saturation:this._options.saturation})),stack.render(renderer)}}]),SaturationOperation}(_operation2["default"]);SaturationOperation.prototype.identifier="saturation",SaturationOperation.prototype.availableOptions={saturation:{type:"number","default":1}},exports["default"]=SaturationOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_filtersPrimitivesStack=__webpack_require__(59),_filtersPrimitivesStack2=_interopRequireDefault(_filtersPrimitivesStack),_filtersPrimitivesContrast=__webpack_require__(67),_filtersPrimitivesContrast2=_interopRequireDefault(_filtersPrimitivesContrast),ContrastOperation=function(_Operation){function ContrastOperation(){_classCallCheck(this,ContrastOperation),null!=_Operation&&_Operation.apply(this,arguments)}return _inherits(ContrastOperation,_Operation),_createClass(ContrastOperation,[{key:"_renderWebGL",value:function(renderer){this._render(renderer)}},{key:"_renderCanvas",value:function(renderer){this._render(renderer)}},{key:"_render",value:function(renderer){var stack=new _filtersPrimitivesStack2["default"];stack.add(new _filtersPrimitivesContrast2["default"]({contrast:this._options.contrast})),stack.render(renderer)}}]),ContrastOperation}(_operation2["default"]);ContrastOperation.prototype.identifier="contrast",ContrastOperation.prototype.availableOptions={contrast:{type:"number","default":1}},exports["default"]=ContrastOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_filtersPrimitivesStack=__webpack_require__(59),_filtersPrimitivesStack2=_interopRequireDefault(_filtersPrimitivesStack),_filtersPrimitivesBrightness=__webpack_require__(70),_filtersPrimitivesBrightness2=_interopRequireDefault(_filtersPrimitivesBrightness),BrightnessOperation=function(_Operation){function BrightnessOperation(){_classCallCheck(this,BrightnessOperation),null!=_Operation&&_Operation.apply(this,arguments)}return _inherits(BrightnessOperation,_Operation),_createClass(BrightnessOperation,[{key:"_renderWebGL",value:function(renderer){this._render(renderer)}},{key:"_renderCanvas",value:function(renderer){this._render(renderer)}},{key:"_render",value:function(renderer){var stack=new _filtersPrimitivesStack2["default"];stack.add(new _filtersPrimitivesBrightness2["default"]({brightness:this._options.brightness})),stack.render(renderer)}}]),BrightnessOperation}(_operation2["default"]);BrightnessOperation.prototype.identifier="brightness",BrightnessOperation.prototype.availableOptions={brightness:{type:"number","default":0}},exports["default"]=BrightnessOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),FlipOperation=function(_Operation){function FlipOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,FlipOperation),_get(Object.getPrototypeOf(FlipOperation.prototype),"constructor",this).apply(this,args),this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform bool u_flipVertical;\n      uniform bool u_flipHorizontal;\n\n      void main() {\n        vec2 texCoord = vec2(v_texCoord);\n        if (u_flipVertical) {\n          texCoord.y = 1.0 - texCoord.y;\n        }\n        if (u_flipHorizontal) {\n          texCoord.x = 1.0 - texCoord.x;\n        }\n        gl_FragColor = texture2D(u_image, texCoord);\n      }\n    ";
}return _inherits(FlipOperation,_Operation),_createClass(FlipOperation,[{key:"_renderWebGL",value:function(renderer){renderer.runShader(null,this.fragmentShader,{uniforms:{u_flipVertical:{type:"f",value:this._options.vertical},u_flipHorizontal:{type:"f",value:this._options.horizontal}}})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),context=renderer.getContext(),scaleX=1,scaleY=1,translateX=0,translateY=0;this._options.horizontal&&(scaleX=-1,translateX=canvas.width),this._options.vertical&&(scaleY=-1,translateY=canvas.height),context.save(),context.translate(translateX,translateY),context.scale(scaleX,scaleY);var tempCanvas=renderer.cloneCanvas();context.drawImage(tempCanvas,0,0),context.restore()}}]),FlipOperation}(_operation2["default"]);FlipOperation.prototype.identifier="flip",FlipOperation.prototype.availableOptions={horizontal:{type:"boolean","default":!1},vertical:{type:"boolean","default":!1}},exports["default"]=FlipOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_set=function set(object,property,value,receiver){var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);null!==parent&&set(parent,property,value,receiver)}else if("value"in desc&&desc.writable)desc.value=value;else{var setter=desc.set;void 0!==setter&&setter.call(receiver,value)}return value},_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_vendorStackBlur=__webpack_require__(73),_vendorStackBlur2=_interopRequireDefault(_vendorStackBlur),TiltShiftOperation=function(_Operation){function TiltShiftOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,TiltShiftOperation),_get(Object.getPrototypeOf(TiltShiftOperation.prototype),"constructor",this).apply(this,args),this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 start;\n      uniform vec2 end;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n          vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n          float radius = smoothstep(0.0, 1.0, abs(dot(v_texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ",this._cachedBlurredCanvas=null,this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius}return _inherits(TiltShiftOperation,_Operation),_createClass(TiltShiftOperation,[{key:"_renderWebGL",value:function(renderer){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),start=this._options.start.clone(),end=this._options.end.clone();"relative"===this._options.numberFormat&&(start.multiply(canvasSize),end.multiply(canvasSize)),start.y=canvasSize.y-start.y,end.y=canvasSize.y-end.y;var delta=end.clone().subtract(start),d=Math.sqrt(delta.x*delta.x+delta.y*delta.y),uniforms={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},start:{type:"2f",value:[start.x,start.y]},end:{type:"2f",value:[end.x,end.y]},delta:{type:"2f",value:[delta.x/d,delta.y/d]},texSize:{type:"2f",value:[canvas.width,canvas.height]}};renderer.runShader(null,this.fragmentShader,{uniforms:uniforms}),uniforms.delta.value=[-delta.y/d,delta.x/d],renderer.runShader(null,this.fragmentShader,{uniforms:uniforms})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),optionsChanged=this._options.blurRadius!==this._lastBlurRadius||this._options.gradientRadius!==this._lastGradientRadius,blurryCanvas=void 0;optionsChanged||null===this._cachedBlurredCanvas?(blurryCanvas=this._blurCanvas(renderer),this._cachedBlurredCanvas=blurryCanvas,this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius):blurryCanvas=this._cachedBlurredCanvas;var maskCanvas=this._createMask(renderer);this._applyMask(canvas,blurryCanvas,maskCanvas)}},{key:"_blurCanvas",value:function(renderer){var newCanvas=renderer.cloneCanvas(),blurryContext=newCanvas.getContext("2d"),blurryImageData=blurryContext.getImageData(0,0,newCanvas.width,newCanvas.height);return _vendorStackBlur2["default"].stackBlurCanvasRGBA(blurryImageData,0,0,newCanvas.width,newCanvas.height,this._options.blurRadius),blurryContext.putImageData(blurryImageData,0,0),newCanvas}},{key:"_createMask",value:function(renderer){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),gradientRadius=this._options.gradientRadius,maskCanvas=renderer.createCanvas(canvas.width,canvas.height),maskContext=maskCanvas.getContext("2d"),start=this._options.start.clone(),end=this._options.end.clone();"relative"===this._options.numberFormat&&(start.multiply(canvasSize),end.multiply(canvasSize));var dist=end.clone().subtract(start),middle=start.clone().add(dist.clone().divide(2)),totalDist=Math.sqrt(Math.pow(dist.x,2)+Math.pow(dist.y,2)),factor=dist.clone().divide(totalDist),gradientStart=middle.clone().add(gradientRadius*factor.y,-gradientRadius*factor.x),gradientEnd=middle.clone().add(-gradientRadius*factor.y,gradientRadius*factor.x),gradient=maskContext.createLinearGradient(gradientStart.x,gradientStart.y,gradientEnd.x,gradientEnd.y);return gradient.addColorStop(0,"#000000"),gradient.addColorStop(.5,"#FFFFFF"),gradient.addColorStop(1,"#000000"),maskContext.fillStyle=gradient,maskContext.fillRect(0,0,canvas.width,canvas.height),maskCanvas}},{key:"_applyMask",value:function(inputCanvas,blurryCanvas,maskCanvas){for(var inputContext=inputCanvas.getContext("2d"),blurryContext=blurryCanvas.getContext("2d"),maskContext=maskCanvas.getContext("2d"),inputImageData=inputContext.getImageData(0,0,inputCanvas.width,inputCanvas.height),pixels=inputImageData.data,blurryPixels=blurryContext.getImageData(0,0,inputCanvas.width,inputCanvas.height).data,maskPixels=maskContext.getImageData(0,0,inputCanvas.width,inputCanvas.height).data,i=0;i<maskPixels.length;i++){var alpha=maskPixels[i]/255;pixels[i]=alpha*pixels[i]+(1-alpha)*blurryPixels[i]}inputContext.putImageData(inputImageData,0,0)}},{key:"dirty",set:function(dirty){_set(Object.getPrototypeOf(TiltShiftOperation.prototype),"dirty",dirty,this),this._cachedBlurredCanvas=null},get:function(){return _get(Object.getPrototypeOf(TiltShiftOperation.prototype),"dirty",this)}}]),TiltShiftOperation}(_operation2["default"]);TiltShiftOperation.prototype.identifier="tilt-shift",TiltShiftOperation.prototype.availableOptions={start:{type:"vector2","default":new _libMathVector22["default"](0,.5)},end:{type:"vector2","default":new _libMathVector22["default"](1,.5)},blurRadius:{type:"number","default":30},gradientRadius:{type:"number","default":50}},exports["default"]=TiltShiftOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_set=function set(object,property,value,receiver){var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);null!==parent&&set(parent,property,value,receiver)}else if("value"in desc&&desc.writable)desc.value=value;else{var setter=desc.set;void 0!==setter&&setter.call(receiver,value)}return value},_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_vendorStackBlur=__webpack_require__(73),_vendorStackBlur2=_interopRequireDefault(_vendorStackBlur),RadialBlurOperation=function(_Operation){function RadialBlurOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,RadialBlurOperation),_get(Object.getPrototypeOf(RadialBlurOperation.prototype),"constructor",this).apply(this,args),this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 position;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n          float radius = smoothstep(0.0, 1.0, abs(distance(v_texCoord * texSize, position)) / (gradientRadius * 2.0)) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ",this._cachedBlurredCanvas=null,this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius}return _inherits(RadialBlurOperation,_Operation),_createClass(RadialBlurOperation,[{key:"_renderWebGL",value:function(renderer){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),position=this._options.position.clone();position.y=1-position.y,"relative"===this._options.numberFormat&&position.multiply(canvasSize);var uniforms={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},position:{type:"2f",value:[position.x,position.y]},texSize:{type:"2f",value:[canvas.width,canvas.height]},delta:{type:"2f",value:[1,1]}};renderer.runShader(null,this.fragmentShader,{uniforms:uniforms}),uniforms.delta.value=[-1,1],renderer.runShader(null,this.fragmentShader,{uniforms:uniforms})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),blurRadiusChanged=this._options.blurRadius!==this._lastBlurRadius,blurryCanvas=void 0;blurRadiusChanged||null===this._cachedBlurredCanvas?(blurryCanvas=this._blurCanvas(renderer),this._cachedBlurredCanvas=blurryCanvas,this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius):blurryCanvas=this._cachedBlurredCanvas;var maskCanvas=this._createMask(renderer);this._applyMask(canvas,blurryCanvas,maskCanvas)}},{key:"_blurCanvas",value:function(renderer){var newCanvas=renderer.cloneCanvas(),blurryContext=newCanvas.getContext("2d"),blurryImageData=blurryContext.getImageData(0,0,newCanvas.width,newCanvas.height);return _vendorStackBlur2["default"].stackBlurCanvasRGBA(blurryImageData,0,0,newCanvas.width,newCanvas.height,this._options.blurRadius),blurryContext.putImageData(blurryImageData,0,0),newCanvas}},{key:"_createMask",value:function(renderer){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),gradientRadius=this._options.gradientRadius,maskCanvas=renderer.createCanvas(canvas.width,canvas.height),maskContext=maskCanvas.getContext("2d"),position=this._options.position.clone();"relative"===this._options.numberFormat&&position.multiply(canvasSize);var gradient=maskContext.createRadialGradient(position.x,position.y,0,position.x,position.y,gradientRadius);return gradient.addColorStop(0,"#FFFFFF"),gradient.addColorStop(1,"#000000"),maskContext.fillStyle=gradient,maskContext.fillRect(0,0,canvas.width,canvas.height),maskCanvas}},{key:"_applyMask",value:function(inputCanvas,blurryCanvas,maskCanvas){for(var index,alpha,inputContext=inputCanvas.getContext("2d"),blurryContext=blurryCanvas.getContext("2d"),maskContext=maskCanvas.getContext("2d"),inputImageData=inputContext.getImageData(0,0,inputCanvas.width,inputCanvas.height),pixels=inputImageData.data,blurryPixels=blurryContext.getImageData(0,0,inputCanvas.width,inputCanvas.height).data,maskPixels=maskContext.getImageData(0,0,inputCanvas.width,inputCanvas.height).data,y=0;y<inputCanvas.height;y++)for(var x=0;x<inputCanvas.width;x++)index=4*(y*inputCanvas.width+x),alpha=maskPixels[index]/255,pixels[index]=alpha*pixels[index]+(1-alpha)*blurryPixels[index],pixels[index+1]=alpha*pixels[index+1]+(1-alpha)*blurryPixels[index+1],pixels[index+2]=alpha*pixels[index+2]+(1-alpha)*blurryPixels[index+2];inputContext.putImageData(inputImageData,0,0)}},{key:"dirty",set:function(dirty){_set(Object.getPrototypeOf(RadialBlurOperation.prototype),"dirty",dirty,this),this._cachedBlurredCanvas=null},get:function(){return _get(Object.getPrototypeOf(RadialBlurOperation.prototype),"dirty",this)}}]),RadialBlurOperation}(_operation2["default"]);RadialBlurOperation.prototype.identifier="radial-blur",RadialBlurOperation.prototype.availableOptions={position:{type:"vector2","default":new _libMathVector22["default"](.5,.5)},gradientRadius:{type:"number","default":50},blurRadius:{type:"number","default":20}},exports["default"]=RadialBlurOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),TextOperation=function(_Operation){function TextOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,TextOperation),_get(Object.getPrototypeOf(TextOperation.prototype),"constructor",this).apply(this,args),this._textureIndex=1,this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_textImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    "}return _inherits(TextOperation,_Operation),_createClass(TextOperation,[{key:"_renderWebGL",value:function(renderer){var textCanvas=this._renderTextCanvas(renderer),canvas=renderer.getCanvas(),gl=renderer.getContext(),position=this._options.position.clone(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),size=new _libMathVector22["default"](textCanvas.width,textCanvas.height).divide(canvasSize);"absolute"===this._options.numberFormat&&position.divide(canvasSize),position.y=1-position.y,position.y-=size.y,"center"===this._options.verticalAlignment?position.y+=size.y/2:"bottom"===this._options.verticalAlignment&&(position.y+=size.y),"center"===this._options.alignment?position.x-=size.x/2:"right"===this._options.alignment&&(position.x-=size.x),gl.activeTexture(gl.TEXTURE0+this._textureIndex),this._texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this._texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,textCanvas),gl.activeTexture(gl.TEXTURE0),renderer.runShader(null,this._fragmentShader,{uniforms:{u_textImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[position.x,position.y]},u_size:{type:"2f",value:[size.x,size.y]}}})}},{key:"_renderCanvas",value:function(renderer){var textCanvas=this._renderTextCanvas(renderer),canvas=renderer.getCanvas(),context=renderer.getContext(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),scaledPosition=this._options.position.clone();"relative"===this._options.numberFormat&&scaledPosition.multiply(canvasSize),"center"===this._options.verticalAlignment?scaledPosition.y-=textCanvas.height/2:"bottom"===this._options.verticalAlignment&&(scaledPosition.y-=textCanvas.height),"center"===this._options.alignment?scaledPosition.x-=textCanvas.width/2:"right"===this._options.alignment&&(scaledPosition.x-=textCanvas.width),context.drawImage(textCanvas,scaledPosition.x,scaledPosition.y)}},{key:"_renderTextCanvas",value:function(renderer){var line=void 0,lineNum=void 0,canvas=renderer.createCanvas(),context=canvas.getContext("2d"),outputCanvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](outputCanvas.width,outputCanvas.height),maxWidth=this._options.maxWidth,actualFontSize=this._options.fontSize*canvasSize.y,actualLineHeight=this._options.lineHeight*actualFontSize;"relative"===this._options.numberFormat&&(maxWidth*=renderer.getCanvas().width),this._applyTextOptions(renderer,context);var boundingBox=new _libMathVector22["default"],lines=this._options.text.split("\n");if("undefined"!=typeof maxWidth)boundingBox.x=maxWidth,lines=this._buildOutputLines(context,maxWidth);else for(lineNum=0;lineNum<lines.length;lineNum++)line=lines[lineNum],boundingBox.x=Math.max(boundingBox.x,context.measureText(line).width);for(boundingBox.y=actualLineHeight*lines.length,canvas.width=boundingBox.x,canvas.height=boundingBox.y,context=canvas.getContext("2d"),context.fillStyle=this._options.backgroundColor.toRGBA(),context.fillRect(0,0,canvas.width,canvas.height),this._applyTextOptions(renderer,context),lineNum=0;lineNum<lines.length;lineNum++)line=lines[lineNum],this._drawText(context,line,actualLineHeight*lineNum);return canvas}},{key:"_applyTextOptions",value:function(renderer,context){var canvas=renderer.getCanvas(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),actualFontSize=this._options.fontSize*canvasSize.y;context.font=this._options.fontWeight+" "+actualFontSize+"px "+this._options.fontFamily,context.textBaseline="top",context.textAlign=this._options.alignment,context.fillStyle=this._options.color.toRGBA()}},{key:"_buildOutputLines",value:function(context,maxWidth){for(var inputLines=this._options.text.split("\n"),outputLines=[],currentChars=[],lineNum=0;lineNum<inputLines.length;lineNum++){var inputLine=inputLines[lineNum],lineChars=inputLine.split("");0===lineChars.length&&outputLines.push("");for(var charNum=0;charNum<lineChars.length;charNum++){var currentChar=lineChars[charNum];currentChars.push(currentChar);var currentLine=currentChars.join(""),lineWidth=context.measureText(currentLine).width;if(lineWidth>maxWidth&&1===currentChars.length)outputLines.push(currentChars[0]),currentChars=[];else if(lineWidth>maxWidth){var lastWord=currentChars.pop();outputLines.push(currentChars.join("")),currentChars=[],currentChars=[lastWord]}else charNum===lineChars.length-1&&(outputLines.push(currentChars.join("")),currentChars=[])}currentChars.length&&(outputLines.push(currentChars.join("")),currentChars=[])}return outputLines}},{key:"_drawText",value:function(context,text,y){var canvas=context.canvas;"center"===this._options.alignment?context.fillText(text,canvas.width/2,y):"left"===this._options.alignment?context.fillText(text,0,y):"right"===this._options.alignment&&context.fillText(text,canvas.width,y)}}]),TextOperation}(_operation2["default"]);TextOperation.prototype.identifier="text",TextOperation.prototype.availableOptions={fontSize:{type:"number","default":.1},lineHeight:{type:"number","default":1.1},fontFamily:{type:"string","default":"Times New Roman"},fontWeight:{type:"string","default":"normal"},alignment:{type:"string","default":"left",available:["left","center","right"]},verticalAlignment:{type:"string","default":"top",available:["top","center","bottom"]},color:{type:"color","default":new _libColor2["default"](1,1,1,1)},backgroundColor:{type:"color","default":new _libColor2["default"](0,0,0,0)},position:{type:"vector2","default":new _libMathVector22["default"](0,0)},text:{type:"string",required:!0},maxWidth:{type:"number","default":1}},exports["default"]=TextOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),StickersOperation=function(_Operation){function StickersOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,StickersOperation),_get(Object.getPrototypeOf(StickersOperation.prototype),"constructor",this).apply(this,args),this._textureIndex=1,this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_stickerImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_stickerImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    ",this._loadedStickers={}}return _inherits(StickersOperation,_Operation),_createClass(StickersOperation,[{key:"render",value:function(renderer){var self=this;return this._loadSticker().then(function(image){return"webgl"===renderer.identifier?self._renderWebGL(renderer,image):self._renderCanvas(renderer,image)})}},{key:"_renderWebGL",value:function(renderer,image){var canvas=renderer.getCanvas(),gl=renderer.getContext(),position=this._options.position.clone(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height);"absolute"===this._options.numberFormat&&position.divide(canvasSize);var size=new _libMathVector22["default"](image.width,image.height);if("undefined"!=typeof this._options.size){size.copy(this._options.size),"relative"===this._options.numberFormat&&size.multiply(canvasSize);var ratio=image.height/image.width;size.y=size.x*ratio}size.divide(canvasSize),position.y=1-position.y,position.y-=size.y,gl.activeTexture(gl.TEXTURE0+this._textureIndex),this._texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this._texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,image),gl.activeTexture(gl.TEXTURE0),renderer.runShader(null,this._fragmentShader,{uniforms:{u_stickerImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[position.x,position.y]},u_size:{type:"2f",value:[size.x,size.y]}}})}},{key:"_renderCanvas",value:function(renderer,image){var canvas=renderer.getCanvas(),context=renderer.getContext(),canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),scaledPosition=this._options.position.clone();"relative"===this._options.numberFormat&&scaledPosition.multiply(canvasSize);var size=new _libMathVector22["default"](image.width,image.height);"undefined"!=typeof this._options.size&&(size.copy(this._options.size),"relative"===this._options.numberFormat&&size.multiply(canvasSize)),context.drawImage(image,0,0,image.width,image.height,scaledPosition.x,scaledPosition.y,size.x,size.y)}},{key:"_loadSticker",value:function(){var isBrowser="undefined"!=typeof window;return isBrowser?this._loadImageBrowser(this._options.sticker):this._loadImageNode(this._options.sticker)}},{key:"_loadImageBrowser",value:function(fileName){var self=this;return new Promise(function(resolve,reject){if(self._loadedStickers[fileName])return resolve(self._loadedStickers[fileName]);var image=new Image;image.addEventListener("load",function(){self._loadedStickers[fileName]=image,resolve(image)}),image.addEventListener("error",function(){reject(new Error("Could not load sticker: "+fileName))}),image.src=self._kit.getAssetPath(fileName)})}},{key:"_loadImageNode",
value:function(fileName){var Canvas=__webpack_require__(53),self=this,image=new Canvas.Image,path=self._kit.getAssetPath(fileName);return new Promise(function(resolve,reject){fs.readFile(path,function(err,buffer){return err?reject(err):(image.src=buffer,void resolve(image))})})}},{key:"stickers",get:function(){return this._stickers}}]),StickersOperation}(_operation2["default"]);StickersOperation.prototype.identifier="stickers",StickersOperation.prototype.availableOptions={sticker:{type:"string"},position:{type:"vector2","default":new _libMathVector22["default"](0,0)},size:{type:"vector2","default":new _libMathVector22["default"](0,0)}},exports["default"]=StickersOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_operation=__webpack_require__(9),_operation2=_interopRequireDefault(_operation),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),FramesOperation=function(_Operation){function FramesOperation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,FramesOperation),_get(Object.getPrototypeOf(FramesOperation.prototype),"constructor",this).apply(this,args),this._textureIndex=1,this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_frameImage;\n      uniform vec4 u_color;\n      uniform vec2 u_thickness;\n\n      void main() {\n        vec4 fragColor = texture2D(u_image, v_texCoord);\n        if (v_texCoord.x < u_thickness.x || v_texCoord.x > 1.0 - u_thickness.x ||\n          v_texCoord.y < u_thickness.y || v_texCoord.y > 1.0 - u_thickness.y) {\n            fragColor = mix(fragColor, u_color, u_color.a);\n          }\n\n        gl_FragColor = fragColor;\n      }\n    "}return _inherits(FramesOperation,_Operation),_createClass(FramesOperation,[{key:"_renderWebGL",value:function(renderer){var canvas=renderer.getCanvas(),color=this._options.color,thickness=this._options.thickness*canvas.height,thicknessVec2=[thickness/canvas.width,thickness/canvas.height];renderer.runShader(null,this._fragmentShader,{uniforms:{u_color:{type:"4f",value:color.toGLColor()},u_thickness:{type:"2f",value:thicknessVec2}}})}},{key:"_renderCanvas",value:function(renderer){var canvas=renderer.getCanvas(),context=renderer.getContext(),color=this._options.color,thickness=this._options.thickness*canvas.height;context.save(),context.beginPath(),context.lineWidth=2*thickness,context.strokeStyle=color.toRGBA(),context.rect(0,0,canvas.width,canvas.height),context.stroke(),context.restore()}}]),FramesOperation}(_operation2["default"]);FramesOperation.prototype.identifier="frames",FramesOperation.prototype.availableOptions={color:{type:"color","default":new _libColor2["default"](0,0,0,1)},thickness:{type:"number","default":.02}},exports["default"]=FramesOperation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),A15Filter=function(_Filter){function A15Filter(){_classCallCheck(this,A15Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(A15Filter,_Filter),_createClass(A15Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Contrast({contrast:.63})),stack.add(new _filter2["default"].Primitives.Brightness({brightness:.12})),stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}})),stack.render(renderer)}},{key:"name",get:function(){return"15"}}],[{key:"identifier",get:function(){return"a15"}}]),A15Filter}(_filter2["default"]);exports["default"]=A15Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),BreezeFilter=function(_Filter){function BreezeFilter(){_classCallCheck(this,BreezeFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(BreezeFilter,_Filter),_createClass(BreezeFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Desaturation({desaturation:.5})),stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Breeze"}}],[{key:"identifier",get:function(){return"breeze"}}]),BreezeFilter}(_filter2["default"]);exports["default"]=BreezeFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),BWFilter=function(_Filter){function BWFilter(){_classCallCheck(this,BWFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(BWFilter,_Filter),_createClass(BWFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Grayscale),stack.render(renderer)}},{key:"name",get:function(){return"B&W"}}],[{key:"identifier",get:function(){return"bw"}}]),BWFilter}(_filter2["default"]);exports["default"]=BWFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),BWHardFilter=function(_Filter){function BWHardFilter(){_classCallCheck(this,BWHardFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(BWHardFilter,_Filter),_createClass(BWHardFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Grayscale),stack.add(new _filter2["default"].Primitives.Contrast({contrast:1.5})),stack.render(renderer)}},{key:"name",get:function(){return"1920"}}],[{key:"identifier",get:function(){return"bwhard"}}]),BWHardFilter}(_filter2["default"]);exports["default"]=BWHardFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),CelsiusFilter=function(_Filter){function CelsiusFilter(){_classCallCheck(this,CelsiusFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(CelsiusFilter,_Filter),_createClass(CelsiusFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Celsius"}}],[{key:"identifier",get:function(){return"celsius"}}]),CelsiusFilter}(_filter2["default"]);exports["default"]=CelsiusFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),ChestFilter=function(_Filter){function ChestFilter(){_classCallCheck(this,ChestFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(ChestFilter,_Filter),_createClass(ChestFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Chest"}}],[{key:"identifier",get:function(){return"chest"}}]),ChestFilter}(_filter2["default"]);exports["default"]=ChestFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),FixieFilter=function(_Filter){function FixieFilter(){_classCallCheck(this,FixieFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(FixieFilter,_Filter),_createClass(FixieFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Fixie"}}],[{key:"identifier",get:function(){return"fixie"}}]),FixieFilter}(_filter2["default"]);exports["default"]=FixieFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),FoodFilter=function(_Filter){function FoodFilter(){_classCallCheck(this,FoodFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(FoodFilter,_Filter),_createClass(FoodFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Saturation({saturation:1.35})),stack.add(new _filter2["default"].Primitives.Contrast({contrast:1.1})),stack.render(renderer)}},{key:"name",get:function(){return"Food"}}],[{key:"identifier",get:function(){return"food"}}]),FoodFilter}(_filter2["default"]);exports["default"]=FoodFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),FridgeFilter=function(_Filter){function FridgeFilter(){_classCallCheck(this,FridgeFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(FridgeFilter,_Filter),_createClass(FridgeFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Fridge"}}],[{key:"identifier",get:function(){return"fridge"}}]),FridgeFilter}(_filter2["default"]);exports["default"]=FridgeFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),FrontFilter=function(_Filter){function FrontFilter(){_classCallCheck(this,FrontFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(FrontFilter,_Filter),_createClass(FrontFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Front"}}],[{key:"identifier",get:function(){return"front"}}]),FrontFilter}(_filter2["default"]);exports["default"]=FrontFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),GlamFilter=function(_Filter){function GlamFilter(){_classCallCheck(this,GlamFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(GlamFilter,_Filter),_createClass(GlamFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Contrast({contrast:1.1})),stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Glam"}}],[{key:"identifier",get:function(){return"glam"}}]),GlamFilter}(_filter2["default"]);exports["default"]=GlamFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),GobblinFilter=function(_Filter){function GobblinFilter(){_classCallCheck(this,GobblinFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(GobblinFilter,_Filter),_createClass(GobblinFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Gobblin),stack.render(renderer)}},{key:"name",get:function(){return"Gobblin"}}],[{key:"identifier",get:function(){return"gobblin"}}]),GobblinFilter}(_filter2["default"]);exports["default"]=GobblinFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),K1Filter=function(_Filter){function K1Filter(){_classCallCheck(this,K1Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(K1Filter,_Filter),_createClass(K1Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),stack.add(new _filter2["default"].Primitives.Saturation({saturation:.9})),stack.render(renderer)}},{key:"name",get:function(){return"K1"}}],[{key:"identifier",get:function(){return"k1"}}]),K1Filter}(_filter2["default"]);exports["default"]=K1Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),K2Filter=function(_Filter){function K2Filter(){_classCallCheck(this,K2Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(K2Filter,_Filter),_createClass(K2Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({
controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),stack.add(new _filter2["default"].Primitives.SoftColorOverlay({color:new _libColor2["default"](40/255,40/255,40/255)})),stack.render(renderer)}},{key:"name",get:function(){return"K2"}}],[{key:"identifier",get:function(){return"k2"}}]),K2Filter}(_filter2["default"]);exports["default"]=K2Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),K6Filter=function(_Filter){function K6Filter(){_classCallCheck(this,K6Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(K6Filter,_Filter),_createClass(K6Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Saturation({saturation:.5})),stack.render(renderer)}},{key:"name",get:function(){return"K6"}}],[{key:"identifier",get:function(){return"k6"}}]),K6Filter}(_filter2["default"]);exports["default"]=K6Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),KDynamicFilter=function(_Filter){function KDynamicFilter(){_classCallCheck(this,KDynamicFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(KDynamicFilter,_Filter),_createClass(KDynamicFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),stack.add(new _filter2["default"].Primitives.Saturation({saturation:.7})),stack.render(renderer)}},{key:"name",get:function(){return"KDynamic"}}],[{key:"identifier",get:function(){return"kdynamic"}}]),KDynamicFilter}(_filter2["default"]);exports["default"]=KDynamicFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),LeninFilter=function(_Filter){function LeninFilter(){_classCallCheck(this,LeninFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(LeninFilter,_Filter),_createClass(LeninFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Desaturation({desaturation:.4})),stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Lenin"}}],[{key:"identifier",get:function(){return"lenin"}}]),LeninFilter}(_filter2["default"]);exports["default"]=LeninFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),LomoFilter=function(_Filter){function LomoFilter(){_classCallCheck(this,LomoFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(LomoFilter,_Filter),_createClass(LomoFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]})),stack.render(renderer)}},{key:"name",get:function(){return"Lomo"}}],[{key:"identifier",get:function(){return"lomo"}}]),LomoFilter}(_filter2["default"]);exports["default"]=LomoFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),MellowFilter=function(_Filter){function MellowFilter(){_classCallCheck(this,MellowFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(MellowFilter,_Filter),_createClass(MellowFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Mellow"}}],[{key:"identifier",get:function(){return"mellow"}}]),MellowFilter}(_filter2["default"]);exports["default"]=MellowFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),MorningFilter=function(_Filter){function MorningFilter(){_classCallCheck(this,MorningFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(MorningFilter,_Filter),_createClass(MorningFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),stack.add(new _filter2["default"].Primitives.Glow),stack.render(renderer)}},{key:"name",get:function(){return"Morning"}}],[{key:"identifier",get:function(){return"morning"}}]),MorningFilter}(_filter2["default"]);exports["default"]=MorningFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),OrchidFilter=function(_Filter){function OrchidFilter(){_classCallCheck(this,OrchidFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(OrchidFilter,_Filter),_createClass(OrchidFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]}})),stack.add(new _filter2["default"].Primitives.ToneCurve({controlPoints:[[0,0],[117,151],[189,217],[255,255]]})),stack.add(new _filter2["default"].Primitives.Desaturation({desaturation:.65})),stack.render(renderer)}},{key:"name",get:function(){return"Orchid"}}],[{key:"identifier",get:function(){return"orchid"}}]),OrchidFilter}(_filter2["default"]);exports["default"]=OrchidFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),PolaFilter=function(_Filter){function PolaFilter(){_classCallCheck(this,PolaFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(PolaFilter,_Filter),_createClass(PolaFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),stack.add(new _filter2["default"].Primitives.Saturation({saturation:.8})),stack.add(new _filter2["default"].Primitives.Contrast({contrast:1.5})),stack.render(renderer)}},{key:"name",get:function(){return"Pola SX"}}],[{key:"identifier",get:function(){return"pola"}}]),PolaFilter}(_filter2["default"]);exports["default"]=PolaFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),Pola669Filter=function(_Filter){function Pola669Filter(){_classCallCheck(this,Pola669Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(Pola669Filter,_Filter),_createClass(Pola669Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),stack.add(new _filter2["default"].Primitives.Saturation({saturation:.8})),stack.add(new _filter2["default"].Primitives.Contrast({contrast:1.5})),stack.render(renderer)}},{key:"name",get:function(){return"Pola 669"}}],[{key:"identifier",get:function(){return"pola669"}}]),Pola669Filter}(_filter2["default"]);exports["default"]=Pola669Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),QuoziFilter=function(_Filter){function QuoziFilter(){_classCallCheck(this,QuoziFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(QuoziFilter,_Filter),_createClass(QuoziFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.Desaturation({desaturation:.65})),stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Quozi"}}],[{key:"identifier",get:function(){return"quozi"}}]),QuoziFilter}(_filter2["default"]);exports["default"]=QuoziFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),SemiredFilter=function(_Filter){function SemiredFilter(){_classCallCheck(this,SemiredFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(SemiredFilter,_Filter),_createClass(SemiredFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),stack.add(new _filter2["default"].Primitives.Glow),stack.render(renderer)}},{key:"name",get:function(){return"Semi Red"}}],[{key:"identifier",get:function(){return"semired"}}]),SemiredFilter}(_filter2["default"]);exports["default"]=SemiredFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),SunnyFilter=function(_Filter){function SunnyFilter(){_classCallCheck(this,SunnyFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(SunnyFilter,_Filter),_createClass(SunnyFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]}})),stack.add(new _filter2["default"].Primitives.ToneCurve({controlPoints:[[0,0],[55,20],[158,191],[255,255]]})),stack.render(renderer)}},{key:"name",get:function(){return"Sunny"}}],[{key:"identifier",get:function(){return"sunny"}}]),SunnyFilter}(_filter2["default"]);exports["default"]=SunnyFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),TexasFilter=function(_Filter){function TexasFilter(){_classCallCheck(this,TexasFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(TexasFilter,_Filter),_createClass(TexasFilter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}})),stack.render(renderer)}},{key:"name",get:function(){return"Texas"}}],[{key:"identifier",get:function(){return"texas"}}]),TexasFilter}(_filter2["default"]);exports["default"]=TexasFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),X400Filter=function(_Filter){function X400Filter(){_classCallCheck(this,X400Filter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(X400Filter,_Filter),_createClass(X400Filter,[{key:"render",value:function(renderer){var stack=new _filter2["default"].PrimitivesStack;stack.add(new _filter2["default"].Primitives.X400),stack.render(renderer)}},{key:"name",get:function(){return"X400"}}],[{key:"identifier",get:function(){return"x400"}}]),X400Filter}(_filter2["default"]);exports["default"]=X400Filter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Vector2=function(){function Vector2(x,y){_classCallCheck(this,Vector2),this.x=x,this.y=y,"undefined"==typeof this.x&&(this.x=0),"undefined"==typeof this.y&&(this.y=0)}return _createClass(Vector2,[{key:"set",value:function(x,y){return this.x=x,this.y=y,this}},{key:"clone",value:function(){return new Vector2(this.x,this.y)}},{key:"copy",value:function(other){return this.x=other.x,this.y=other.y,this}},{key:"clamp",value:function(minimum,maximum){var minimumSet=null!==minimum&&"undefined"!=typeof minimum,maximumSet=null!==maximum&&"undefined"!=typeof maximum;return minimum instanceof Vector2||!minimumSet||(minimum=new Vector2(minimum,minimum)),maximum instanceof Vector2||!maximumSet||(maximum=new Vector2(maximum,maximum)),minimumSet&&(this.x=Math.max(minimum.x,this.x),this.y=Math.max(minimum.y,this.y)),maximumSet&&(this.x=Math.min(maximum.x,this.x),this.y=Math.min(maximum.y,this.y)),this}},{key:"divide",value:function(divisor,y){return divisor instanceof Vector2?(this.x/=divisor.x,this.y/=divisor.y):(this.x/=divisor,this.y/="undefined"==typeof y?divisor:y),this}},{key:"subtract",value:function(subtrahend,y){return subtrahend instanceof Vector2?(this.x-=subtrahend.x,this.y-=subtrahend.y):(this.x-=subtrahend,this.y-="undefined"==typeof y?subtrahend:y),this}},{key:"multiply",value:function(factor,y){return factor instanceof Vector2?(this.x*=factor.x,this.y*=factor.y):(this.x*=factor,this.y*="undefined"==typeof y?factor:y),this}},{key:"add",value:function(addend,y){return addend instanceof Vector2?(this.x+=addend.x,this.y+=addend.y):(this.x+=addend,this.y+="undefined"==typeof y?addend:y),this}},{key:"equals",value:function(vec,y){return vec instanceof Vector2?vec.x===this.x&&vec.y===this.y:vec===this.x&&y===this.y}},{key:"flip",value:function(){var tempX=this.x;return this.x=this.y,this.y=tempX,this}},{key:"toString",value:function(){return"Vector2({ x: "+this.x+", y: "+this.y+" })"}}]),Vector2}();exports["default"]=Vector2,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);
subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_baseUi=__webpack_require__(75),_baseUi2=_interopRequireDefault(_baseUi),_libCanvas=__webpack_require__(76),_libCanvas2=_interopRequireDefault(_libCanvas),_libFileLoader=__webpack_require__(77),_libFileLoader2=_interopRequireDefault(_libFileLoader),_libTopControls=__webpack_require__(78),_libTopControls2=_interopRequireDefault(_libTopControls),_libScrollbar=__webpack_require__(79),_libScrollbar2=_interopRequireDefault(_libScrollbar),_constants=__webpack_require__(5),NightUI=function(_UI){function NightUI(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,NightUI),_get(Object.getPrototypeOf(NightUI.prototype),"constructor",this).apply(this,args),this._operationsMap={},this._template='<div class="imglykit-container">\n  <div class="imglykit-loadingOverlay">\n    <div class="imglykit-loadingOverlay-content">\n      <img src="{{= it.helpers.assetPath(\'ui/night/loading.gif\')}}" />\n      <span>Loading...</span>\n    </div>\n  </div>\n  {{? !it.options.ui.hideHeader }}\n  <div class="imglykit-header">\n    img.ly Photo Editor SDK\n\n    {{? it.options.ui.showCloseButton }}\n    <div class="imglykit-close-button">\n      <img src="{{=it.helpers.assetPath(\'ui/night/close.png\')}}" />\n    </div>\n    {{?}}\n  </div>\n  {{?}}\n  <div class="imglykit-top-controls{{? !it.options.ui.hideHeader }} imglykit-header-padding{{?}}">\n    <div class="imglykit-top-controls-left">\n      {{? it.options.ui.showNewButton }}\n      <div class="imglykit-new">\n        <img src="{{=it.helpers.assetPath(\'ui/night/top/new.png\')}}" />\n        New\n      </div>\n      {{?}}\n      <div class="imglykit-undo">\n        <img src="{{=it.helpers.assetPath(\'ui/night/top/undo.png\')}}" />\n        Undo\n      </div>\n      {{? it.options.ui.showExportButton }}\n      <div class="imglykit-export">\n        <img src="{{=it.helpers.assetPath(\'ui/night/top/export.png\')}}" />\n        Export\n      </div>\n      {{?}}\n    </div>\n    <div class="imglykit-top-controls-right">\n      <div class="imglykit-zoom-fit"></div>\n      <div class="imglykit-zoom-level">Zoom: <span class="imglykit-zoom-level-num">100</span>%</div>\n      <div class="imglykit-zoom-in">\n        <img src="{{=it.helpers.assetPath(\'ui/night/top/zoom-in.png\')}}" />\n      </div>\n      <div class="imglykit-zoom-out">\n        <img src="{{=it.helpers.assetPath(\'ui/night/top/zoom-out.png\')}}" />\n      </div>\n    </div>\n  </div>\n\n  <div class="imglykit-canvas-container{{? !it.options.ui.hideHeader }} imglykit-header-padding{{?}}">\n    <div class="imglykit-canvas-inner-container">\n      <canvas class="imglykit-canvas-draggable"></canvas>\n      <div class="imglykit-canvas-controls imglykit-canvas-controls-disabled"></div>\n    </div>\n    {{? it.renderDropArea }}\n    <div class="imglykit-drop-area-container{{? !it.options.ui.hideHeader }} imglykit-header-padding{{?}}">\n      <div class="imglykit-drop-area">\n        <input type="file" class="imglykit-drop-area-hidden-input" />\n        <img src="{{=it.helpers.assetPath(\'ui/night/upload.png\')}}" />\n\n        <div class="imglykit-drop-area-content">\n          <h1>Upload a picture</h1>\n          <span>Click to upload a picture from your library or just drag and drop</span>\n        </div>\n      </div>\n    </div>\n    {{?}}\n  </div>\n\n  <div class="imglykit-controls-container">\n    <div class="imglykit-controls">\n\n      <div>\n        <div class="imglykit-controls-overview">\n          <ul class="imglykit-controls-list">\n          {{ for (var identifier in it.controls) { }}\n            {{ var control = it.controls[identifier]; }}\n            <li data-identifier="{{= control.identifier}}"{{? it.controlsDisabled }} data-disabled{{?}}>\n              <img src="{{=it.helpers.assetPath(\'ui/night/operations/\' + control.identifier + \'.png\') }}" />\n            </li>\n          {{ } }}\n          </ul>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n',this._registeredControls={},this._history=[],this._preferredOperationOrder=["rotation","crop","flip","filters","contrast","brightness","saturation","radial-blur","tilt-shift","frames","stickers","text"],this._paused=!1,this._options.ui=_lodash2["default"].defaults(this._options.ui,{showNewButton:!this._options.image,showHeader:!0,showCloseButton:!1,showExportButton:!1,"export":{}}),this._options.ui["export"]=_lodash2["default"].defaults(this._options.ui["export"],{type:_constants.ImageFormat.JPEG,quality:.8})}return _inherits(NightUI,_UI),_createClass(NightUI,[{key:"run",value:function(){this._registerControls(),_get(Object.getPrototypeOf(NightUI.prototype),"run",this).call(this);var container=this._options.container;this._controlsContainer=container.querySelector(".imglykit-controls"),this._canvasControlsContainer=container.querySelector(".imglykit-canvas-controls"),this._overviewControlsContainer=container.querySelector(".imglykit-controls-overview"),this._loadingOverlay=container.querySelector(".imglykit-loadingOverlay"),this._loadingSpan=container.querySelector(".imglykit-loadingOverlay span"),this._handleOverview(),this._options.image&&this._initCanvas(),this._options.ui.showNewButton&&this._initFileLoader(),this._initTopControls(),this._initControls(),this._options.image&&this.showZoom(),this._options.ui.showCloseButton&&this._handleCloseButton(),this._topControls.updateExportButton()}},{key:"_initFileLoader",value:function(){this._fileLoader=new _libFileLoader2["default"](this._kit,this),this._fileLoader.on("file",this._onFileLoaded.bind(this))}},{key:"_onFileLoaded",value:function(file){var _this=this,reader=new FileReader;reader.onload=function(){return function(e){var data=e.target.result,image=new Image;image.addEventListener("load",function(){_this._setImage(image)}),image.src=data}}(file),reader.readAsDataURL(file)}},{key:"_setImage",value:function(image){this._options.image=image,this._canvas&&this._canvas.reset(),this._fileLoader.removeDOM(),this._canvas?this._canvas.setImage(this._options.image):this._initCanvas(),this.showZoom(),this._topControls.init(),this._enableControls(),this._topControls.updateExportButton()}},{key:"_initTopControls",value:function(){var _this2=this;this._topControls=new _libTopControls2["default"](this._kit,this),this._topControls.run(),this._topControls.on("undo",function(){_this2.undo()}),this._topControls.on("export",function(){_this2["export"]()}),this._topControls.on("zoom-in",function(){_this2._canvas.zoomIn().then(function(){_this2._currentControl&&_this2._currentControl.onZoom()})}),this._topControls.on("zoom-out",function(){_this2._canvas.zoomOut().then(function(){_this2._currentControl&&_this2._currentControl.onZoom()})})}},{key:"_initCanvas",value:function(){var _this3=this;this._canvas=new _libCanvas2["default"](this._kit,this,this._options),this._canvas.run(),this._canvas.on("zoom",function(){_this3._topControls.updateZoomLevel()})}},{key:"selectOperations",value:function(selector){_get(Object.getPrototypeOf(NightUI.prototype),"selectOperations",this).call(this,selector)}},{key:"getOrCreateOperation",value:function(identifier){var _kit=this._kit,operationsStack=_kit.operationsStack,registeredOperations=_kit.registeredOperations,Operation=registeredOperations[identifier];if("undefined"==typeof this._operationsMap[identifier]){var operationInstance=new Operation(this._kit);this._operationsMap[identifier]=operationInstance;var index=this._preferredOperationOrder.indexOf(identifier);return-1===index&&(index=this._preferredOperationOrder.length),operationsStack[index]=operationInstance,operationInstance}return this._operationsMap[identifier]}},{key:"removeOperation",value:function(identifier){if(this._operationsMap[identifier]){var operation=this._operationsMap[identifier];delete this._operationsMap[identifier];var index=this._kit.operationsStack.indexOf(operation);this._kit.operationsStack.splice(index,1)}}},{key:"_registerControls",value:function(){this.registerControl("filters","filters",__webpack_require__(80)),this.registerControl("rotation","rotation",__webpack_require__(81)),this.registerControl("flip","flip",__webpack_require__(82)),this.registerControl("brightness","brightness",__webpack_require__(83)),this.registerControl("contrast","contrast",__webpack_require__(84)),this.registerControl("saturation","saturation",__webpack_require__(85)),this.registerControl("crop","crop",__webpack_require__(86)),this.registerControl("radial-blur","radial-blur",__webpack_require__(87)),this.registerControl("tilt-shift","tilt-shift",__webpack_require__(88)),this.registerControl("frames","frames",__webpack_require__(89)),this.registerControl("stickers","stickers",__webpack_require__(90)),this.registerControl("text","text",__webpack_require__(91))}},{key:"_handleOverview",value:function(){var _this4=this,listItems=this._overviewControlsContainer.querySelectorAll(":scope > ul > li");listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=listItems[i],identifier=listItem.dataset.identifier;listItem.addEventListener("click",function(){_this4.switchToControl(identifier)})},i=0;i<listItems.length;i++)_loop(i)}},{key:"_enableControls",value:function(){var listItems=this._overviewControlsContainer.querySelectorAll(":scope > ul > li");listItems=Array.prototype.slice.call(listItems);for(var i=0;i<listItems.length;i++){var listItem=listItems[i];listItem.removeAttribute("data-disabled")}}},{key:"switchToControl",value:function(identifier){this.context.controlsDisabled||(this._overviewControlsContainer.style.display="none",this._scrollbar.remove(),this._currentControl&&this._currentControl.leave(),this._currentControl=this._registeredControls[identifier],this._currentControl.enter(),this._currentControl.once("back",this._switchToOverview.bind(this)))}},{key:"_switchToOverview",value:function(){this._currentControl&&this._currentControl.leave(),this._currentControl=null,this._overviewControlsContainer.style.display="",this._initScrollbar()}},{key:"registerControl",value:function(identifier,operationIdentifier,ControlClass){if(this.isOperationSelected(operationIdentifier)){var instance=new ControlClass(this._kit,this);this._registeredControls[identifier]=instance}}},{key:"_initControls",value:function(){for(var identifier in this._registeredControls){var control=this._registeredControls[identifier];control.setContainers(this._controlsContainer,this._canvasControlsContainer),control.init()}this._initScrollbar()}},{key:"_initScrollbar",value:function(){var container=this._controlsContainer.querySelector(".imglykit-controls-list").parentNode;this._scrollbar=new _libScrollbar2["default"](container)}},{key:"_handleCloseButton",value:function(){var _this5=this,closeButton=this._options.container.querySelector(".imglykit-close-button");closeButton.addEventListener("click",function(e){e.preventDefault(),_this5.emit("close")})}},{key:"render",value:function(){this._canvas&&this._canvas.render()}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){var rerender=void 0===arguments[0]?!0:arguments[0];this._paused=!1,rerender&&this.render()}},{key:"addHistory",value:function(operation,options,existent){this._history.push({operation:operation,options:options,existent:existent}),this._topControls.updateUndoButton()}},{key:"hideZoom",value:function(){this._topControls.hideZoom()}},{key:"showZoom",value:function(){this._topControls.showZoom()}},{key:"undo",value:function(){var lastItem=this._history.pop();if(lastItem){var operation=lastItem.operation,existent=lastItem.existent,options=lastItem.options;existent?(operation=this.getOrCreateOperation(operation.identifier),operation.set(options)):this.removeOperation(operation.identifier),this.canvas.zoomToFit(!0)}this._topControls.updateUndoButton()}},{key:"export",value:function(){var _this6=this;this.displayLoadingMessage("Exporting..."),setTimeout(function(){_this6._kit.render(_constants.RenderType.DATAURL,_this6._options.ui["export"].type,_this6._options.ui["export"].dimensions,_this6._options.ui["export"].quality).then(function(data){var link=document.createElement("a"),extension=_this6._options.ui["export"].type.split("/").pop();link.download="imglykit-export."+extension,link.href=data,document.body.appendChild(link),link.click(),document.body.removeChild(link),_this6.hideLoadingMessage()})},1e3)}},{key:"displayLoadingMessage",value:function(message){this._loadingSpan.innerText=message,this._loadingOverlay.style.display="block"}},{key:"hideLoadingMessage",value:function(){this._loadingOverlay.style.display="none"}},{key:"identifier",get:function(){return"night"}},{key:"operations",get:function(){return this._operationsMap}},{key:"controls",get:function(){return this._registeredControls}},{key:"context",get:function(){var context=_get(Object.getPrototypeOf(NightUI.prototype),"context",this);return context.controls=this._registeredControls,context.renderDropArea=this._options.ui.showNewButton,context.controlsDisabled=!this._options.image,context}},{key:"history",get:function(){return this._history}},{key:"fileLoader",get:function(){return this._fileLoader}}]),NightUI}(_baseUi2["default"]);NightUI.Control=__webpack_require__(92),exports["default"]=NightUI,module.exports=exports["default"]},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){module.exports=__WEBPACK_EXTERNAL_MODULE_53__},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ImageDimensions=function(){function ImageDimensions(dimensions){_classCallCheck(this,ImageDimensions),this._modifiers={FIXED:"!"},this._dimensionsString=dimensions,this._rules=this._parse(),this._validateRules()}return _createClass(ImageDimensions,[{key:"_parse",value:function(){if("undefined"==typeof this._dimensionsString||null===this._dimensionsString)return null;var match=this._dimensionsString.match(/^([0-9]+)?x([0-9]+)?([\!])?$/i);if(!match)throw new Error("Invalid size option: "+this._dimensionsString);return{x:isNaN(match[1])?null:parseInt(match[1],10),y:isNaN(match[2])?null:parseInt(match[2],10),modifier:match[3]}}},{key:"_validateRules",value:function(){if(null!==this._rules){var xAvailable=null!==this._rules.x,yAvailable=null!==this._rules.y;if(!(this._rules.modifier!==this._modifiers.FIXED||xAvailable&&yAvailable))throw new Error("Both `x` and `y` have to be set when using the fixed (!) modifier.");if(!xAvailable&&!yAvailable)throw new Error("Neither `x` nor `y` are given.")}}},{key:"calculateFinalDimensions",value:function(initialDimensions){var ratio,dimensions=initialDimensions.clone();return null===this._rules?dimensions:(this._rules.modifier===this._modifiers.FIXED?dimensions.set(this._rules.x,this._rules.y):null!==this._rules.x&&null!==this._rules.y?(ratio=Math.min(this._rules.x/dimensions.x,this._rules.y/dimensions.y),dimensions.multiply(ratio)):null!==this._rules.x?(ratio=initialDimensions.y/initialDimensions.x,dimensions.x=this._rules.x,dimensions.y=dimensions.x*ratio):null!==this._rules.y&&(ratio=initialDimensions.x/initialDimensions.y,dimensions.y=this._rules.y,dimensions.x=dimensions.y*ratio),dimensions)}}]),ImageDimensions}();exports["default"]=ImageDimensions,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_renderer=__webpack_require__(95),_renderer2=_interopRequireDefault(_renderer),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),CanvasRenderer=function(_Renderer){function CanvasRenderer(){_classCallCheck(this,CanvasRenderer),null!=_Renderer&&_Renderer.apply(this,arguments)}return _inherits(CanvasRenderer,_Renderer),_createClass(CanvasRenderer,[{key:"cache",value:function(identifier){this._cache[identifier]={data:this._context.getImageData(0,0,this._canvas.width,this._canvas.height),size:new _libMathVector22["default"](this._canvas.width,this._canvas.height)}}},{key:"drawCached",value:function(identifier){var _cache$identifier=this._cache[identifier],data=_cache$identifier.data,size=_cache$identifier.size;this._canvas.width=size.x,this._canvas.height=size.y,this._context.putImageData(data,0,0)}},{key:"_getContext",value:function(){return this._canvas.getContext("2d")}},{key:"drawImage",value:function(image){var _this=this;return new Promise(function(resolve,reject){_this._context.drawImage(image,0,0,image.width,image.height,0,0,_this._canvas.width,_this._canvas.height),resolve()})}},{key:"resizeTo",value:function(dimensions){var newCanvas=this.createCanvas();newCanvas.width=dimensions.x,newCanvas.height=dimensions.y;var newContext=newCanvas.getContext("2d");newContext.drawImage(this._canvas,0,0,this._canvas.width,this._canvas.height,0,0,newCanvas.width,newCanvas.height),this.setCanvas(newCanvas)}},{key:"cloneCanvas",value:function(){var canvas=this.createCanvas(),context=canvas.getContext("2d");return canvas.width=this._canvas.width,canvas.height=this._canvas.height,context.drawImage(this._canvas,0,0),canvas}},{key:"reset",value:function(){var resetCache=void 0===arguments[0]?!1:arguments[0];resetCache&&(this._cache=[])}}],[{key:"isSupported",value:function(){var elem=this.prototype.createCanvas();return!(!elem.getContext||!elem.getContext("2d"))}},{key:"identifier",get:function(){return"canvas"}}]),CanvasRenderer}(_renderer2["default"]);exports["default"]=CanvasRenderer,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_renderer=__webpack_require__(95),_renderer2=_interopRequireDefault(_renderer),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libExifRestorer=__webpack_require__(57),_libExifRestorer2=_interopRequireDefault(_libExifRestorer),WebGLRenderer=function(_Renderer){function WebGLRenderer(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,WebGLRenderer),_get(Object.getPrototypeOf(WebGLRenderer.prototype),"constructor",this).apply(this,args),this._defaultProgram=this.setupGLSLProgram(),this.reset()}return _inherits(WebGLRenderer,_Renderer),_createClass(WebGLRenderer,[{key:"cache",value:function(identifier){var size=new _libMathVector22["default"](this._canvas.width,this._canvas.height),fbo=void 0,texture=void 0,cacheObject=void 0;cacheObject=this._cache[identifier]?this._cache[identifier]:this._createFramebuffer(),fbo=cacheObject.fbo,texture=cacheObject.texture;var gl=this._context;gl.useProgram(this._defaultProgram),gl.bindTexture(gl.TEXTURE_2D,texture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,size.x,size.y,0,gl.RGBA,gl.UNSIGNED_BYTE,null),gl.bindFramebuffer(gl.FRAMEBUFFER,fbo),gl.viewport(0,0,size.x,size.y),gl.bindTexture(gl.TEXTURE_2D,this._lastTexture),gl.drawArrays(gl.TRIANGLES,0,6),this._cache[identifier]={fbo:fbo,texture:texture,size:size}}},{key:"_drawCachedFinal",value:function(identifier){var _cache$identifier=this._cache[identifier],texture=_cache$identifier.texture,size=_cache$identifier.size,gl=this._context;gl.useProgram(this._defaultProgram),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,texture),this._canvas.width=size.x,this._canvas.height=size.y,gl.viewport(0,0,size.x,size.y),gl.drawArrays(gl.TRIANGLES,0,6)}},{key:"drawCached",value:function(identifier){var _cache$identifier2=this._cache[identifier],texture=_cache$identifier2.texture,size=_cache$identifier2.size,fbo=this.getCurrentFramebuffer(),currentTexture=this.getCurrentTexture(),gl=this._context;gl.useProgram(this._defaultProgram),this._canvas.width=size.x,this._canvas.height=size.y;for(var i=0;i<this._textures.length;i++){var otherTexture=this._textures[i];gl.bindTexture(gl.TEXTURE_2D,otherTexture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,size.x,size.y,0,gl.RGBA,gl.UNSIGNED_BYTE,null)}gl.bindFramebuffer(gl.FRAMEBUFFER,fbo),gl.bindTexture(gl.TEXTURE_2D,currentTexture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,size.x,size.y,0,gl.RGBA,gl.UNSIGNED_BYTE,null),gl.bindTexture(gl.TEXTURE_2D,texture),gl.viewport(0,0,size.x,size.y),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.drawArrays(gl.TRIANGLES,0,6),this.setLastTexture(currentTexture),this.selectNextBuffer()}},{key:"_getContext",value:function(){var gl=this._canvas.getContext("webgl",this._contextOptions)||this._canvas.getContext("webgl-experimental",this._contextOptions);return gl.disable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),this._maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE),gl}},{key:"drawImage",value:function(image){var _this=this;return new Promise(function(resolve,reject){var gl=_this._context;gl.useProgram(_this._defaultProgram);var texture=_this.createTexture();gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),_this._inputTexture=texture,_this.setLastTexture(texture),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,image),_this._clear(gl),gl.drawArrays(gl.TRIANGLES,0,6),resolve()})}},{key:"prepareImage",value:function(image){if(image.width<=this._maxTextureSize&&image.height<=this._maxTextureSize)return Promise.resolve(image);var maxSize=new _libMathVector22["default"](this._maxTextureSize,this._maxTextureSize),size=new _libMathVector22["default"](image.width,image.height),scale=Math.min(maxSize.x/size.x,maxSize.y/size.y),newSize=size.clone().multiply(scale),canvas=this.createCanvas(newSize.x,newSize.y),context=canvas.getContext("2d");context.drawImage(image,0,0,size.x,size.y,0,0,newSize.x,newSize.y);var data=canvas.toDataURL("image/jpeg"),jpegMatch=/^data:image\/jpeg/i;return image.src.match(jpegMatch)&&data.match(jpegMatch)&&(data=_libExifRestorer2["default"].restore(image.src,data)),new Promise(function(resolve,reject){var image=new Image;image.addEventListener("load",function(){resolve(image)}),image.src=data})}},{key:"_clear",value:function(gl){gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT)}},{key:"runShader",value:function(vertexShader,fragmentShader,options){"undefined"==typeof options&&(options={}),"undefined"==typeof options.uniforms&&(options.uniforms={});var gl=this._context,program=this.setupGLSLProgram(vertexShader,fragmentShader);gl.useProgram(program);var fbo=this.getCurrentFramebuffer(),currentTexture=this.getCurrentTexture();gl.bindFramebuffer(gl.FRAMEBUFFER,fbo),gl.viewport(0,0,this._canvas.width,this._canvas.height),gl.bindTexture(gl.TEXTURE_2D,currentTexture),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,this._canvas.width,this._canvas.height,0,gl.RGBA,gl.UNSIGNED_BYTE,null),gl.bindTexture(gl.TEXTURE_2D,this._lastTexture);for(var name in options.uniforms){var location=gl.getUniformLocation(program,name),uniform=options.uniforms[name];switch(uniform.type){case"i":case"1i":gl.uniform1i(location,uniform.value);break;case"f":case"1f":gl.uniform1f(location,uniform.value);break;case"2f":gl.uniform2f(location,uniform.value[0],uniform.value[1]);break;case"3f":gl.uniform3f(location,uniform.value[0],uniform.value[1],uniform.value[2]);break;case"4f":gl.uniform4f(location,uniform.value[0],uniform.value[1],uniform.value[2],uniform.value[3]);break;case"2fv":gl.uniform2fv(location,uniform.value);break;case"mat3fv":gl.uniformMatrix3fv(location,!1,uniform.value);break;default:throw new Error("Unknown uniform type: "+uniform.type)}}gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.drawArrays(gl.TRIANGLES,0,6),this.setLastTexture(currentTexture),this.selectNextBuffer()}},{key:"renderFinal",value:function(){var gl=this._context,program=this._defaultProgram;gl.useProgram(program),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.viewport(0,0,this._canvas.width,this._canvas.height),gl.bindTexture(gl.TEXTURE_2D,this._lastTexture),this._clear(gl),gl.drawArrays(gl.TRIANGLES,0,6)}},{key:"setupGLSLProgram",value:function(vertexShader,fragmentShader){var gl=this._context,shaders=[];vertexShader=this._createShader(gl.VERTEX_SHADER,vertexShader||WebGLRenderer.prototype.defaultVertexShader),shaders.push(vertexShader),fragmentShader=this._createShader(gl.FRAGMENT_SHADER,fragmentShader||WebGLRenderer.prototype.defaultFragmentShader),shaders.push(fragmentShader);for(var program=gl.createProgram(),i=0;i<shaders.length;i++)gl.attachShader(program,shaders[i]);gl.linkProgram(program);var linked=gl.getProgramParameter(program,gl.LINK_STATUS);if(!linked){var lastError=gl.getProgramInfoLog(program);throw gl.deleteProgram(program),new Error("WebGL program linking error: "+lastError)}var positionLocation=gl.getAttribLocation(program,"a_position"),texCoordLocation=gl.getAttribLocation(program,"a_texCoord"),texCoordBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,texCoordBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),gl.STATIC_DRAW),gl.enableVertexAttribArray(texCoordLocation),gl.vertexAttribPointer(texCoordLocation,2,gl.FLOAT,!1,0,0);var buffer=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,buffer),gl.enableVertexAttribArray(positionLocation),gl.vertexAttribPointer(positionLocation,2,gl.FLOAT,!1,0,0),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),gl.STATIC_DRAW),program}},{key:"_createShader",value:function(shaderType,shaderSource){var gl=this._context,shader=gl.createShader(shaderType);gl.shaderSource(shader,shaderSource),gl.compileShader(shader);var compiled=gl.getShaderParameter(shader,gl.COMPILE_STATUS);if(!compiled){var lastError=gl.getShaderInfoLog(shader);throw gl.deleteShader(shader),new Error("WebGL shader compilation error: "+lastError)}return shader}},{key:"createTexture",value:function(){var gl=this._context,texture=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),texture}},{key:"_createFramebuffers",value:function(){for(var i=0;2>i;i++){var _createFramebuffer2=this._createFramebuffer(),fbo=_createFramebuffer2.fbo,texture=_createFramebuffer2.texture;this._textures.push(texture),this._framebuffers.push(fbo)}}},{key:"_createFramebuffer",value:function(){var gl=this._context,texture=this.createTexture();gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,this._canvas.width,this._canvas.height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var fbo=gl.createFramebuffer();return gl.bindFramebuffer(gl.FRAMEBUFFER,fbo),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,texture,0),{fbo:fbo,texture:texture}}},{key:"resizeTo",value:function(dimensions){var gl=this._context;this._canvas.width=dimensions.x,this._canvas.height=dimensions.y,gl.viewport(0,0,this._canvas.width,this._canvas.height),gl.drawArrays(gl.TRIANGLES,0,6)}},{key:"getCurrentFramebuffer",value:function(){return this._framebuffers[this._bufferIndex%2]}},{key:"getCurrentTexture",value:function(){return this._textures[this._bufferIndex%2]}},{key:"selectNextBuffer",value:function(){this._bufferIndex++}},{key:"getDefaultProgram",value:function(){return this._defaultProgram}},{key:"getLastTexture",value:function(){return this._lastTexture}},{key:"getTextures",value:function(){return this._textures}},{key:"setLastTexture",value:function(texture){this._lastTexture=texture}},{key:"reset",value:function(){
var resetCache=void 0===arguments[0]?!1:arguments[0];this._lastTexture=null,this._textures=[],this._framebuffers=[],this._bufferIndex=0,resetCache&&(this._cache=[]),this._createFramebuffers(),this.setLastTexture(this._inputTexture)}},{key:"_contextOptions",get:function(){return{alpha:!0,premultipliedAlpha:!0}}},{key:"identifier",get:function(){return"webgl"}},{key:"defaultVertexShader",get:function(){var shader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    ";return shader}},{key:"defaultFragmentShader",get:function(){var shader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_FragColor = texture2D(u_image, v_texCoord);\n      }\n    ";return shader}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}}],[{key:"isSupported",value:function(){return!("undefined"==typeof window||!window.WebGLRenderingContext)}}]),WebGLRenderer}(_renderer2["default"]);exports["default"]=WebGLRenderer,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_base64=__webpack_require__(94),_base642=_interopRequireDefault(_base64),DATA_JPEG_PREFIX="data:image/jpeg;base64,",ExifRestorer=function(){function ExifRestorer(){_classCallCheck(this,ExifRestorer)}return _createClass(ExifRestorer,null,[{key:"restore",value:function(originalData,newData){if(!originalData.match(DATA_JPEG_PREFIX))return newData;var rawImage=_base642["default"].decode(originalData.replace(DATA_JPEG_PREFIX,"")),segments=this._sliceIntoSegments(rawImage),image=this._exifManipulation(newData,segments);return DATA_JPEG_PREFIX+_base642["default"].encode(image)}},{key:"_exifManipulation",value:function(data,segments){var exifArray=this._getExifArray(segments),newImageArray=this._insertExif(data,exifArray),buffer=new Uint8Array(newImageArray);return buffer}},{key:"_getExifArray",value:function(segments){for(var seg=void 0,i=0;i<segments.length;i++)if(seg=segments[i],255===seg[0]&&225===seg[1])return seg;return[]}},{key:"_insertExif",value:function(data,exifArray){var imageData=data.replace(DATA_JPEG_PREFIX,""),buf=_base642["default"].decode(imageData),separatePoint=buf.indexOf(255,3),mae=buf.slice(0,separatePoint),ato=buf.slice(separatePoint),array=mae;return array=array.concat(exifArray),array=array.concat(ato)}},{key:"_sliceIntoSegments",value:function(data){for(var head=0,segments=[];;){if(255===data[head]&&218===data[head+1])break;if(255===data[head]&&216===data[head+1])head+=2;else{var _length=256*data[head+2]+data[head+3],endPoint=head+_length+2,seg=data.slice(head,endPoint);segments.push(seg),head=endPoint}if(head>data.length)break}return segments}}]),ExifRestorer}();exports["default"]=ExifRestorer,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";module.exports=function(prototypeProperties,classProperties){var child,parent=this;child=prototypeProperties&&prototypeProperties.hasOwnProperty("constructor")?prototypeProperties.constructor:function(){return parent.apply(this,arguments)};var key;for(key in parent)child[key]=parent[key];if("undefined"!=typeof classProperties)for(key in classProperties)child[key]=classProperties[key];var Surrogate=function(){this.constructor=child};if(Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,prototypeProperties)for(key in prototypeProperties)child.prototype[key]=prototypeProperties[key];return child.__super__=parent.prototype,child}},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),PrimitivesStack=function(){function PrimitivesStack(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,PrimitivesStack),this._stack=[]}return _createClass(PrimitivesStack,[{key:"add",value:function(primitive){this._stack.push(primitive)}},{key:"render",value:function(renderer){for(var i=0;i<this._stack.length;i++){var primitive=this._stack[i];primitive.render(renderer)}}}]),PrimitivesStack}();exports["default"]=PrimitivesStack,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Saturation=function(_Primitive){function Saturation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Saturation),_get(Object.getPrototypeOf(Saturation.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{saturation:0}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_saturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, luminanceWeighting);\n\n        vec3 greyScaleColor = vec3(luminance);\n\n        gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n      }\n    "}return _inherits(Saturation,_Primitive),_createClass(Saturation,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_saturation:{type:"f",value:this._options.saturation}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),saturation=this._options.saturation,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),luminance=.2125*imageData.data[index]+.7154*imageData.data[index+1]+.0721*imageData.data[index+2];imageData.data[index]=luminance*(1-saturation)+imageData.data[index]*saturation,imageData.data[index+1]=luminance*(1-saturation)+imageData.data[index+1]*saturation,imageData.data[index+2]=luminance*(1-saturation)+imageData.data[index+2]*saturation}renderer.getContext().putImageData(imageData,0,0)}}]),Saturation}(_primitive2["default"]);exports["default"]=Saturation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),LookupTable=function(_Primitive){function LookupTable(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,LookupTable),_get(Object.getPrototypeOf(LookupTable.prototype),"constructor",this).apply(this,args),this._textureIndex=3,this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_lookupTable;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n        float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n        float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n        gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n      }\n    "}return _inherits(LookupTable,_Primitive),_createClass(LookupTable,[{key:"renderWebGL",value:function(renderer){this._updateTexture(renderer),renderer.runShader(null,this._fragmentShader,{uniforms:{u_lookupTable:{type:"i",value:3}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),table=this._options.data,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),r=imageData.data[index];imageData.data[index]=table[4*r];var g=imageData.data[index+1];imageData.data[index+1]=table[1+4*g];var b=imageData.data[index+2];imageData.data[index+2]=table[2+4*b]}renderer.getContext().putImageData(imageData,0,0)}},{key:"_updateTexture",value:function(renderer){var gl=renderer.getContext();if("undefined"==typeof this._options.data)throw new Error("LookupTable: No data specified.");var dataTypedArray=new Uint8Array(this._options.data);gl.activeTexture(gl.TEXTURE0+this._textureIndex),this._texture||(this._texture=gl.createTexture()),gl.bindTexture(gl.TEXTURE_2D,this._texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,256,1,0,gl.RGBA,gl.UNSIGNED_BYTE,dataTypedArray),gl.activeTexture(gl.TEXTURE0)}}]),LookupTable}(_primitive2["default"]);exports["default"]=LookupTable,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_lookupTable=__webpack_require__(61),_lookupTable2=_interopRequireDefault(_lookupTable),ToneCurve=function(_LookupTable){function ToneCurve(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,ToneCurve),_get(Object.getPrototypeOf(ToneCurve.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{rgbControlPoints:{red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}}),"undefined"!=typeof this._options.rgbControlPoints&&this._updateLookupTable()}return _inherits(ToneCurve,_LookupTable),_createClass(ToneCurve,[{key:"_updateLookupTable",value:function(){var r=this._calculateSplineCurve(this._options.rgbControlPoints.red),g=this._calculateSplineCurve(this._options.rgbControlPoints.green),b=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(r,g,b)}},{key:"_buildLookupTable",value:function(r,g,b){for(var data=[],i=0;256>i;i++)data.push(Math.min(Math.max(i+r[i],0),255)),data.push(Math.min(Math.max(i+g[i],0),255)),data.push(Math.min(Math.max(i+b[i],0),255)),data.push(255);return data}},{key:"_calculateSplineCurve",value:function(points){points=points.sort(function(a,b){return a[0]>b[0]});var i,splinePoints=this._getSplineCurve(points),firstSplinePoint=splinePoints[0];if(firstSplinePoint[0]>0)for(i=0;i<firstSplinePoint[0];i++)splinePoints.unshift([0,0]);var preparedPoints=[];for(i=0;i<splinePoints.length;i++){var newPoint=splinePoints[i],origPoint=[newPoint[0],newPoint[0]],distance=Math.sqrt(Math.pow(origPoint[0]-newPoint[0],2)+Math.pow(origPoint[1]-newPoint[1],2));origPoint[1]>newPoint[1]&&(distance=-distance),preparedPoints.push(distance)}return preparedPoints}},{key:"_getSplineCurve",value:function(points){var i,sdA=this._secondDerivative(points),n=sdA.length,sd=[];for(i=0;n>i;i++)sd[i]=sdA[i];var output=[];for(i=0;n-1>i;i++)for(var cur=points[i],next=points[i+1],x=cur[0];x<next[0];x++){var t=(x-cur[0])/(next[0]-cur[0]),a=1-t,b=t,h=next[0]-cur[0],y=a*cur[1]+b*next[1]+h*h/6*((a*a*a-a)*sd[i]+(b*b*b-b)*sd[i+1]);y>255?y=255:0>y&&(y=0),output.push([x,y])}return 255===output.length&&output.push(points[points.length-1]),output}},{key:"_secondDerivative",value:function(points){var n=points.length;if(0>=n||1===n)return null;var i,k,matrix=[],result=[];for(matrix[0]=[0,1,0],i=1;n-1>i;i++){var P1=points[i-1],P2=points[i],P3=points[i+1];matrix[i]=matrix[i]||[],matrix[i][0]=(P2[0]-P1[0])/6,matrix[i][1]=(P3[0]-P1[0])/3,matrix[i][2]=(P3[0]-P2[0])/6,result[i]=(P3[1]-P2[1])/(P3[0]-P2[0])-(P2[1]-P1[1])/(P2[0]-P1[0])}for(result[0]=0,result[n-1]=0,matrix[n-1]=[0,1,0],i=1;n>i;i++)k=matrix[1][0]/matrix[i-1][1],matrix[i][1]-=k*matrix[i-1][2],matrix[i][0]=0,result[i]-=k*result[i-1];for(i=n-2;i>0;i--)k=matrix[i][2]/matrix[i+1][1],matrix[i][1]-=k*matrix[i+1][0],matrix[i][2]=0,result[i]-=k*result[i+1];var y2=[];for(i=0;n>i;i++)y2[i]=result[i]/matrix[i][1];return y2}}]),ToneCurve}(_lookupTable2["default"]);exports["default"]=ToneCurve,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),SoftColorOverlay=function(_Primitive){function SoftColorOverlay(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,SoftColorOverlay),_get(Object.getPrototypeOf(SoftColorOverlay.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{color:new _libColor2["default"](1,1,1)}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform vec3 u_overlay;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec4 overlayVec4 = vec4(u_overlay, texColor.a);\n        gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n      }\n    "}return _inherits(SoftColorOverlay,_Primitive),_createClass(SoftColorOverlay,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_overlay:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x);imageData.data[index]=Math.max(this._options.color.r,imageData.data[index]),imageData.data[index+1]=Math.max(this._options.color.g,imageData.data[index+1]),imageData.data[index+2]=Math.max(this._options.color.b,imageData.data[index+2])}renderer.getContext().putImageData(imageData,0,0)}}]),SoftColorOverlay}(_primitive2["default"]);exports["default"]=SoftColorOverlay,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Desaturation=function(_Primitive){function Desaturation(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Desaturation),_get(Object.getPrototypeOf(Desaturation.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{desaturation:1}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_desaturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n        vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n        gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n      }\n    "}return _inherits(Desaturation,_Primitive),_createClass(Desaturation,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_desaturation:{type:"f",value:this._options.desaturation}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),desaturation=this._options.desaturation,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),luminance=.3*imageData.data[index]+.59*imageData.data[index+1]+.11*imageData.data[index+2];imageData.data[index]=luminance*(1-desaturation)+imageData.data[index]*desaturation,imageData.data[index+1]=luminance*(1-desaturation)+imageData.data[index+1]*desaturation,imageData.data[index+2]=luminance*(1-desaturation)+imageData.data[index+2]*desaturation}renderer.getContext().putImageData(imageData,0,0)}}]),Desaturation}(_primitive2["default"]);exports["default"]=Desaturation,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),X400=function(_Primitive){function X400(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,X400),_get(Object.getPrototypeOf(X400.prototype),"constructor",this).apply(this,args),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n        gray -= 0.2;\n        gray = clamp(gray, 0.0, 1.0);\n        gray += 0.15;\n        gray *= 1.4;\n        gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n      }\n    "}return _inherits(X400,_Primitive),_createClass(X400,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),gray=imageData.data[index]/255*.3+imageData.data[index+1]/255*.3+imageData.data[index+2]/255*.3;gray-=.2,gray=Math.max(0,Math.min(1,gray)),gray+=.15,gray*=1.4,gray*=255,imageData.data[index]=gray,imageData.data[index+1]=gray,imageData.data[index+2]=gray}renderer.getContext().putImageData(imageData,0,0)}}]),X400}(_primitive2["default"]);exports["default"]=X400,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Grayscale=function(_Primitive){function Grayscale(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Grayscale),_get(Object.getPrototypeOf(Grayscale.prototype),"constructor",this).apply(this,args),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      vec3 W = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, W);\n        gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n      }\n    "}return _inherits(Grayscale,_Primitive),_createClass(Grayscale,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),luminance=.2125*imageData.data[index]+.7154*imageData.data[index+1]+.0721*imageData.data[index+2];imageData.data[index]=luminance,imageData.data[index+1]=luminance,imageData.data[index+2]=luminance}renderer.getContext().putImageData(imageData,0,0)}}]),Grayscale}(_primitive2["default"]);exports["default"]=Grayscale,module.exports=exports["default"]},function(module,exports,__webpack_require__){
"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Contrast=function(_Primitive){function Contrast(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Contrast),_get(Object.getPrototypeOf(Contrast.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{contrast:1}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_contrast;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n      }\n    "}return _inherits(Contrast,_Primitive),_createClass(Contrast,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_contrast:{type:"f",value:this._options.contrast}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),contrast=this._options.contrast,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x);imageData.data[index]=(imageData.data[index]-127)*contrast+127,imageData.data[index+1]=(imageData.data[index+1]-127)*contrast+127,imageData.data[index+2]=(imageData.data[index+2]-127)*contrast+127}renderer.getContext().putImageData(imageData,0,0)}}]),Contrast}(_primitive2["default"]);exports["default"]=Contrast,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),Glow=function(_Primitive){function Glow(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Glow),_get(Object.getPrototypeOf(Glow.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{color:new _libColor2["default"](1,1,1)}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      uniform vec3 u_color;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n\n        vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n        textureCoord /= 0.75;\n\n        float d = 1.0 - dot(textureCoord, textureCoord);\n        d = clamp(d, 0.2, 1.0);\n        vec3 newColor = texColor.rgb * d * u_color.rgb;\n        gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n      }\n    "}return _inherits(Glow,_Primitive),_createClass(Glow,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_color:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function(renderer){for(var d,canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),color=this._options.color,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x),x01=x/canvas.width,y01=y/canvas.height,nx=(x01-.5)/.75,ny=(y01-.5)/.75,scalarX=nx*nx,scalarY=ny*ny;d=1-(scalarX+scalarY),d=Math.min(Math.max(d,.1),1),imageData.data[index]=imageData.data[index]*d*color.r,imageData.data[index+1]=imageData.data[index+1]*d*color.g,imageData.data[index+2]=imageData.data[index+2]*d*color.b,imageData.data[index+3]=255}renderer.getContext().putImageData(imageData,0,0)}}]),Glow}(_primitive2["default"]);exports["default"]=Glow,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Gobblin=function(_Primitive){function Gobblin(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Gobblin),_get(Object.getPrototypeOf(Gobblin.prototype),"constructor",this).apply(this,args),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        texColor.b = texColor.g * 0.33;\n        texColor.r = texColor.r * 0.6;\n        texColor.b += texColor.r * 0.33;\n        texColor.g = texColor.g * 0.7;\n        gl_FragColor = texColor;\n      }\n    "}return _inherits(Gobblin,_Primitive),_createClass(Gobblin,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x);imageData.data[index+2]=.33*imageData.data[index+1],imageData.data[index]=.6*imageData.data[index],imageData.data[index+2]+=.33*imageData.data[index],imageData.data[index+1]=.7*imageData.data[index+1],imageData.data[index+3]=255}renderer.getContext().putImageData(imageData,0,0)}}]),Gobblin}(_primitive2["default"]);exports["default"]=Gobblin,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),_primitive=__webpack_require__(96),_primitive2=_interopRequireDefault(_primitive),Brightness=function(_Primitive){function Brightness(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];_classCallCheck(this,Brightness),_get(Object.getPrototypeOf(Brightness.prototype),"constructor",this).apply(this,args),this._options=_lodash2["default"].defaults(this._options,{brightness:1}),this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_brightness;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n      }\n    "}return _inherits(Brightness,_Primitive),_createClass(Brightness,[{key:"renderWebGL",value:function(renderer){renderer.runShader(null,this._fragmentShader,{uniforms:{u_brightness:{type:"f",value:this._options.brightness}}})}},{key:"renderCanvas",value:function(renderer){for(var canvas=renderer.getCanvas(),imageData=renderer.getContext().getImageData(0,0,canvas.width,canvas.height),brightness=this._options.brightness,x=0;x<canvas.width;x++)for(var y=0;y<canvas.height;y++){var index=4*(canvas.width*y+x);imageData.data[index]=imageData.data[index]+255*brightness,imageData.data[index+1]=imageData.data[index+1]+255*brightness,imageData.data[index+2]=imageData.data[index+2]+255*brightness}renderer.getContext().putImageData(imageData,0,0)}}]),Brightness}(_primitive2["default"]);exports["default"]=Brightness,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_filter=__webpack_require__(8),_filter2=_interopRequireDefault(_filter),IdentityFilter=function(_Filter){function IdentityFilter(){_classCallCheck(this,IdentityFilter),null!=_Filter&&_Filter.apply(this,arguments)}return _inherits(IdentityFilter,_Filter),_createClass(IdentityFilter,[{key:"render",value:function(){}},{key:"name",get:function(){return"Original"}}],[{key:"identifier",get:function(){return"identity"}}]),IdentityFilter}(_filter2["default"]);exports["default"]=IdentityFilter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function error(message){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_len>_key;_key++)args[_key-1]=arguments[_key];console.error.apply(console,[message].concat(args)),console.trace()}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),DEFAULT_MAX_LISTENERS=12,EventEmitter=function(){function EventEmitter(){_classCallCheck(this,EventEmitter),this._maxListeners=DEFAULT_MAX_LISTENERS,this._events={}}return _createClass(EventEmitter,[{key:"on",value:function(type,listener){if("function"!=typeof listener)throw new TypeError;var listeners=this._events[type]||(this._events[type]=[]);return-1!==listeners.indexOf(listener)?this:(listeners.push(listener),listeners.length>this._maxListeners&&error("possible memory leak, added %i %s listeners,\n        use EventEmitter#setMaxListeners(number) if you\n        want to increase the limit (%i now)",listeners.length,type,this._maxListeners),this)}},{key:"once",value:function(type,listener){function onceCallback(){eventsInstance.off(type,onceCallback),listener.apply(null,arguments)}var eventsInstance=this;return this.on(type,onceCallback)}},{key:"off",value:function(type){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_len2>_key2;_key2++)args[_key2-1]=arguments[_key2];if(0===args.length)return this._events[type]=null,this;var listener=args[0];if("function"!=typeof listener)throw new TypeError;var listeners=this._events[type];if(!listeners||!listeners.length)return this;var indexOfListener=listeners.indexOf(listener);return-1===indexOfListener?this:(listeners.splice(indexOfListener,1),this)}},{key:"emit",value:function(type){for(var _len3=arguments.length,args=Array(_len3>1?_len3-1:0),_key3=1;_len3>_key3;_key3++)args[_key3-1]=arguments[_key3];var listeners=this._events[type];return listeners&&listeners.length?(listeners.forEach(function(fn){return fn.apply(null,args)}),!0):!1}},{key:"setMaxListeners",value:function(newMaxListeners){if(parseInt(newMaxListeners,10)!==newMaxListeners)throw new TypeError;this._maxListeners=newMaxListeners}}]),EventEmitter}();exports["default"]=EventEmitter,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function stackBlurCanvasRGBA(imageData,top_x,top_y,width,height,radius){if(!(isNaN(radius)||1>radius)){radius|=0;var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,a_sum,r_out_sum,g_out_sum,b_out_sum,a_out_sum,r_in_sum,g_in_sum,b_in_sum,a_in_sum,pr,pg,pb,pa,rbs,stackEnd,pixels=imageData.data,div=radius+radius+1,widthMinus1=width-1,heightMinus1=height-1,radiusPlus1=radius+1,sumFactor=radiusPlus1*(radiusPlus1+1)/2,stackStart=new BlurStack,stack=stackStart;for(i=1;div>i;i++)stack=stack.next=new BlurStack,i==radiusPlus1&&(stackEnd=stack);stack.next=stackStart;var stackIn=null,stackOut=null;yw=yi=0;var mul_sum=mul_table[radius],shg_sum=shg_table[radius];for(y=0;height>y;y++){for(r_in_sum=g_in_sum=b_in_sum=a_in_sum=r_sum=g_sum=b_sum=a_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(i=1;radiusPlus1>i;i++)p=yi+((i>widthMinus1?widthMinus1:i)<<2),r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[p+1])*rbs,b_sum+=(stack.b=pb=pixels[p+2])*rbs,a_sum+=(stack.a=pa=pixels[p+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next;for(stackIn=stackStart,stackOut=stackEnd,x=0;width>x;x++)pixels[yi+3]=pa=a_sum*mul_sum>>shg_sum,0!==pa?(pa=255/pa,pixels[yi]=(r_sum*mul_sum>>shg_sum)*pa,pixels[yi+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[yi+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[yi]=pixels[yi+1]=pixels[yi+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2,r_in_sum+=stackIn.r=pixels[p],g_in_sum+=stackIn.g=pixels[p+1],b_in_sum+=stackIn.b=pixels[p+2],a_in_sum+=stackIn.a=pixels[p+3],r_sum+=r_in_sum,g_sum+=g_in_sum,b_sum+=b_in_sum,a_sum+=a_in_sum,stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=4;yw+=width}for(x=0;width>x;x++){for(g_in_sum=b_in_sum=a_in_sum=r_in_sum=g_sum=b_sum=a_sum=r_sum=0,yi=x<<2,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(yp=width,i=1;radius>=i;i++)yi=yp+x<<2,r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[yi+1])*rbs,b_sum+=(stack.b=pb=pixels[yi+2])*rbs,a_sum+=(stack.a=pa=pixels[yi+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next,heightMinus1>i&&(yp+=width);for(yi=x,stackIn=stackStart,stackOut=stackEnd,y=0;height>y;y++)p=yi<<2,pixels[p+3]=pa=a_sum*mul_sum>>shg_sum,pa>0?(pa=255/pa,pixels[p]=(r_sum*mul_sum>>shg_sum)*pa,pixels[p+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[p+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[p]=pixels[p+1]=pixels[p+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=width}}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];module.exports={stackBlurCanvasRGBA:stackBlurCanvasRGBA}},function(module,exports,__webpack_require__){function drainQueue(){if(!draining){draining=!0;for(var currentQueue,len=queue.length;len;){currentQueue=queue,queue=[];for(var i=-1;++i<len;)currentQueue[i]();len=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(fun){queue.push(fun),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_dot=__webpack_require__(98),_dot2=_interopRequireDefault(_dot),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),_helpers=__webpack_require__(97),_helpers2=_interopRequireDefault(_helpers),BaseUI=function(_EventEmitter){function BaseUI(kit,options){_classCallCheck(this,BaseUI),_get(Object.getPrototypeOf(BaseUI.prototype),"constructor",this).call(this),this._kit=kit,this._options=options,this._options.ui=this._options.ui||{},this._operations=[],this._helpers=new _helpers2["default"](this.kit,this,options),this.selectOperations(null)}return _inherits(BaseUI,_EventEmitter),_createClass(BaseUI,[{key:"run",value:function(){this._attach()}},{key:"_attach",value:function(){if(null===this._options.container)throw new Error("BaseUI#attach: No container set.");var html=this._render();this._options.container.innerHTML=html,this._options.container.style.position="relative"}},{key:"_render",value:function(){if("undefined"==typeof this._template)throw new Error("BaseUI#_render: No template set.");var renderFn=_dot2["default"].template(this._template);return renderFn(this.context)}},{key:"selectOperations",value:function(selector){var registeredOperations=this._kit.registeredOperations,operationIdentifiers=Object.keys(registeredOperations),selectedOperations=_libUtils2["default"].select(operationIdentifiers,selector);this._operations=selectedOperations.map(function(identifier){return registeredOperations[identifier]})}},{key:"addOperation",value:function(operation){this._operations.push(operation)}},{key:"isOperationSelected",value:function(identifier){var operationIdentifiers=this._operations.map(function(operation){return operation.prototype.identifier});return-1!==operationIdentifiers.indexOf(identifier)}},{key:"identifier",get:function(){return null}},{key:"context",get:function(){return{operations:this._operations,helpers:this._helpers,options:this._options}}},{key:"container",get:function(){return this._options.container}},{key:"operations",get:function(){return this._operations}},{key:"options",get:function(){return this._options}},{key:"canvas",get:function(){return this._canvas}},{key:"helpers",get:function(){return this._helpers}},{key:"image",get:function(){return this._options.image}}]),BaseUI}(_libEventEmitter2["default"]);exports["default"]=BaseUI,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x3,_x4,_x5){for(var _again=!0;_again;){var object=_x3,property=_x4,receiver=_x5;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x3=parent,_x4=property,_x5=receiver,_again=!0}},_renderersWebglRenderer=__webpack_require__(56),_renderersWebglRenderer2=_interopRequireDefault(_renderersWebglRenderer),_renderersCanvasRenderer=__webpack_require__(55),_renderersCanvasRenderer2=_interopRequireDefault(_renderersCanvasRenderer),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),Canvas=function(_EventEmitter){function Canvas(kit,ui,options){_classCallCheck(this,Canvas),_get(Object.getPrototypeOf(Canvas.prototype),"constructor",this).call(this),this._kit=kit,this._ui=ui,this._options=options;var container=this._ui.container;this._canvasContainer=container.querySelector(".imglykit-canvas-container"),this._canvasInnerContainer=container.querySelector(".imglykit-canvas-inner-container"),this._canvas=this._canvasContainer.querySelector("canvas"),this._image=this._options.image,this._roundZoomBy=.1,this._isFirstRender=!0,this._dragOnMousedown=this._dragOnMousedown.bind(this),this._dragOnMousemove=this._dragOnMousemove.bind(this),this._dragOnMouseup=this._dragOnMouseup.bind(this)}return _inherits(Canvas,_EventEmitter),_createClass(Canvas,[{key:"run",value:function(){this._initRenderer(),this._zoomLevel=this._getInitialZoomLevel(),this._initialZoomLevel=this._zoomLevel,this._isInitialZoom=!0,this._size=null,this.render(),this._centerCanvas(),this._handleDrag();
}},{key:"render",value:function(){var _this=this;this._initialZoomLevel=this._getInitialZoomLevel(),this._isInitialZoom&&this.setZoomLevel(this._initialZoomLevel,!1);var imageSize=new _libMathVector22["default"](this._image.width,this._image.height),initialSize=imageSize.multiply(this._zoomLevel);this._setCanvasSize(initialSize),this._renderer.reset();var stack=this.sanitizedStack;this._updateStackDirtyStates(stack);for(var validationPromises=[],i=0;i<stack.length;i++){var operation=stack[i];validationPromises.push(operation.validateSettings())}return Promise.all(validationPromises).then(function(){return _this._isFirstRender&&"webgl"===_this._renderer.identifier&&(_this._image.width>_this._renderer.maxTextureSize||_this._image.height>_this._renderer.maxTextureSize)?(_this._ui.displayLoadingMessage("Resizing..."),new Promise(function(resolve,reject){setTimeout(function(){_this._renderer.prepareImage(_this._image).then(function(image){_this._ui.hideLoadingMessage(),_this._options.image=image,_this._image=_this._options.image,resolve()})["catch"](function(e){reject(e)})},100)})):void 0}).then(function(){return _this._isFirstRender||"canvas"===_this._renderer.constructor.identifier?(_this._isFirstRender=!1,_this._renderer.drawImage(_this._image)):void 0}).then(function(){for(var promises=[],i=0;i<stack.length;i++){var operation=stack[i];promises.push(operation.render(_this._renderer))}return Promise.all(promises)}).then(function(){return _this._renderer.renderFinal()}).then(function(){_this._storeCanvasSize(),_this._updateContainerSize(),_this._updateCanvasMargins(),_this._applyBoundaries()})}},{key:"setImage",value:function(image){this._image=image,this.reset(),this.render(),this._centerCanvas()}},{key:"zoomIn",value:function(){this._isInitialZoom=!1;var zoomLevel=Math.round(100*this._zoomLevel),roundZoomBy=Math.round(100*this._roundZoomBy),initialZoomLevel=Math.round(100*this._initialZoomLevel);return zoomLevel%roundZoomBy!==0?zoomLevel=Math.ceil(zoomLevel/roundZoomBy)*roundZoomBy:zoomLevel+=roundZoomBy,zoomLevel=Math.min(2*initialZoomLevel,zoomLevel),this.setZoomLevel(zoomLevel/100)}},{key:"zoomOut",value:function(){this._isInitialZoom=!1;var zoomLevel=Math.round(100*this._zoomLevel),roundZoomBy=Math.round(100*this._roundZoomBy),initialZoomLevel=Math.round(100*this._initialZoomLevel);return zoomLevel%roundZoomBy!==0?zoomLevel=Math.floor(zoomLevel/roundZoomBy)*roundZoomBy:zoomLevel-=roundZoomBy,zoomLevel=Math.max(initialZoomLevel,zoomLevel),this.setZoomLevel(zoomLevel/100)}},{key:"_setCanvasSize",value:function(size){size=size||new _libMathVector22["default"](this._canvas.width,this._canvas.height),this._canvas.width=size.x,this._canvas.height=size.y,this._storeCanvasSize(),this._updateContainerSize()}},{key:"_updateContainerSize",value:function(){var size=this._size;this._canvasInnerContainer.style.width=""+size.x+"px",this._canvasInnerContainer.style.height=""+size.y+"px"}},{key:"_storeCanvasSize",value:function(){this._size=new _libMathVector22["default"](this._canvas.width,this._canvas.height)}},{key:"_centerCanvas",value:function(){var position=this._maxSize.divide(2);this._canvasInnerContainer.style.left=""+position.x+"px",this._canvasInnerContainer.style.top=""+position.y+"px",this._updateCanvasMargins()}},{key:"_updateCanvasMargins",value:function(){var canvasSize=new _libMathVector22["default"](this._canvas.width,this._canvas.height),margin=canvasSize.divide(2).multiply(-1);this._canvasInnerContainer.style.marginLeft=""+margin.x+"px",this._canvasInnerContainer.style.marginTop=""+margin.y+"px"}},{key:"setZoomLevel",value:function(zoomLevel){var _this2=this,render=void 0===arguments[1]?!0:arguments[1];return this._zoomLevel=zoomLevel,render?(this.setAllOperationsToDirty(),this.render().then(function(){_this2._updateCanvasMargins(),_this2._applyBoundaries(),_this2.emit("zoom")})):(this._updateCanvasMargins(),this._applyBoundaries(),this.emit("zoom"),void 0)}},{key:"setAllOperationsToDirty",value:function(){for(var operationsStack=this._kit.operationsStack,i=0;i<operationsStack.length;i++){var operation=operationsStack[i];operation&&(operation.dirty=!0)}}},{key:"_getInitialZoomLevel",value:function(){var inputSize=new _libMathVector22["default"](this._image.width,this._image.height),cropOperation=this._ui.operations.crop,rotationOperation=this._ui.operations.rotation,cropSize=void 0,croppedSize=void 0,finalSize=void 0,initialSize=void 0;if(cropSize=cropOperation?cropOperation.getEnd().clone().subtract(cropOperation.getStart()):new _libMathVector22["default"](1,1),croppedSize=inputSize.clone().multiply(cropSize),rotationOperation&&rotationOperation.getDegrees()%180!==0){var tempX=croppedSize.x;croppedSize.x=croppedSize.y,croppedSize.y=tempX}if(finalSize=this._resizeVectorToFit(croppedSize),rotationOperation&&rotationOperation.getDegrees()%180!==0){var tempX=finalSize.x;finalSize.x=finalSize.y,finalSize.y=tempX}return initialSize=finalSize.clone().divide(cropSize),initialSize.x/inputSize.x}},{key:"_resizeVectorToFit",value:function(size){var maxSize=this._maxSize,scale=Math.min(maxSize.x/size.x,maxSize.y/size.y),newSize=size.clone().multiply(scale);return newSize}},{key:"_initRenderer",value:function(){var _this3=this;if(_renderersWebglRenderer2["default"].isSupported()&&"canvas"!==this._options.renderer?(this._renderer=new _renderersWebglRenderer2["default"](null,this._canvas),this._webglEnabled=!0):_renderersCanvasRenderer2["default"].isSupported()&&(this._renderer=new _renderersCanvasRenderer2["default"](null,this._canvas),this._webglEnabled=!1),null===this._renderer)throw new Error("Neither Canvas nor WebGL renderer are supported.");this._renderer.on("new-canvas",function(canvas){_this3._setCanvas(canvas)})}},{key:"_setCanvas",value:function(canvas){var canvasParent=this._canvas.parentNode;canvasParent.removeChild(this._canvas),this._canvas=canvas,canvasParent.appendChild(this._canvas),this._updateCanvasMargins(),this._applyBoundaries(),this._updateContainerSize()}},{key:"_handleDrag",value:function(){this._canvas.addEventListener("mousedown",this._dragOnMousedown),this._canvas.addEventListener("touchstart",this._dragOnMousedown)}},{key:"_dragOnMousedown",value:function(e){if("mousedown"!==e.type||0===e.button){e.preventDefault();var x=e.pageX,y=e.pageY;"touchstart"===e.type&&(x=e.touches[0].pageX,y=e.touches[0].pageY);var canvasX=parseInt(this._canvasInnerContainer.style.left,10),canvasY=parseInt(this._canvasInnerContainer.style.top,10);document.addEventListener("mousemove",this._dragOnMousemove),document.addEventListener("touchmove",this._dragOnMousemove),document.addEventListener("mouseup",this._dragOnMouseup),document.addEventListener("touchend",this._dragOnMouseup),this._initialMousePosition=new _libMathVector22["default"](x,y),this._initialCanvasPosition=new _libMathVector22["default"](canvasX,canvasY)}}},{key:"_dragOnMousemove",value:function(e){e.preventDefault();var x=e.pageX,y=e.pageY;"touchmove"===e.type&&(x=e.touches[0].pageX,y=e.touches[0].pageY);var newMousePosition=new _libMathVector22["default"](x,y),mouseDiff=newMousePosition.clone().subtract(this._initialMousePosition),newPosition=this._initialCanvasPosition.clone().add(mouseDiff);this._canvasInnerContainer.style.left=""+newPosition.x+"px",this._canvasInnerContainer.style.top=""+newPosition.y+"px",this._applyBoundaries()}},{key:"_applyBoundaries",value:function(){var x=parseInt(this._canvasInnerContainer.style.left,10),y=parseInt(this._canvasInnerContainer.style.top,10),canvasPosition=new _libMathVector22["default"](x,y),boundaries=this._boundaries;canvasPosition.x=Math.min(boundaries.max.x,Math.max(boundaries.min.x,canvasPosition.x)),canvasPosition.y=Math.min(boundaries.max.y,Math.max(boundaries.min.y,canvasPosition.y)),this._canvasInnerContainer.style.left=""+canvasPosition.x+"px",this._canvasInnerContainer.style.top=""+canvasPosition.y+"px"}},{key:"_dragOnMouseup",value:function(e){e.preventDefault(),document.removeEventListener("mousemove",this._dragOnMousemove),document.removeEventListener("touchmove",this._dragOnMousemove),document.removeEventListener("mouseup",this._dragOnMouseup),document.removeEventListener("touchend",this._dragOnMouseup)}},{key:"_updateStackDirtyStates",value:function(stack){for(var dirtyFound=!1,i=0;i<stack.length;i++){var operation=stack[i];operation&&(operation.dirty&&(dirtyFound=!0),dirtyFound&&(operation.dirty=!0))}}},{key:"zoomToFit",value:function(){var render=void 0===arguments[0]?!0:arguments[0],initialZoomLevel=this._getInitialZoomLevel();return this.setZoomLevel(initialZoomLevel,render)}},{key:"reset",value:function(){this._renderer.reset(!0),this._kit.operationsStack=[],this._isFirstRender=!0}},{key:"_boundaries",get:function(){var canvasSize=new _libMathVector22["default"](this._canvas.width,this._canvas.height),maxSize=this._maxSize,diff=canvasSize.clone().subtract(maxSize).multiply(-1),boundaries={min:new _libMathVector22["default"](diff.x,diff.y),max:new _libMathVector22["default"](0,0)};canvasSize.x<maxSize.x&&(boundaries.min.x=diff.x/2,boundaries.max.x=diff.x/2),canvasSize.y<maxSize.y&&(boundaries.min.y=diff.y/2,boundaries.max.y=diff.y/2);var halfCanvasSize=canvasSize.clone().divide(2);return boundaries.min.add(halfCanvasSize),boundaries.max.add(halfCanvasSize),boundaries}},{key:"_maxSize",get:function(){var computedStyle=window.getComputedStyle(this._canvasContainer),size=new _libMathVector22["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight),paddingX=parseInt(computedStyle.getPropertyValue("padding-left"),10);paddingX+=parseInt(computedStyle.getPropertyValue("padding-right"),10);var paddingY=parseInt(computedStyle.getPropertyValue("padding-top"),10);paddingY+=parseInt(computedStyle.getPropertyValue("padding-bottom"),10),size.x-=paddingX,size.y-=paddingY;var controlsHeight=this._ui._controlsContainer.offsetHeight;return size.y-=controlsHeight,size}},{key:"sanitizedStack",get:function(){for(var sanitizedStack=[],i=0;i<this._kit.operationsStack.length;i++){var operation=this._kit.operationsStack[i];operation&&sanitizedStack.push(operation)}return sanitizedStack}},{key:"zoomLevel",get:function(){return this._zoomLevel}},{key:"size",get:function(){return this._size}}]),Canvas}(_libEventEmitter2["default"]);exports["default"]=Canvas,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),FileLoader=function(_EventEmitter){function FileLoader(kit,ui){_classCallCheck(this,FileLoader),_get(Object.getPrototypeOf(FileLoader.prototype),"constructor",this).call(this),this._kit=kit,this._ui=ui,this._dragCounter=0,this._container=this._ui.container.querySelector(".imglykit-drop-area-container"),this._onDropAreaDragEnter=this._onDropAreaDragEnter.bind(this),this._onDropAreaDragOver=this._onDropAreaDragOver.bind(this),this._onDropAreaDragLeave=this._onDropAreaDragLeave.bind(this),this._onDropAreaDrop=this._onDropAreaDrop.bind(this),this._onDropAreaClick=this._onDropAreaClick.bind(this),this._onFileInputChange=this._onFileInputChange.bind(this),this._hiddenInputField=this._ui.container.querySelector(".imglykit-drop-area .imglykit-drop-area-hidden-input"),this._hiddenInputField.addEventListener("change",this._onFileInputChange),this._handleDropArea(),this._ui.options.image&&this.removeDOM()}return _inherits(FileLoader,_EventEmitter),_createClass(FileLoader,[{key:"openFileDialog",value:function(){this._hiddenInputField.click()}},{key:"_handleDropArea",value:function(){var container=this._ui.container;this._dropArea=container.querySelector(".imglykit-drop-area"),this._dropArea.addEventListener("dragenter",this._onDropAreaDragEnter),this._dropArea.addEventListener("dragover",this._onDropAreaDragOver),this._dropArea.addEventListener("dragleave",this._onDropAreaDragLeave),this._dropArea.addEventListener("drop",this._onDropAreaDrop),this._dropArea.addEventListener("dragdrop",this._onDropAreaDrop),this._dropArea.addEventListener("click",this._onDropAreaClick)}},{key:"_onDropAreaClick",value:function(){this.openFileDialog()}},{key:"_onDropAreaDragEnter",value:function(e){e.preventDefault(),this._dragCounter++,this._dropArea.classList.add("imglykit-drop-area-active")}},{key:"_onDropAreaDragOver",value:function(e){e.preventDefault()}},{key:"_onDropAreaDragLeave",value:function(e){e.preventDefault(),this._dragCounter--,0===this._dragCounter&&this._dropArea.classList.remove("imglykit-drop-area-active")}},{key:"_onDropAreaDrop",value:function(e){e.stopPropagation(),e.preventDefault(),e.returnValue=!1,this._dropArea.classList.remove("imglykit-drop-area-active"),e.dataTransfer&&this._handleFile(e.dataTransfer.files[0])}},{key:"_onFileInputChange",value:function(){this._handleFile(this._hiddenInputField.files[0])}},{key:"_handleFile",value:function(file){this.emit("file",file)}},{key:"removeDOM",value:function(){this._dropArea.removeEventListener("dragenter",this._onDropAreaDragEnter),this._dropArea.removeEventListener("dragover",this._onDropAreaDragOver),this._dropArea.removeEventListener("dragleave",this._onDropAreaDragLeave),this._dropArea.removeEventListener("drop",this._onDropAreaDrop),this._dropArea.removeEventListener("dragdrop",this._onDropAreaDrop),this._dropArea.removeEventListener("click",this._onDropAreaClick),this._container&&(this._container.style.display="none")}}]),FileLoader}(_libEventEmitter2["default"]);exports["default"]=FileLoader,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),TopControls=function(_EventEmitter){function TopControls(kit,ui){_classCallCheck(this,TopControls),_get(Object.getPrototypeOf(TopControls.prototype),"constructor",this).call(this),this._kit=kit,this._ui=ui,this.init()}return _inherits(TopControls,_EventEmitter),_createClass(TopControls,[{key:"init",value:function(){this._canvas=this._ui.canvas}},{key:"run",value:function(){var container=this._ui.container;this._rightControls=container.querySelector(".imglykit-top-controls-right"),this._leftControls=container.querySelector(".imglykit-top-controls-left"),this._undoButton=container.querySelector(".imglykit-undo"),this._zoomIn=container.querySelector(".imglykit-zoom-in"),this._zoomOut=container.querySelector(".imglykit-zoom-out"),this._zoomLevel=container.querySelector(".imglykit-zoom-level-num"),this._newButton=container.querySelector(".imglykit-new"),this._exportButton=container.querySelector(".imglykit-export"),this._handleZoom(),this._handleUndo(),this._handleNew(),this._handleExport()}},{key:"_handleZoom",value:function(){this._zoomIn.addEventListener("click",this._onZoomInClick.bind(this)),this._zoomOut.addEventListener("click",this._onZoomOutClick.bind(this))}},{key:"_handleUndo",value:function(){this._undoButton.addEventListener("click",this._undo.bind(this)),this._undo()}},{key:"_handleNew",value:function(){this._newButton&&this._newButton.addEventListener("click",this._onNewClick.bind(this))}},{key:"_handleExport",value:function(){this._exportButton&&this._exportButton.addEventListener("click",this._onExportClick.bind(this))}},{key:"_onNewClick",value:function(e){e.preventDefault();var fileLoader=this._ui.fileLoader;fileLoader.openFileDialog()}},{key:"_onExportClick",value:function(e){e.preventDefault(),this.emit("export")}},{key:"_undo",value:function(){this.emit("undo")}},{key:"updateUndoButton",value:function(){var history=this._ui.history;0===history.length?this._undoButton.style.display="none":this._undoButton.style.display="inline-block"}},{key:"updateExportButton",value:function(){if(this._exportButton){var image=this._ui.image;image?this._exportButton.style.display="inline-block":this._exportButton.style.display="none"}}},{key:"_onZoomInClick",value:function(e){e.preventDefault(),this.emit("zoom-in"),this.updateZoomLevel()}},{key:"_onZoomOutClick",value:function(e){e.preventDefault(),this.emit("zoom-out"),this.updateZoomLevel()}},{key:"showZoom",value:function(){this._rightControls.style.display="inline-block"}},{key:"hideZoom",value:function(){this._rightControls.style.display="none"}},{key:"updateZoomLevel",value:function(){var zoomLevel=this._canvas.zoomLevel;this._zoomLevel.innerHTML=Math.round(100*zoomLevel)}}]),TopControls}(_libEventEmitter2["default"]);exports["default"]=TopControls,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),maxScrollbarWidth=18,Scrollbar=function(){function Scrollbar(container){_classCallCheck(this,Scrollbar),this._container=container,this._isDragging=!1,this._isHovering=!1,this._appendDOM(),this._resizeButton(),this._updateValues(),this._onButtonDown=this._onButtonDown.bind(this),this._onButtonMove=this._onButtonMove.bind(this),this._onButtonUp=this._onButtonUp.bind(this),this._onContainerEnter=this._onContainerEnter.bind(this),this._onContainerLeave=this._onContainerLeave.bind(this),this._onBackgroundClick=this._onBackgroundClick.bind(this),this._container.addEventListener("mouseenter",this._onContainerEnter),this._container.addEventListener("mouseleave",this._onContainerLeave),this._container.addEventListener("mousemove",this._onContainerEnter),this._dom.button.addEventListener("mousedown",this._onButtonDown),this._dom.button.addEventListener("touchstart",this._onButtonDown),this._dom.background.addEventListener("click",this._onBackgroundClick),this._list.addEventListener("scroll",this._onListScroll.bind(this)),this._onListScroll()}return _createClass(Scrollbar,[{key:"_onBackgroundClick",value:function(e){if(e.preventDefault(),e.target===this._dom.background){var position=_libUtils2["default"].getEventPosition(e),backgroundOffset=this._dom.background.getBoundingClientRect();backgroundOffset=new _libMathVector22["default"](backgroundOffset.left,backgroundOffset.top);var relativePosition=position.clone().subtract(backgroundOffset);relativePosition.x-=.5*this._values.button.width,this._setButtonPosition(relativePosition.x)}}},{key:"_onContainerEnter",value:function(){this._isHovering=!0,this.show()}},{key:"_onContainerLeave",value:function(){this._isHovering=!1,this.hide()}},{key:"show",value:function(){this._isScrollingNecessary&&this._dom.background.classList.add("visible")}},{key:"hide",value:function(){this._isDragging||this._dom.background.classList.remove("visible")}},{key:"_updateValues",value:function(){this._values={list:{totalWidth:this._list.scrollWidth,visibleWidth:this._list.offsetWidth,scrollableWidth:this._list.scrollWidth-this._list.offsetWidth},button:{width:this._dom.button.offsetWidth,scrollableWidth:this._dom.background.offsetWidth-this._dom.button.offsetWidth}}}},{key:"_onButtonDown",value:function(event){event.preventDefault(),this._isDragging=!0,this._initialMousePosition=_libUtils2["default"].getEventPosition(event),this._initialButtonPosition=this._buttonPosition||0,document.addEventListener("mousemove",this._onButtonMove),document.addEventListener("touchmove",this._onButtonMove),document.addEventListener("mouseup",this._onButtonUp),document.addEventListener("touchend",this._onButtonUp)}},{key:"_onButtonMove",value:function(event){event.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(event),diff=mousePosition.clone().subtract(this._initialMousePosition),newButtonPosition=this._initialButtonPosition+diff.x;this._setButtonPosition(newButtonPosition)}},{key:"_setButtonPosition",value:function(newButtonPosition){newButtonPosition=Math.max(0,newButtonPosition),newButtonPosition=Math.min(newButtonPosition,this._values.button.scrollableWidth),this._buttonPosition=newButtonPosition,this._dom.button.style.left=""+this._buttonPosition+"px";var progress=newButtonPosition/this._values.button.scrollableWidth,scrollPosition=this._values.list.scrollableWidth*progress;this._list.scrollLeft=scrollPosition}},{key:"_onButtonUp",value:function(){this._isDragging=!1,document.removeEventListener("mousemove",this._onButtonMove),document.removeEventListener("touchmove",this._onButtonMove),document.removeEventListener("mouseup",this._onButtonUp),document.removeEventListener("touchend",this._onButtonUp)}},{key:"_onListScroll",value:function(){if(!this._isDragging){var listScrollWidth=this._list.scrollWidth-this._list.offsetWidth,listScrollPosition=this._list.scrollLeft,backgroundScrollWidth=this._dom.background.offsetWidth-this._dom.button.offsetWidth,progress=listScrollPosition/listScrollWidth;this._buttonPosition=backgroundScrollWidth*progress,this._dom.button.style.left=""+this._buttonPosition+"px"}}},{key:"_resizeButton",value:function(){var listScrollWidth=this._list.scrollWidth,listWidth=this._list.offsetWidth;this._buttonWidth=listWidth/listScrollWidth*listWidth,this._dom.button.style.width=""+this._buttonWidth+"px"}},{key:"_appendDOM",value:function(){var background=document.createElement("div");background.classList.add("imglykit-scrollbar-background"),background.style.bottom=""+maxScrollbarWidth+"px";var button=document.createElement("div");button.classList.add("imglykit-scrollbar-button"),background.appendChild(button),this._container.appendChild(background),this._container.style.position="relative",this._list=this._container.querySelector(".imglykit-controls-list"),this._dom={background:background,button:button},this._list.style.height="";var listHeight=this._list.offsetHeight;listHeight+=maxScrollbarWidth,this._container.style.height=""+listHeight+"px",this._list.style.height=""+listHeight+"px"}},{key:"remove",value:function(){this._dom.button.removeEventListener("mousedown",this._onButtonDown),this._dom.button.removeEventListener("touchstart",this._onButtonDown),this._dom.background.remove()}},{key:"_isScrollingNecessary",get:function(){return this._list.scrollWidth>this._list.offsetWidth}}]),Scrollbar}();exports["default"]=Scrollbar,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),FiltersControl=function(_Control){function FiltersControl(){_classCallCheck(this,FiltersControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(FiltersControl,_Control),_createClass(FiltersControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      {{ for(var identifier in it.filters) { }}\n        {{ var filter = it.filters[identifier]; }}\n        {{ var name = filter.prototype.name; }}\n        {{ var enabled = it.activeFilter.identifier === identifier; }}\n        <li data-identifier="{{= identifier}}" class="imglykit-controls-item-with-label{{? enabled}} imglykit-controls-item-active{{?}}">\n          <img src="{{=it.helpers.assetPath(\'ui/night/filters/\' + identifier + \'.png\')}}" />\n          <div class="imglykit-controls-item-label">{{= name }}</div>\n        </li>\n      {{ } }}\n    </ul>\n  </div>\n#}}\n';this._controlsTemplate=controlsTemplate,this._availableFilters={},this._filters={},this._addDefaultFilters(),this.selectFilters(null)}},{key:"_renderAllControls",value:function(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];this._operationExistedBefore=!!this._ui.operations.filters,this._operation=this._ui.getOrCreateOperation("filters"),_get(Object.getPrototypeOf(FiltersControl.prototype),"_renderAllControls",this).apply(this,args)}},{key:"_onEnter",value:function(){var _this=this;this._initialFilter=this._operation.getFilter(),this._defaultFilter=this._operation.availableOptions.filter["default"];var listItems=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=_this._listItems[i];listItem.addEventListener("click",function(){_this._onListItemClick(listItem)})},i=0;i<this._listItems.length;i++)_loop(i)}},{key:"_onBack",value:function(){var currentFilter=this._operation.getFilter();currentFilter!==this._initialFilter&&this._ui.addHistory(this._operation,{filter:this._initialFilter},this._operationExistedBefore),currentFilter===this._defaultFilter&&this._ui.removeOperation("filters"),this._ui.canvas.render()}},{key:"_onListItemClick",value:function(item){this._deactivateAllItems();var identifier=item.dataset.identifier;this._operation.setFilter(this._filters[identifier]),this._ui.canvas.render(),item.classList.add("imglykit-controls-item-active")}},{key:"_deactivateAllItems",value:function(){for(var i=0;i<this._listItems.length;i++){var listItem=this._listItems[i];listItem.classList.remove("imglykit-controls-item-active")}}},{key:"_addDefaultFilters",value:function(){this.addFilter(__webpack_require__(71)),this.addFilter(__webpack_require__(34)),this.addFilter(__webpack_require__(35)),this.addFilter(__webpack_require__(36)),this.addFilter(__webpack_require__(37)),this.addFilter(__webpack_require__(30)),this.addFilter(__webpack_require__(23)),this.addFilter(__webpack_require__(42)),this.addFilter(__webpack_require__(27)),this.addFilter(__webpack_require__(31)),this.addFilter(__webpack_require__(28)),this.addFilter(__webpack_require__(49)),this.addFilter(__webpack_require__(24)),this.addFilter(__webpack_require__(25)),this.addFilter(__webpack_require__(38)),this.addFilter(__webpack_require__(45)),this.addFilter(__webpack_require__(44)),this.addFilter(__webpack_require__(43)),this.addFilter(__webpack_require__(29)),this.addFilter(__webpack_require__(32)),this.addFilter(__webpack_require__(26)),this.addFilter(__webpack_require__(48)),this.addFilter(__webpack_require__(41)),this.addFilter(__webpack_require__(39)),this.addFilter(__webpack_require__(33)),this.addFilter(__webpack_require__(40)),this.addFilter(__webpack_require__(47)),this.addFilter(__webpack_require__(22)),this.addFilter(__webpack_require__(46))}},{key:"addFilter",value:function(filter){this._availableFilters[filter.identifier]=filter}},{key:"selectFilters",value:function(selector){this._filters={};for(var filterIdentifiers=Object.keys(this._availableFilters),selectedFilters=_libUtils2["default"].select(filterIdentifiers,selector),i=0;i<selectedFilters.length;i++){var identifier=selectedFilters[i];
this._filters[identifier]=this._availableFilters[identifier]}this._active&&this._renderControls()}},{key:"context",get:function(){var context=_get(Object.getPrototypeOf(FiltersControl.prototype),"context",this);return context.filters=this._filters,context.activeFilter=this._operation.getFilter(),context}}]),FiltersControl}(_control2["default"]);FiltersControl.prototype.identifier="filters",exports["default"]=FiltersControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),RotationControl=function(_Control){function RotationControl(){_classCallCheck(this,RotationControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(RotationControl,_Control),_createClass(RotationControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      <li data-degrees="-90">\n        <img src="{{=it.helpers.assetPath(\'ui/night/rotation/left.png\')}}" />\n      </li>\n      <li data-degrees="90">\n        <img src="{{=it.helpers.assetPath(\'ui/night/rotation/right.png\')}}" />\n      </li>\n    </ul>\n  </div>\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-crop-container imglykit-canvas-crop-container-hidden">\n  <div class="imglykit-canvas-crop-top">\n    <div class="imglykit-canvas-crop-top-left"></div>\n    <div class="imglykit-canvas-crop-top-center"></div>\n    <div class="imglykit-canvas-crop-top-right"></div>\n  </div>\n\n  <div class="imglykit-canvas-crop-center">\n    <div class="imglykit-canvas-crop-center-left"></div>\n    <div class="imglykit-canvas-crop-center-center imglykit-canvas-crop-center-center-nomove">\n\n    </div>\n    <div class="imglykit-canvas-crop-center-right"></div>\n  </div>\n\n  <div class="imglykit-canvas-crop-bottom">\n    <div class="imglykit-canvas-crop-bottom-left"></div>\n    <div class="imglykit-canvas-crop-bottom-center"></div>\n    <div class="imglykit-canvas-crop-bottom-right"></div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations.rotation,this._operation=this._ui.getOrCreateOperation("rotation"),this._cropOperation=this._ui.operations.crop,this._initialZoomLevel=this._ui.canvas.zoomLevel,this._ui.canvas.zoomToFit(!1),this._cropOperation&&(this._initialStart=this._cropOperation.getStart().clone(),this._initialEnd=this._cropOperation.getEnd().clone(),this._cropOperation.set({start:new _libMathVector22["default"](0,0),end:new _libMathVector22["default"](1,1)})),this._initialDegrees=this._operation.getDegrees();var listItems=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=_this._listItems[i];listItem.addEventListener("click",function(){_this._onListItemClick(listItem)})},i=0;i<this._listItems.length;i++)_loop(i);var prefix=".imglykit-canvas-crop";this._cropAreas={topLeft:this._canvasControls.querySelector(""+prefix+"-top-left"),topCenter:this._canvasControls.querySelector(""+prefix+"-top-center"),centerLeft:this._canvasControls.querySelector(""+prefix+"-center-left"),centerCenter:this._canvasControls.querySelector(""+prefix+"-center-center")},this._ui.canvas.render().then(function(){_this._showCropContainer(),_this._updateCropDOM()})}},{key:"_showCropContainer",value:function(){var container=this._canvasControls.querySelector(".imglykit-canvas-crop-container");container.classList.remove("imglykit-canvas-crop-container-hidden")}},{key:"_onListItemClick",value:function(item){var _this2=this,degrees=item.dataset.degrees;degrees=parseInt(degrees,10);var currentDegrees=this._operation.getDegrees();this._operation.setDegrees(currentDegrees+degrees),this._ui.canvas.zoomToFit().then(function(){_this2._updateCropDOM()})}},{key:"onZoom",value:function(){this._updateCropDOM()}},{key:"_updateCropDOM",value:function(){var start=void 0,end=void 0;this._cropOperation?(start=this._initialStart.clone(),end=this._initialEnd.clone()):(start=new _libMathVector22["default"](0,0),end=new _libMathVector22["default"](1,1));var canvasSize=this._ui.canvas.size,startAbsolute=start.multiply(canvasSize),endAbsolute=end.multiply(canvasSize),size=endAbsolute.clone().subtract(startAbsolute),top=Math.max(1,startAbsolute.y),left=Math.max(1,startAbsolute.x),width=Math.max(1,size.x),height=Math.max(1,size.y);this._cropAreas.topLeft.style.width=""+left+"px",this._cropAreas.topCenter.style.width=""+width+"px",this._cropAreas.topLeft.style.height=""+top+"px",this._cropAreas.centerLeft.style.height=""+height+"px"}},{key:"_onBack",value:function(){var currentDegrees=this._operation.getDegrees();this._initialDegrees!==currentDegrees&&this._ui.addHistory(this._operation,{degrees:this._initialDegrees},this._operationExistedBefore),0===currentDegrees&&this._ui.removeOperation("rotation"),this._cropOperation&&this._cropOperation.set({start:this._initialStart,end:this._initialEnd}),this._ui.canvas.render()}}]),RotationControl}(_control2["default"]);RotationControl.prototype.identifier="rotation",exports["default"]=RotationControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),FlipControl=function(_Control){function FlipControl(){_classCallCheck(this,FlipControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(FlipControl,_Control),_createClass(FlipControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      <li data-direction="horizontal">\n        <img src="{{=it.helpers.assetPath(\'ui/night/flip/horizontal.png\')}}" />\n      </li>\n      <li data-direction="vertical">\n        <img src="{{=it.helpers.assetPath(\'ui/night/flip/vertical.png\')}}" />\n      </li>\n    </ul>\n  </div>\n#}}\n';this._controlsTemplate=controlsTemplate}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations.flip,this._operation=this._ui.getOrCreateOperation("flip"),this._initialHorizontal=this._operation.getHorizontal(),this._initialVertical=this._operation.getVertical();var listItems=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=_this._listItems[i];listItem.addEventListener("click",function(){_this._onListItemClick(listItem)});var direction=listItem.dataset.direction;"horizontal"===direction&&_this._operation.getHorizontal()?_this._toggleItem(listItem,!0):"vertical"===direction&&_this._operation.getVertical()&&_this._toggleItem(listItem,!0)},i=0;i<this._listItems.length;i++)_loop(i)}},{key:"_onListItemClick",value:function(item){var direction=item.dataset.direction,active=!1;if("horizontal"===direction){var currentHorizontal=this._operation.getHorizontal();this._operation.setHorizontal(!currentHorizontal),this._ui.canvas.render(),active=!currentHorizontal}else if("vertical"===direction){var currentVertical=this._operation.getVertical();this._operation.setVertical(!currentVertical),this._ui.canvas.render(),active=!currentVertical}this._toggleItem(item,active)}},{key:"_toggleItem",value:function(item,active){var activeClass="imglykit-controls-item-active";active?item.classList.add(activeClass):item.classList.remove(activeClass)}},{key:"_onBack",value:function(){var currentVertical=this._operation.getVertical(),currentHorizontal=this._operation.getHorizontal();(this._initialVertical!==currentVertical||this._initialHorizontal!==currentHorizontal)&&this._ui.addHistory(this._operation,{vertical:this._initialVertical,horizontal:this._initialHorizontal},this._operationExistedBefore),currentVertical||currentHorizontal||this._ui.removeOperation("flip"),this._ui.canvas.render()}}]),FlipControl}(_control2["default"]);FlipControl.prototype.identifier="flip",exports["default"]=FlipControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libSlider=__webpack_require__(99),_libSlider2=_interopRequireDefault(_libSlider),BrightnessControl=function(_Control){function BrightnessControl(){_classCallCheck(this,BrightnessControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(BrightnessControl,_Control),_createClass(BrightnessControl,[{key:"init",value:function(){var controlsTemplate="{{##def.control:\n  <div>\n    {{#def.slider}}\n  </div>\n#}}\n";this._controlsTemplate=controlsTemplate,this._partialTemplates.push(_libSlider2["default"].template)}},{key:"_onEnter",value:function(){this._operationExistedBefore=!!this._ui.operations.brightness,this._operation=this._ui.getOrCreateOperation("brightness");var brightness=this._operation.getBrightness();this._initialBrightness=brightness;var sliderElement=this._controls.querySelector(".imglykit-slider");this._slider=new _libSlider2["default"](sliderElement,{minValue:-1,maxValue:1,defaultValue:brightness}),this._slider.on("update",this._onUpdate.bind(this)),this._slider.setValue(this._initialBrightness)}},{key:"_onBack",value:function(){var currentBrightness=this._operation.getBrightness();this._initialBrightness!==currentBrightness&&this._ui.addHistory(this._operation,{brightness:this._initialBrightness},this._operationExistedBefore),1===currentBrightness&&this._ui.removeOperation("brightness"),this._ui.canvas.render()}},{key:"_onUpdate",value:function(value){this._operation.setBrightness(value),this._ui.canvas.render()}}]),BrightnessControl}(_control2["default"]);BrightnessControl.prototype.identifier="brightness",exports["default"]=BrightnessControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libSlider=__webpack_require__(99),_libSlider2=_interopRequireDefault(_libSlider),ContrastControl=function(_Control){function ContrastControl(){_classCallCheck(this,ContrastControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(ContrastControl,_Control),_createClass(ContrastControl,[{key:"init",value:function(){var controlsTemplate="{{##def.control:\n  <div>\n    {{#def.slider}}\n  </div>\n#}}\n";this._controlsTemplate=controlsTemplate,this._partialTemplates.push(_libSlider2["default"].template)}},{key:"_onEnter",value:function(){this._operationExistedBefore=!!this._ui.operations.contrast,this._operation=this._ui.getOrCreateOperation("contrast");var contrast=this._operation.getContrast();this._initialContrast=contrast;var sliderElement=this._controls.querySelector(".imglykit-slider");this._slider=new _libSlider2["default"](sliderElement,{minValue:0,maxValue:2,defaultValue:contrast}),this._slider.on("update",this._onUpdate.bind(this)),this._slider.setValue(this._initialContrast)}},{key:"_onBack",value:function(){var currentContrast=this._operation.getContrast();this._initialContrast!==currentContrast&&this._ui.addHistory(this._operation,{contrast:this._initialContrast},this._operationExistedBefore),1===currentContrast&&this._ui.removeOperation("contrast"),this._ui.canvas.render()}},{key:"_onUpdate",value:function(value){this._operation.setContrast(value),this._ui.canvas.render()}}]),ContrastControl}(_control2["default"]);ContrastControl.prototype.identifier="contrast",exports["default"]=ContrastControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_libSlider=__webpack_require__(99),_libSlider2=_interopRequireDefault(_libSlider),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),SaturationControl=function(_Control){function SaturationControl(){_classCallCheck(this,SaturationControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(SaturationControl,_Control),_createClass(SaturationControl,[{key:"init",value:function(){var controlsTemplate="{{##def.control:\n  <div>\n    {{#def.slider}}\n  </div>\n#}}\n";this._controlsTemplate=controlsTemplate,this._partialTemplates.push(_libSlider2["default"].template)}},{key:"_onEnter",value:function(){_get(Object.getPrototypeOf(SaturationControl.prototype),"_onEnter",this).call(this),this._operationExistedBefore=!!this._ui.operations.saturation,this._operation=this._ui.getOrCreateOperation("saturation");var saturation=this._operation.getSaturation();this._initialSaturation=saturation;var sliderElement=this._controls.querySelector(".imglykit-slider");this._slider=new _libSlider2["default"](sliderElement,{minValue:0,maxValue:2,defaultValue:saturation}),this._slider.on("update",this._onUpdate.bind(this)),this._slider.setValue(this._initialSaturation)}},{key:"_onBack",value:function(){var currentSaturation=this._operation.getSaturation();this._initialSaturation!==currentSaturation&&this._ui.addHistory(this._operation,{saturation:this._initialSaturation},this._operationExistedBefore),1===currentSaturation&&this._ui.removeOperation("saturation"),this._ui.canvas.render()}},{key:"_onUpdate",value:function(value){this._operation.setSaturation(value),this._ui.canvas.render()}}]),SaturationControl}(_control2["default"]);SaturationControl.prototype.identifier="saturation",exports["default"]=SaturationControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),CropControl=function(_Control){function CropControl(){_classCallCheck(this,CropControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(CropControl,_Control),_createClass(CropControl,[{key:"init",value:function(){this._availableRatios={},this._ratios={};var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      {{ for(var identifier in it.ratios) { }}\n        {{ var ratio = it.ratios[identifier]; }}\n        {{ var enabled = ratio.selected; }}\n        <li data-identifier="{{= identifier}}" data-ratio="{{= ratio.ratio}}"{{? enabled}} data-selected{{?}}>\n          <img src="{{=it.helpers.assetPath(\'ui/night/crop/\' + identifier + \'.png\')}}" />\n        </li>\n      {{ } }}\n    </ul>\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-crop-container">\n  <div class="imglykit-canvas-crop-top">\n    <div class="imglykit-canvas-crop-top-left"></div>\n    <div class="imglykit-canvas-crop-top-center"></div>\n    <div class="imglykit-canvas-crop-top-right"></div>\n  </div>\n\n  <div class="imglykit-canvas-crop-center">\n    <div class="imglykit-canvas-crop-center-left"></div>\n    <div class="imglykit-canvas-crop-center-center">\n      <div class="imglykit-canvas-crop-knobs">\n        <div data-corner="top-left"></div>\n        <div data-corner="top-right"></div>\n        <div data-corner="bottom-left"></div>\n        <div data-corner="bottom-right"></div>\n      </div>\n    </div>\n    <div class="imglykit-canvas-crop-center-right"></div>\n  </div>\n\n  <div class="imglykit-canvas-crop-bottom">\n    <div class="imglykit-canvas-crop-bottom-left"></div>\n    <div class="imglykit-canvas-crop-bottom-center"></div>\n    <div class="imglykit-canvas-crop-bottom-right"></div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate,this._onKnobDown=this._onKnobDown.bind(this),this._onKnobDrag=this._onKnobDrag.bind(this),this._onKnobUp=this._onKnobUp.bind(this),this._onCenterDown=this._onCenterDown.bind(this),this._onCenterDrag=this._onCenterDrag.bind(this),this._onCenterUp=this._onCenterUp.bind(this),this._addDefaultRatios(),this.selectRatios(null)}},{key:"selectRatios",value:function(selector){this._ratios={};for(var ratioIdentifiers=Object.keys(this._availableRatios),selectedRatios=_libUtils2["default"].select(ratioIdentifiers,selector),i=0;i<selectedRatios.length;i++){var identifier=selectedRatios[i];this._ratios[identifier]=this._availableRatios[identifier]}this._active&&this._renderControls()}},{key:"_addDefaultRatios",value:function(){this.addRatio("custom","*",!0),this.addRatio("square","1"),this.addRatio("4-3","1.33"),this.addRatio("16-9","1.77")}},{key:"addRatio",value:function(identifier,ratio,selected){this._availableRatios[identifier]={ratio:ratio,selected:selected}}},{key:"_onEnter",value:function(){var _this=this;_get(Object.getPrototypeOf(CropControl.prototype),"_onEnter",this).call(this),this._operationExistedBefore=!!this._ui.operations.crop,this._operation=this._ui.getOrCreateOperation("crop"),this._defaultStart=new _libMathVector22["default"](.1,.1),this._defaultEnd=new _libMathVector22["default"](.9,.9),this._initialOptions={start:this._operation.getStart(),end:this._operation.getEnd()},this._start=this._initialOptions.start||this._defaultStart,this._end=this._initialOptions.end||this._defaultEnd,this._minimumSize=new _libMathVector22["default"](50,50),this._initialZoomLevel=this._ui.canvas.zoomLevel,this._ui.canvas.zoomToFit(!1);var prefix=".imglykit-canvas-crop",container=this._canvasControls,knobsContainer=container.querySelector(""+prefix+"-knobs");this._initialStart=this._operation.getStart().clone(),this._initialEnd=this._operation.getEnd().clone(),this._operation.set({start:new _libMathVector22["default"](0,0),end:new _libMathVector22["default"](1,1)}),this._knobs={topLeft:knobsContainer.querySelector("[data-corner=top-left]"),topRight:knobsContainer.querySelector("[data-corner=top-right]"),bottomLeft:knobsContainer.querySelector("[data-corner=bottom-left]"),bottomRight:knobsContainer.querySelector("[data-corner=bottom-right]")},this._areas={topLeft:this._canvasControls.querySelector(""+prefix+"-top-left"),topCenter:this._canvasControls.querySelector(""+prefix+"-top-center"),centerLeft:this._canvasControls.querySelector(""+prefix+"-center-left"),centerCenter:this._canvasControls.querySelector(""+prefix+"-center-center")},this._handleControls(),this._handleKnobs(),this._handleCenter(),this._ui.canvas.render().then(function(){_this._updateDOM()})}},{key:"_handleControls",value:function(){var _this2=this,listItems=this._controls.querySelectorAll("ul > li");this._ratioItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var item=_this2._ratioItems[i],_item$dataset=item.dataset,selected=_item$dataset.selected,ratio=_item$dataset.ratio,identifier=_item$dataset.identifier;"undefined"==typeof selected||_this2._operationExistedBefore||(_this2._setRatio(identifier,ratio,!1),_this2._selectRatio(item)),item.addEventListener("click",function(e){e.preventDefault(),_this2._onRatioClick(item)})},i=0;i<this._ratioItems.length;i++)_loop(i)}},{key:"_onRatioClick",value:function(item){this._unselectAllRatios(),this._selectRatio(item)}},{key:"_unselectAllRatios",value:function(){for(var i=0;i<this._ratioItems.length;i++){var item=this._ratioItems[i];item.classList.remove("imglykit-controls-item-active")}}},{key:"_selectRatio",value:function(item){item.classList.add("imglykit-controls-item-active");var _item$dataset2=item.dataset,ratio=_item$dataset2.ratio,identifier=_item$dataset2.identifier;this._setRatio(identifier,ratio)}},{key:"_setRatio",value:function(identifier,ratio){var resize=void 0===arguments[2]?!0:arguments[2],canvasSize=this._ui.canvas.size;if(this._selectedRatio=identifier,"*"===ratio)this._ratio=null,this._start=new _libMathVector22["default"](.1,.1),this._end=new _libMathVector22["default"](.9,.9);else if("original"===ratio?this._ratio=canvasSize.x/canvasSize.y:(ratio=parseFloat(ratio),this._ratio=ratio),resize)if(canvasSize.x/canvasSize.y<=this._ratio){this._start.x=.1,this._end.x=.9;var height=1/canvasSize.y*(canvasSize.x/this._ratio)*.8;this._start.y=(1-height)/2,this._end.y=1-this._start.y}else{this._start.y=.1,this._end.y=.9;var width=1/canvasSize.x*this._ratio*canvasSize.y*.8;this._start.x=(1-width)/2,this._end.x=1-this._start.x}this._updateDOM()}},{key:"_updateDOM",value:function(){var canvasSize=this._ui.canvas.size,startAbsolute=this._start.clone().multiply(canvasSize),endAbsolute=this._end.clone().multiply(canvasSize),size=endAbsolute.clone().subtract(startAbsolute),top=Math.max(1,startAbsolute.y),left=Math.max(1,startAbsolute.x),width=Math.max(1,size.x),height=Math.max(1,size.y);this._areas.topLeft.style.width=""+left+"px",this._areas.topCenter.style.width=""+width+"px",this._areas.topLeft.style.height=""+top+"px",this._areas.centerLeft.style.height=""+height+"px"}},{key:"_handleKnobs",value:function(){var _this3=this,_loop2=function(identifier){var knob=_this3._knobs[identifier];knob.addEventListener("mousedown",function(e){_this3._onKnobDown(e,knob)}),knob.addEventListener("touchstart",function(e){_this3._onKnobDown(e,knob)})};for(var identifier in this._knobs)_loop2(identifier)}},{key:"_onKnobDown",value:function(e,knob){e.preventDefault(),e.stopPropagation(),this._currentKnob=knob,this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._startBeforeDrag=this._start.clone(),this._endBeforeDrag=this._end.clone(),document.addEventListener("mousemove",this._onKnobDrag),document.addEventListener("touchmove",this._onKnobDrag),document.addEventListener("mouseup",this._onKnobUp),document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function(e){e.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(e),mouseDiff=mousePosition.subtract(this._initialMousePosition),corner=this._currentKnob.dataset.corner,canvasSize=this._ui.canvas.size,absoluteStart=this._startBeforeDrag.clone().multiply(canvasSize),absoluteEnd=this._endBeforeDrag.clone().multiply(canvasSize),width=void 0,height=void 0,maximum=void 0,minimum=void 0;switch(corner){case"top-left":absoluteStart.add(mouseDiff),maximum=absoluteEnd.clone().subtract(this._minimumSize),absoluteStart.clamp(null,maximum);break;case"top-right":absoluteEnd.x+=mouseDiff.x,absoluteStart.y+=mouseDiff.y,absoluteEnd.x=Math.max(absoluteStart.x+this._minimumSize.x,absoluteEnd.x),absoluteStart.y=Math.min(absoluteEnd.y-this._minimumSize.y,absoluteStart.y);break;case"bottom-right":absoluteEnd.add(mouseDiff),minimum=absoluteStart.clone().add(this._minimumSize),absoluteEnd.clamp(minimum);break;case"bottom-left":absoluteStart.x+=mouseDiff.x,absoluteEnd.y+=mouseDiff.y,absoluteStart.x=Math.min(absoluteEnd.x-this._minimumSize.x,absoluteStart.x),absoluteEnd.y=Math.max(absoluteStart.y+this._minimumSize.y,absoluteEnd.y)}if(this._start.copy(absoluteStart).divide(canvasSize),this._end.copy(absoluteEnd).divide(canvasSize),this._start.clamp(0,1),this._end.clamp(0,1),null!==this._ratio)switch(corner){case"top-left":width=(this._end.x-this._start.x)*canvasSize.x,height=width/this._ratio,this._start.y=this._end.y-height/canvasSize.y,this._start.y<=0&&(this._start.y=0,height=(this._end.y-this._start.y)*canvasSize.y,width=height*this._ratio,this._start.x=this._end.x-width/canvasSize.x);break;case"top-right":width=(this._end.x-this._start.x)*canvasSize.x,height=width/this._ratio,this._start.y=this._end.y-height/canvasSize.y,this._start.y<=0&&(this._start.y=0,height=(this._end.y-this._start.y)*canvasSize.y,width=height*this._ratio,this._end.x=this._start.x+width/canvasSize.x);break;case"bottom-right":width=(this._end.x-this._start.x)*canvasSize.x,height=width/this._ratio,this._end.y=this._start.y+height/canvasSize.y,this._end.y>=1&&(this._end.y=1,height=(this._end.y-this._start.y)*canvasSize.y,width=height*this._ratio,this._end.x=this._start.x+width/canvasSize.x);break;case"bottom-left":width=(this._end.x-this._start.x)*canvasSize.x,height=width/this._ratio,this._end.y=this._start.y+height/canvasSize.y,this._end.y>=1&&(this._end.y=1,height=(this._end.y-this._start.y)*canvasSize.y,width=height*this._ratio,this._start.x=this._end.x-width/canvasSize.x);
}this._updateDOM()}},{key:"_onKnobUp",value:function(){this._currentKnob=null,document.removeEventListener("mousemove",this._onKnobDrag),document.removeEventListener("touchmove",this._onKnobDrag),document.removeEventListener("mouseup",this._onKnobUp),document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleCenter",value:function(){this._areas.centerCenter.addEventListener("mousedown",this._onCenterDown),this._areas.centerCenter.addEventListener("touchstart",this._onCenterDown)}},{key:"_onCenterDown",value:function(e){this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._startBeforeDrag=this._start.clone(),this._endBeforeDrag=this._end.clone(),document.addEventListener("mousemove",this._onCenterDrag),document.addEventListener("touchmove",this._onCenterDrag),document.addEventListener("mouseup",this._onCenterUp),document.addEventListener("touchend",this._onCenterUp)}},{key:"_onCenterDrag",value:function(e){var mousePosition=_libUtils2["default"].getEventPosition(e),mouseDiff=mousePosition.subtract(this._initialMousePosition),canvasSize=this._ui.canvas.size,cropSize=this._endBeforeDrag.clone().subtract(this._startBeforeDrag),absoluteCropSize=cropSize.clone().multiply(canvasSize),absoluteStart=this._startBeforeDrag.clone().multiply(canvasSize),absoluteEnd=this._endBeforeDrag.clone().multiply(canvasSize);absoluteStart.add(mouseDiff);var maxStart=canvasSize.clone().subtract(absoluteCropSize);absoluteStart.clamp(new _libMathVector22["default"](0,0),maxStart),absoluteEnd.copy(absoluteStart).add(absoluteCropSize),this._start.copy(absoluteStart).divide(canvasSize),this._end.copy(absoluteEnd).divide(canvasSize),this._updateDOM()}},{key:"_onCenterUp",value:function(){document.removeEventListener("mousemove",this._onCenterDrag),document.removeEventListener("touchmove",this._onCenterDrag),document.removeEventListener("mouseup",this._onCenterUp),document.removeEventListener("touchend",this._onCenterUp)}},{key:"_onBack",value:function(){this._ui.canvas.setZoomLevel(this._initialZoomLevel,!1),this._operationExistedBefore?this._operation.set({start:this._initialStart,end:this._initialEnd}):this._ui.removeOperation("crop"),this._ui.canvas.render()}},{key:"_onDone",value:function(){this._operation.set({start:this._start,end:this._end}),this._ui.canvas.zoomToFit(!0),this._ui.addHistory(this._operation,{start:this._initialStart.clone(),end:this._initialEnd.clone()},this._operationExistedBefore)}},{key:"context",get:function(){var context=_get(Object.getPrototypeOf(CropControl.prototype),"context",this);return context.ratios=this._ratios,context}},{key:"selectedRatio",get:function(){return this._selectedRatio}}]),CropControl}(_control2["default"]);CropControl.prototype.identifier="crop",exports["default"]=CropControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libSimpleSlider=__webpack_require__(100),_libSimpleSlider2=_interopRequireDefault(_libSimpleSlider),RadialBlurControl=function(_Control){function RadialBlurControl(){_classCallCheck(this,RadialBlurControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(RadialBlurControl,_Control),_createClass(RadialBlurControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div class="imglykit-controls-icon">\n    <img src="{{=it.helpers.assetPath(\'ui/night/blur/blur.png\')}}" />\n  </div>\n\n  <div>\n    {{var sliderId = "imglykit-blur-radius-slider";}}\n    {{#def.simpleSlider}}\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-radial-blur-container">\n  <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-position"></div>\n  <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-gradient"></div>\n  <div class="imglykit-canvas-radial-blur-circle-container">\n    <div class="imglykit-canvas-radial-blur-circle"></div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate,this._partialTemplates.push(_libSimpleSlider2["default"].template)}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations["radial-blur"],this._operation=this._ui.getOrCreateOperation("radial-blur"),this._initialSettings={position:this._operation.getPosition().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()},this._onPositionKnobDown=this._onPositionKnobDown.bind(this),this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this),this._onPositionKnobUp=this._onPositionKnobUp.bind(this),this._onGradientKnobDown=this._onGradientKnobDown.bind(this),this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this),this._onGradientKnobUp=this._onGradientKnobUp.bind(this),this._positionKnob=this._canvasControls.querySelector("#imglykit-radial-blur-position"),this._gradientKnob=this._canvasControls.querySelector("#imglykit-radial-blur-gradient"),this._circle=this._canvasControls.querySelector(".imglykit-canvas-radial-blur-circle"),this._handleKnobs(),this._initSliders(),this._ui.canvas.render().then(function(){_this._updateDOM()})}},{key:"_initSliders",value:function(){var blurRadiusSlider=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new _libSimpleSlider2["default"](blurRadiusSlider,{minValue:0,maxValue:40}),this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this)),this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function(value){this._operation.setBlurRadius(value),this._ui.canvas.render(),this._highlightDoneButton()}},{key:"_handleKnobs",value:function(){var canvasSize=this._ui.canvas.size,position=this._operation.getPosition().clone().multiply(canvasSize);this._gradientKnobPosition=position.clone().add(this._initialSettings.gradientRadius,0),this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown),this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown),this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown),this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown)}},{key:"_onPositionKnobDown",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size;this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialPosition=this._operation.getPosition().clone(),this._gradientKnobDistance=this._gradientKnobPosition.clone().subtract(this._initialPosition.clone().multiply(canvasSize)),document.addEventListener("mousemove",this._onPositionKnobDrag),document.addEventListener("touchmove",this._onPositionKnobDrag),document.addEventListener("mouseup",this._onPositionKnobUp),document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.subtract(this._initialMousePosition),newPosition=this._initialPosition.clone().multiply(canvasSize).add(diff),maxPosition=canvasSize.clone().subtract(this._gradientKnobDistance);newPosition.clamp(new _libMathVector22["default"](0,0),maxPosition),this._gradientKnobPosition.copy(newPosition).add(this._gradientKnobDistance),newPosition.divide(canvasSize),this._operation.setPosition(newPosition),this._updateDOM(),this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function(e){e.preventDefault(),document.removeEventListener("mousemove",this._onPositionKnobDrag),document.removeEventListener("touchmove",this._onPositionKnobDrag),document.removeEventListener("mouseup",this._onPositionKnobUp),document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialGradientKnobPosition=this._gradientKnobPosition.clone(),document.addEventListener("mousemove",this._onGradientKnobDrag),document.addEventListener("touchmove",this._onGradientKnobDrag),document.addEventListener("mouseup",this._onGradientKnobUp),document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.subtract(this._initialMousePosition);this._gradientKnobPosition=this._initialGradientKnobPosition.clone().add(diff),this._gradientKnobPosition.clamp(new _libMathVector22["default"](0,0),canvasSize);var position=this._operation.getPosition().clone().multiply(canvasSize),distance=this._gradientKnobPosition.clone().subtract(position),gradientRadius=Math.sqrt(Math.pow(distance.x,2)+Math.pow(distance.y,2));this._operation.setGradientRadius(gradientRadius),this._updateDOM(),this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function(e){e.preventDefault(),document.removeEventListener("mousemove",this._onGradientKnobDrag),document.removeEventListener("touchmove",this._onGradientKnobDrag),document.removeEventListener("mouseup",this._onGradientKnobUp),document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function(){var canvasSize=this._ui.canvas.size,position=this._operation.getPosition().clone().multiply(canvasSize);this._positionKnob.style.left=""+position.x+"px",this._positionKnob.style.top=""+position.y+"px",this._gradientKnob.style.left=""+this._gradientKnobPosition.x+"px",this._gradientKnob.style.top=""+this._gradientKnobPosition.y+"px";var circleSize=2*this._operation.getGradientRadius();this._circle.style.left=""+position.x+"px",this._circle.style.top=""+position.y+"px",this._circle.style.width=""+circleSize+"px",this._circle.style.height=""+circleSize+"px",this._circle.style.marginLeft="-"+circleSize/2+"px",this._circle.style.marginTop="-"+circleSize/2+"px"}},{key:"_onBack",value:function(){this._operationExistedBefore?this._operation.set(this._initialSettings):this._ui.removeOperation("radial-blur"),this._ui.canvas.render()}},{key:"_onDone",value:function(){this._ui.addHistory(this._operation,{position:this._initialSettings.position.clone(),gradientRadius:this._initialSettings.gradientRadius,blurRadius:this._initialSettings.blurRadius},this._operationExistedBefore)}}]),RadialBlurControl}(_control2["default"]);RadialBlurControl.prototype.identifier="radial-blur",exports["default"]=RadialBlurControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libSimpleSlider=__webpack_require__(100),_libSimpleSlider2=_interopRequireDefault(_libSimpleSlider),TiltShiftControl=function(_Control){function TiltShiftControl(){_classCallCheck(this,TiltShiftControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(TiltShiftControl,_Control),_createClass(TiltShiftControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div class="imglykit-controls-icon">\n    <img src="{{=it.helpers.assetPath(\'ui/night/blur/blur.png\')}}" />\n  </div>\n\n  <div>\n    {{var sliderId = "imglykit-blur-radius-slider";}}\n    {{#def.simpleSlider}}\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-tilt-shift-container">\n  <div class="imglykit-canvas-tilt-shift-dot" data-option="position"></div>\n  <div class="imglykit-canvas-tilt-shift-dot" data-option="gradient"></div>\n  <div class="imglykit-canvas-tilt-shift-rect-container">\n    <div class="imglykit-canvas-tilt-shift-rect"></div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate,this._partialTemplates.push(_libSimpleSlider2["default"].template),this._currentKnob=null}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations["tilt-shift"],this._operation=this._ui.getOrCreateOperation("tilt-shift"),this._initialSettings={start:this._operation.getStart().clone(),end:this._operation.getEnd().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()},this._onPositionKnobDown=this._onPositionKnobDown.bind(this),this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this),this._onPositionKnobUp=this._onPositionKnobUp.bind(this),this._onGradientKnobDown=this._onGradientKnobDown.bind(this),this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this),this._onGradientKnobUp=this._onGradientKnobUp.bind(this);var selector=".imglykit-canvas-tilt-shift-dot";this._positionKnob=this._canvasControls.querySelector(""+selector+"[data-option='position']"),this._gradientKnob=this._canvasControls.querySelector(""+selector+"[data-option='gradient']"),this._rect=this._canvasControls.querySelector(".imglykit-canvas-tilt-shift-rect"),this._initSliders(),this._ui.canvas.render().then(function(){_this._handleKnobs(),_this._updateDOM()})}},{key:"_initSliders",value:function(){var blurRadiusSlider=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new _libSimpleSlider2["default"](blurRadiusSlider,{minValue:0,maxValue:40}),this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this)),this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function(value){this._operation.setBlurRadius(value),this._ui.canvas.render(),this._highlightDoneButton()}},{key:"_handleKnobs",value:function(){this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown),this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown),this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown),this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown);var canvasSize=this._ui.canvas.size,_initialSettings=this._initialSettings,start=_initialSettings.start,end=_initialSettings.end;start=start.clone().multiply(canvasSize),end=end.clone().multiply(canvasSize);var dist=end.clone().subtract(start),middle=start.clone().add(dist.clone().divide(2)),totalDist=Math.sqrt(Math.pow(dist.x,2)+Math.pow(dist.y,2)),factor=dist.clone().divide(totalDist).divide(2);this._knobPosition=middle.clone();var gradientRadius=this._initialSettings.gradientRadius;this._gradientKnobPosition=middle.clone().add(-gradientRadius*factor.y,gradientRadius*factor.x),this._updateStartAndEnd(),this._updateDOM(),this._ui.canvas.render()}},{key:"_updateStartAndEnd",value:function(){var canvasSize=this._ui.canvas.size,diff=this._gradientKnobPosition.clone().subtract(this._knobPosition),start=this._knobPosition.clone().add(-diff.y,diff.x).divide(canvasSize),end=this._knobPosition.clone().add(diff.y,-diff.x).divide(canvasSize);this._operation.set({start:start,end:end})}},{key:"_onPositionKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialPosition=this._knobPosition.clone(),this._initialDistanceToGradientKnob=this._gradientKnobPosition.clone().subtract(this._initialPosition),document.addEventListener("mousemove",this._onPositionKnobDrag),document.addEventListener("touchmove",this._onPositionKnobDrag),document.addEventListener("mouseup",this._onPositionKnobUp),document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.subtract(this._initialMousePosition),newPosition=this._initialPosition.clone().add(diff);this._knobPosition.copy(newPosition);var minPosition=(new _libMathVector22["default"]).subtract(this._initialDistanceToGradientKnob);minPosition.clamp(new _libMathVector22["default"](0,0));var maxPosition=canvasSize.clone().subtract(this._initialDistanceToGradientKnob);maxPosition.clamp(null,canvasSize),this._knobPosition.clamp(minPosition,maxPosition),this._gradientKnobPosition.copy(this._knobPosition).add(this._initialDistanceToGradientKnob),this._updateStartAndEnd(),this._updateDOM(),this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function(e){e.preventDefault(),document.removeEventListener("mousemove",this._onPositionKnobDrag),document.removeEventListener("touchmove",this._onPositionKnobDrag),document.removeEventListener("mouseup",this._onPositionKnobUp),document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialGradientKnobPosition=this._gradientKnobPosition.clone(),document.addEventListener("mousemove",this._onGradientKnobDrag),document.addEventListener("touchmove",this._onGradientKnobDrag),document.addEventListener("mouseup",this._onGradientKnobUp),document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.subtract(this._initialMousePosition);this._gradientKnobPosition.copy(this._initialGradientKnobPosition).add(diff),this._gradientKnobPosition.clamp(new _libMathVector22["default"](0,0),canvasSize);var distance=this._gradientKnobPosition.clone().subtract(this._knobPosition),newGradientRadius=2*Math.sqrt(Math.pow(distance.x,2)+Math.pow(distance.y,2));this._operation.setGradientRadius(newGradientRadius),this._updateStartAndEnd(),this._updateDOM(),this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function(e){e.preventDefault(),document.removeEventListener("mousemove",this._onGradientKnobDrag),document.removeEventListener("touchmove",this._onGradientKnobDrag),document.removeEventListener("mouseup",this._onGradientKnobUp),document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function(){var position=this._knobPosition;this._positionKnob.style.left=""+position.x+"px",this._positionKnob.style.top=""+position.y+"px";var gradientPosition=this._gradientKnobPosition;this._gradientKnob.style.left=""+gradientPosition.x+"px",this._gradientKnob.style.top=""+gradientPosition.y+"px";var canvasSize=this._ui.canvas.size,gradientRadius=this._operation.getGradientRadius(),rectSize=new _libMathVector22["default"](2*Math.sqrt(Math.pow(canvasSize.x,2)+Math.pow(canvasSize.y,2)),gradientRadius);this._rect.style.width=""+rectSize.x+"px",this._rect.style.height=""+rectSize.y+"px",this._rect.style.marginLeft="-"+rectSize.x/2+"px",this._rect.style.marginTop="-"+rectSize.y/2+"px",this._rect.style.left=""+position.x+"px",this._rect.style.top=""+position.y+"px";var dist=gradientPosition.clone().subtract(position),degrees=Math.atan2(dist.x,dist.y)*(180/Math.PI);this._rect.style.transform="rotate("+(-degrees).toFixed(2)+"deg)"}},{key:"_onBack",value:function(){this._operationExistedBefore?this._operation.set(this._initialSettings):this._ui.removeOperation("tilt-shift"),this._ui.canvas.render()}},{key:"_onDone",value:function(){this._ui.addHistory(this._operation,{start:this._initialSettings.start.clone(),end:this._initialSettings.end.clone(),blurRadius:this._initialSettings.blurRadius,gradientRadius:this._initialSettings.gradientRadius},this._operationExistedBefore)}}]),TiltShiftControl}(_control2["default"]);TiltShiftControl.prototype.identifier="tilt-shift",exports["default"]=TiltShiftControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libSimpleSlider=__webpack_require__(100),_libSimpleSlider2=_interopRequireDefault(_libSimpleSlider),_libColorPicker=__webpack_require__(101),_libColorPicker2=_interopRequireDefault(_libColorPicker),FramesControl=function(_Control){function FramesControl(){_classCallCheck(this,FramesControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(FramesControl,_Control),_createClass(FramesControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    {{#def.simpleSlider}}\n  </div>\n\n  <div class="imglykit-controls-button">\n    {{var colorpickerLabel = "Color";}}\n    {{#def.colorpicker}}\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate,this._partialTemplates.push(_libSimpleSlider2["default"].template),this._partialTemplates.push(_libColorPicker2["default"].template)}},{key:"_onEnter",value:function(){this._operationExistedBefore=!!this._ui.operations.frames,this._operation=this._ui.getOrCreateOperation("frames"),this._initialOptions={thickness:this._operation.getThickness(),color:this._operation.getColor()},this._ui.canvas.render();var sliderElement=this._controls.querySelector(".imglykit-slider");this._slider=new _libSimpleSlider2["default"](sliderElement,{minValue:0,maxValue:.5}),this._slider.on("update",this._onThicknessUpdate.bind(this)),this._slider.setValue(this._initialOptions.thickness);var colorPickerElement=this._controls.querySelector(".imglykit-color-picker");this._colorPicker=new _libColorPicker2["default"](this._ui,colorPickerElement),this._colorPicker.on("update",this._onColorUpdate.bind(this)),this._colorPicker.setValue(this._initialOptions.color)}},{key:"_onBack",value:function(){this._operationExistedBefore?this._operation.set(this._initialOptions):this._ui.removeOperation("frames"),this._ui.canvas.render()}},{key:"_onThicknessUpdate",value:function(value){this._operation.setThickness(value),this._ui.canvas.render(),this._highlightDoneButton()}},{key:"_onColorUpdate",value:function(value){this._operation.setColor(value),this._ui.canvas.render(),this._highlightDoneButton()}},{key:"_onDone",value:function(){this._ui.addHistory(this._operation,{color:this._initialOptions.color,thickness:this._initialOptions.thickness},this._operationExistedBefore)}}]),FramesControl}(_control2["default"]);FramesControl.prototype.identifier="frames",exports["default"]=FramesControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),StickersControl=function(_Control){function StickersControl(){_classCallCheck(this,StickersControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(StickersControl,_Control),_createClass(StickersControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      {{ for(var identifier in it.stickers) { }}\n        {{ var stickerPath = it.stickers[identifier]; }}\n        {{ var enabled = it.activeSticker === identifier; }}\n        <li data-identifier="{{= identifier}}"{{? enabled}} class="imglykit-controls-item-active"{{?}} style="background-image: url(\'{{=it.helpers.assetPath(stickerPath)}}\');">\n        </li>\n      {{ } }}\n    </ul>\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-stickers-container">\n  <div class="imglykit-canvas-stickers">\n    <img class="imglykit-canvas-sticker-image" />\n    <div class="imglykit-knob"></div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate,this._availableStickers={},this._stickers={},this._addDefaultStickers(),this.selectStickers(null)}},{key:"_addDefaultStickers",value:function(){this.addSticker("glasses-nerd","stickers/sticker-glasses-nerd.png"),this.addSticker("glasses-normal","stickers/sticker-glasses-normal.png"),this.addSticker("glasses-shutter-green","stickers/sticker-glasses-shutter-green.png"),this.addSticker("glasses-shutter-yellow","stickers/sticker-glasses-shutter-yellow.png"),this.addSticker("glasses-sun","stickers/sticker-glasses-sun.png"),this.addSticker("hat-cap","stickers/sticker-hat-cap.png"),this.addSticker("hat-cylinder","stickers/sticker-hat-cylinder.png"),this.addSticker("hat-party","stickers/sticker-hat-party.png"),this.addSticker("hat-sheriff","stickers/sticker-hat-sheriff.png"),this.addSticker("heart","stickers/sticker-heart.png"),this.addSticker("mustache-long","stickers/sticker-mustache-long.png"),this.addSticker("mustache1","stickers/sticker-mustache1.png"),this.addSticker("mustache2","stickers/sticker-mustache2.png"),this.addSticker("mustache3","stickers/sticker-mustache3.png"),this.addSticker("pipe","stickers/sticker-pipe.png"),this.addSticker("snowflake","stickers/sticker-snowflake.png"),this.addSticker("star","stickers/sticker-star.png")}},{key:"addSticker",value:function(identifier,path){this._availableStickers[identifier]=path}},{key:"selectStickers",value:function(selector){this._stickers={};for(var stickerIdentifiers=Object.keys(this._availableStickers),selectedStickers=_libUtils2["default"].select(stickerIdentifiers,selector),i=0;i<selectedStickers.length;i++){var identifier=selectedStickers[i];this._stickers[identifier]=this._availableStickers[identifier]}this._active&&this._renderControls()}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations.stickers,this._operation=this._ui.getOrCreateOperation("stickers"),this._ui.removeOperation("stickers"),this._initialSettings={sticker:this._operation.getSticker(),position:this._operation.getPosition().clone(),size:this._operation.getSize().clone()};var canvasSize=this._ui.canvas.size;this._size=this._initialSettings.size.clone(),this._position=this._initialSettings.position.clone().multiply(canvasSize),this._initialZoomLevel=this._ui.canvas.zoomLevel,this._ui.canvas.zoomToFit(),this._container=this._canvasControls.querySelector(".imglykit-canvas-stickers"),this._stickerImage=this._canvasControls.querySelector("img"),this._stickerImage.addEventListener("load",function(){_this._stickerSize=new _libMathVector22["default"](_this._stickerImage.width,_this._stickerImage.height),_this._onStickerLoad()}),this._knob=this._canvasControls.querySelector("div.imglykit-knob"),this._onImageDown=this._onImageDown.bind(this),this._onImageDrag=this._onImageDrag.bind(this),this._onImageUp=this._onImageUp.bind(this),this._onKnobDown=this._onKnobDown.bind(this),this._onKnobDrag=this._onKnobDrag.bind(this),this._onKnobUp=this._onKnobUp.bind(this),this._handleListItems(),this._handleImage(),this._handleKnob()}},{key:"_handleListItems",value:function(){var _this2=this,listItems=this._controls.querySelectorAll("li");
this._listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=_this2._listItems[i],identifier=listItem.dataset.identifier;listItem.addEventListener("click",function(){_this2._onListItemClick(listItem)}),(!_this2._operationExistedBefore&&0===i||_this2._operationExistedBefore&&_this2._stickers[identifier]===_this2._initialSettings.sticker)&&_this2._onListItemClick(listItem,!1)},i=0;i<this._listItems.length;i++)_loop(i)}},{key:"_applySettings",value:function(){var ratio=this._stickerSize.y/this._stickerSize.x;this._size.y=this._size.x*ratio,this._stickerImage.style.width=""+this._size.x+"px",this._stickerImage.style.height=""+this._size.y+"px",this._container.style.left=""+this._position.x+"px",this._container.style.top=""+this._position.y+"px"}},{key:"_onBack",value:function(){this._operationExistedBefore?(this._operation=this._ui.getOrCreateOperation("stickers"),this._operation.set(this._initialSettings)):this._ui.removeOperation("stickers"),this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"_onDone",value:function(){var canvasSize=this._ui.canvas.size,position=this._position.clone().divide(canvasSize),size=this._size.clone().divide(canvasSize);this._ui.canvas.setZoomLevel(this._initialZoomLevel,!1),this._operation=this._ui.getOrCreateOperation("stickers"),this._operation.set({sticker:this._availableStickers[this._sticker],position:position,size:size}),this._ui.canvas.render(),this._ui.addHistory(this,{sticker:this._initialSettings.sticker,position:this._initialSettings.position.clone(),size:this._initialSettings.size.clone()},this._operationExistedBefore)}},{key:"_handleKnob",value:function(){this._knob.addEventListener("mousedown",this._onKnobDown),this._knob.addEventListener("touchstart",this._onKnobDown)}},{key:"_onKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialSize=this._size.clone(),document.addEventListener("mousemove",this._onKnobDrag),document.addEventListener("touchmove",this._onKnobDrag),document.addEventListener("mouseup",this._onKnobUp),document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function(e){e.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.clone().subtract(this._initialMousePosition),size=this._initialSize.clone(),ratio=this._stickerImage.height/this._stickerImage.width;size.x+=diff.x,size.y=size.x*ratio,this._size.copy(size),this._applySettings(),this._highlightDoneButton()}},{key:"_onKnobUp",value:function(){document.removeEventListener("mousemove",this._onKnobDrag),document.removeEventListener("touchmove",this._onKnobDrag),document.removeEventListener("mouseup",this._onKnobUp),document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleImage",value:function(){this._stickerImage.addEventListener("mousedown",this._onImageDown),this._stickerImage.addEventListener("touchstart",this._onImageDown)}},{key:"_onImageDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialPosition=this._position.clone(),document.addEventListener("mousemove",this._onImageDrag),document.addEventListener("touchmove",this._onImageDrag),document.addEventListener("mouseup",this._onImageUp),document.addEventListener("touchend",this._onImageUp)}},{key:"_onImageDrag",value:function(e){e.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.clone().subtract(this._initialMousePosition),position=this._initialPosition.clone();position.add(diff),this._position.copy(position),this._applySettings(),this._highlightDoneButton()}},{key:"_onImageUp",value:function(){document.removeEventListener("mousemove",this._onImageDrag),document.removeEventListener("touchmove",this._onImageDrag),document.removeEventListener("mouseup",this._onImageUp),document.removeEventListener("touchend",this._onImageUp)}},{key:"_onStickerLoad",value:function(){this._size=new _libMathVector22["default"](this._stickerImage.width,this._stickerImage.height),"undefined"==typeof this._position&&(this._position=new _libMathVector22["default"](0,0)),this._applySettings()}},{key:"_onListItemClick",value:function(item){var manually=void 0===arguments[1]?!0:arguments[1];this._deactivateAllItems();var identifier=item.dataset.identifier,stickerPath=this._availableStickers[identifier];stickerPath=this._kit.getAssetPath(stickerPath);try{this._stickerImage.attributes.removeNamedItem("style")}catch(e){}this._sticker=identifier,this._stickerImage.src=stickerPath,item.classList.add("imglykit-controls-item-active"),manually&&this._highlightDoneButton()}},{key:"_deactivateAllItems",value:function(){for(var i=0;i<this._listItems.length;i++){var listItem=this._listItems[i];listItem.classList.remove("imglykit-controls-item-active")}}},{key:"context",get:function(){var context=_get(Object.getPrototypeOf(StickersControl.prototype),"context",this);return context.stickers=this._stickers,context}}]),StickersControl}(_control2["default"]);StickersControl.prototype.identifier="stickers",exports["default"]=StickersControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_control=__webpack_require__(92),_control2=_interopRequireDefault(_control),_libColorPicker=__webpack_require__(101),_libColorPicker2=_interopRequireDefault(_libColorPicker),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),TextControl=function(_Control){function TextControl(){_classCallCheck(this,TextControl),null!=_Control&&_Control.apply(this,arguments)}return _inherits(TextControl,_Control),_createClass(TextControl,[{key:"init",value:function(){var controlsTemplate='{{##def.control:\n  <div>\n    <ul class="imglykit-controls-list imgly-controls-list-with-buttons">\n      {{~it.fonts :value:index}}\n        <li data-name="{{= value.name}}" data-weight="{{= value.weight}}" style="font-family: {{= value.name}}; font-weight: {{= value.weight}}">{{= value.name.substr(0, 2)}}</li>\n      {{~}}\n    </ul>\n  </div>\n\n  <div class="imglykit-controls-button">\n    {{var colorpickerId = "imglykit-text-foreground-color-picker";}}\n    {{var colorpickerLabel = "Foreground";}}\n    {{#def.colorpicker}}\n  </div>\n\n  <div class="imglykit-controls-button">\n    {{var colorpickerId = "imglykit-text-background-color-picker";}}\n    {{var colorpickerLabel = "Background";}}\n    {{#def.colorpicker}}\n  </div>\n\n  {{#def.doneButton}}\n#}}\n';this._controlsTemplate=controlsTemplate;var canvasControlsTemplate='<div class="imglykit-canvas-text-container">\n  <div class="imglykit-canvas-text">\n    <div class="imglykit-crosshair">\n      <img src="{{=it.helpers.assetPath(\'ui/night/crosshair.png\')}}" />\n    </div>\n    <div class="imglykit-canvas-text-textarea">\n      <textarea></textarea>\n      <div class="imglykit-knob"></div>\n    </div>\n  </div>\n</div>\n';this._canvasControlsTemplate=canvasControlsTemplate,this._partialTemplates.push(_libColorPicker2["default"].template),this._fonts=[],this._addFonts()}},{key:"_onEnter",value:function(){var _this=this;this._operationExistedBefore=!!this._ui.operations.text,this._operation=this._ui.getOrCreateOperation("text"),this._ui.removeOperation("text");var canvasSize=this._ui.canvas.size;this._initialSettings={lineHeight:this._operation.getLineHeight(),fontSize:this._operation.getFontSize(),fontFamily:this._operation.getFontFamily(),fontWeight:this._operation.getFontWeight(),color:this._operation.getColor(),position:this._operation.getPosition(),text:this._operation.getText()||"",maxWidth:this._operation.getMaxWidth(),backgroundColor:this._operation.getBackgroundColor()},this._settings={lineHeight:this._initialSettings.lineHeight,fontSize:this._initialSettings.fontSize,fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),position:this._initialSettings.position.clone().multiply(canvasSize),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth*canvasSize.x,backgroundColor:this._initialSettings.backgroundColor.clone()},this._initialZoomLevel=this._ui.canvas.zoomLevel,this._container=this._canvasControls.querySelector(".imglykit-canvas-text"),this._textarea=this._canvasControls.querySelector("textarea"),this._textarea.focus(),this._moveKnob=this._canvasControls.querySelector(".imglykit-crosshair"),this._resizeKnob=this._canvasControls.querySelector(".imglykit-knob"),this._operationExistedBefore&&(this._settings.position.x-=2,this._settings.position.y-=2),this._onTextareaKeyUp=this._onTextareaKeyUp.bind(this),this._onResizeKnobDown=this._onResizeKnobDown.bind(this),this._onResizeKnobDrag=this._onResizeKnobDrag.bind(this),this._onResizeKnobUp=this._onResizeKnobUp.bind(this),this._onMoveKnobDown=this._onMoveKnobDown.bind(this),this._onMoveKnobDrag=this._onMoveKnobDrag.bind(this),this._onMoveKnobUp=this._onMoveKnobUp.bind(this),this._onForegroundColorUpdate=this._onForegroundColorUpdate.bind(this),this._onBackgroundColorUpdate=this._onBackgroundColorUpdate.bind(this),this._initColorPickers(),this._handleListItems(),this._handleTextarea(),this._handleResizeKnob(),this._handleMoveKnob(),setTimeout(function(){_this._resizeTextarea()},1),this._ui.canvas.zoomToFit().then(function(){_this._applySettings()})}},{key:"_initColorPickers",value:function(){var _this2=this,foregroundColorPicker=this._controls.querySelector("#imglykit-text-foreground-color-picker");this._foregroundColorPicker=new _libColorPicker2["default"](this._ui,foregroundColorPicker),this._foregroundColorPicker.setValue(this._operation.getColor()),this._foregroundColorPicker.on("update",this._onForegroundColorUpdate),this._foregroundColorPicker.on("show",function(){_this2._backgroundColorPicker.hide()});var backgroundColorPicker=this._controls.querySelector("#imglykit-text-background-color-picker");this._backgroundColorPicker=new _libColorPicker2["default"](this._ui,backgroundColorPicker),this._backgroundColorPicker.setValue(this._operation.getBackgroundColor()),this._backgroundColorPicker.on("update",this._onBackgroundColorUpdate),this._backgroundColorPicker.on("show",function(){_this2._foregroundColorPicker.hide()})}},{key:"_handleListItems",value:function(){var _this3=this,listItems=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(listItems);for(var _loop=function(i){var listItem=_this3._listItems[i],name=listItem.dataset.name;listItem.addEventListener("click",function(){_this3._onListItemClick(listItem)}),(!_this3._operationExistedBefore&&0===i||_this3._operationExistedBefore&&name===_this3._initialSettings.fontFamily)&&_this3._onListItemClick(listItem,!1)},i=0;i<this._listItems.length;i++)_loop(i)}},{key:"_handleTextarea",value:function(){this._textarea.addEventListener("keyup",this._onTextareaKeyUp)}},{key:"_onTextareaKeyUp",value:function(){this._resizeTextarea(),this._settings.text=this._textarea.value,this._highlightDoneButton()}},{key:"_resizeTextarea",value:function(){var scrollTop=this._textarea.scrollTop;if(!scrollTop){var _scrollHeight=void 0,height=void 0;do _scrollHeight=this._textarea.scrollHeight,height=this._textarea.offsetHeight,this._textarea.style.height=""+(height-5)+"px";while(_scrollHeight&&_scrollHeight!==this._textarea.scrollHeight)}var scrollHeight=this._textarea.scrollHeight;this._textarea.style.height=""+(scrollHeight+20)+"px"}},{key:"_handleMoveKnob",value:function(){this._moveKnob.addEventListener("mousedown",this._onMoveKnobDown),this._moveKnob.addEventListener("touchstart",this._onMoveKnobDown)}},{key:"_onMoveKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialPosition=this._settings.position.clone(),document.addEventListener("mousemove",this._onMoveKnobDrag),document.addEventListener("touchmove",this._onMoveKnobDrag),document.addEventListener("mouseup",this._onMoveKnobUp),document.addEventListener("tochend",this._onMoveKnobUp)}},{key:"_onMoveKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.clone().subtract(this._initialMousePosition),minPosition=new _libMathVector22["default"](0,0),containerSize=new _libMathVector22["default"](this._container.offsetWidth,this._container.offsetHeight),maxPosition=canvasSize.clone().subtract(containerSize),position=this._initialPosition.clone().add(diff).clamp(minPosition,maxPosition);this._settings.position=position,this._container.style.left=""+position.x+"px",this._container.style.top=""+position.y+"px"}},{key:"_onMoveKnobUp",value:function(){document.removeEventListener("mousemove",this._onMoveKnobDrag),document.removeEventListener("touchmove",this._onMoveKnobDrag),document.removeEventListener("mouseup",this._onMoveKnobUp),document.removeEventListener("touchend",this._onMoveKnobUp)}},{key:"_handleResizeKnob",value:function(){this._resizeKnob.addEventListener("mousedown",this._onResizeKnobDown),this._resizeKnob.addEventListener("touchstart",this._onResizeKnobDown)}},{key:"_onResizeKnobDown",value:function(e){e.preventDefault(),this._initialMousePosition=_libUtils2["default"].getEventPosition(e),this._initialMaxWidth=this._settings.maxWidth,document.addEventListener("mousemove",this._onResizeKnobDrag),document.addEventListener("touchmove",this._onResizeKnobDrag),document.addEventListener("mouseup",this._onResizeKnobUp),document.addEventListener("touchend",this._onResizeKnobUp)}},{key:"_onResizeKnobDrag",value:function(e){e.preventDefault();var canvasSize=this._ui.canvas.size,mousePosition=_libUtils2["default"].getEventPosition(e),diff=mousePosition.subtract(this._initialMousePosition),position=this._settings.position.clone(),maxWidthAllowed=canvasSize.x-position.x,maxWidth=this._initialMaxWidth+diff.x;maxWidth=Math.max(100,Math.min(maxWidthAllowed,maxWidth)),this._settings.maxWidth=maxWidth,this._textarea.style.width=""+maxWidth+"px",this._resizeTextarea()}},{key:"_onResizeKnobUp",value:function(){document.removeEventListener("mousemove",this._onResizeKnobDrag),document.removeEventListener("touchmove",this._onResizeKnobDrag),document.removeEventListener("mouseup",this._onResizeKnobUp),document.removeEventListener("touchend",this._onResizeKnobUp)}},{key:"_onForegroundColorUpdate",value:function(value){this._settings.color=value,this._applySettings(),this._highlightDoneButton()}},{key:"_onBackgroundColorUpdate",value:function(value){this._settings.backgroundColor=value,this._applySettings(),this._highlightDoneButton()}},{key:"_applySettings",value:function(){var textarea=this._textarea,settings=this._settings,canvasSize=this._ui.canvas.size,actualFontSize=settings.fontSize*canvasSize.y;this._container.style.left=""+settings.position.x+"px",this._container.style.top=""+settings.position.y+"px",textarea.value=settings.text,textarea.style.fontFamily=settings.fontFamily,textarea.style.fontSize=""+actualFontSize+"px",textarea.style.fontWeight=settings.fontWeight,textarea.style.lineHeight=settings.lineHeight,textarea.style.color=settings.color.toRGBA(),textarea.style.backgroundColor=settings.backgroundColor.toRGBA(),textarea.style.width=""+settings.maxWidth+"px"}},{key:"_onListItemClick",value:function(item){var manually=void 0===arguments[1]?!0:arguments[1];this._deactivateAllItems();var _item$dataset=item.dataset,name=_item$dataset.name,weight=_item$dataset.weight;this._settings.fontFamily=name,this._settings.fontWeight=weight,this._applySettings(),item.classList.add("imglykit-controls-item-active"),manually&&this._highlightDoneButton()}},{key:"_deactivateAllItems",value:function(){for(var i=0;i<this._listItems.length;i++){var listItem=this._listItems[i];listItem.classList.remove("imglykit-controls-item-active")}}},{key:"_addFonts",value:function(){this.addFont("Helvetica","normal"),this.addFont("Lucida Grande","normal"),this.addFont("Times New Roman","normal")}},{key:"addFont",value:function(name,weight){this._fonts.push({name:name,weight:weight})}},{key:"_onDone",value:function(){var canvasSize=this._ui.canvas.size,padding=new _libMathVector22["default"](2,2),position=this._settings.position.clone().add(padding).divide(canvasSize);this._ui.canvas.setZoomLevel(this._initialZoomLevel,!1),this._operation=this._ui.getOrCreateOperation("text"),this._operation.set({fontSize:this._settings.fontSize,fontFamily:this._settings.fontFamily,fontWeight:this._settings.fontWeight,color:this._settings.color,backgroundColor:this._settings.backgroundColor,position:position,text:this._settings.text,maxWidth:this._settings.maxWidth/canvasSize.x}),this._ui.canvas.render(),this._ui.addHistory(this,{fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),backgroundColor:this._initialSettings.backgroundColor.clone(),position:this._initialSettings.position.clone(),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth},this._operationExistedBefore)}},{key:"_onBack",value:function(){this._operationExistedBefore?(this._operation=this._ui.getOrCreateOperation("text"),this._operation.set(this._initialSettings)):this._ui.removeOperation("text"),this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"context",get:function(){var context=_get(Object.getPrototypeOf(TextControl.prototype),"context",this);return context.fonts=this._fonts,context}}]),TextControl}(_control2["default"]);TextControl.prototype.identifier="text",exports["default"]=TextControl,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_dot=__webpack_require__(98),_dot2=_interopRequireDefault(_dot),_baseHelpers=__webpack_require__(97),_baseHelpers2=_interopRequireDefault(_baseHelpers),_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),_libScrollbar=__webpack_require__(79),_libScrollbar2=_interopRequireDefault(_libScrollbar),_libExtend=__webpack_require__(58),_libExtend2=_interopRequireDefault(_libExtend),Control=function(_EventEmitter){function Control(kit,ui,operation){_classCallCheck(this,Control),_get(Object.getPrototypeOf(Control.prototype),"constructor",this).call(this),this._kit=kit,this._ui=ui,this._operation=operation,this._helpers=new _baseHelpers2["default"](this._kit,this._ui,this._ui.options),this._partialTemplates=['{{##def.doneButton:\n  <div class="imglykit-controls-button imglykit-controls-done">\n    <img src="{{=it.helpers.assetPath(\'ui/night/buttons/done.png\') }}" />\n    <div class="imglykit-controls-done-highlighted">\n      <img src="{{=it.helpers.assetPath(\'ui/night/buttons/done-highlighted.png\') }}" />\n    </div>\n  </div>\n#}}\n'],this._template='<div class="imglykit-controls-{{=it.identifier}}">\n  <div class="imglykit-controls-button imglykit-controls-back">\n    <img src="{{=it.helpers.assetPath(\'ui/night/buttons/back.png\') }}" />\n  </div>\n\n  {{#def.control}}\n</div>\n',this._active=!1,this.init()}return _inherits(Control,_EventEmitter),_createClass(Control,[{key:"setContainers",value:function(controlsContainer,canvasControlsContainer){this._controlsContainer=controlsContainer,this._canvasControlsContainer=canvasControlsContainer}},{key:"init",value:function(){}},{key:"_renderAllControls",value:function(){this._renderControls(),this._renderCanvasControls(),this._initScrollbar()}},{key:"_renderControls",value:function(){if("undefined"==typeof this._controlsTemplate)throw new Error("Control#_renderOverviewControls: Control needs to define this._controlsTemplate.");var template=this._partialTemplates.concat([this._controlsTemplate,this._template]).join("\r\n"),renderFn=_dot2["default"].template(template),html=renderFn(this.context);"undefined"!=typeof this._controls&&null!==this._controls.parentNode&&this._controls.parentNode.removeChild(this._controls),this._controls=document.createElement("div"),this._controls.innerHTML=html,this._controlsContainer.appendChild(this._controls)}},{key:"_renderCanvasControls",value:function(){if("undefined"!=typeof this._canvasControlsTemplate){var template=this._partialTemplates.concat([this._canvasControlsTemplate]).join("\r\n"),renderFn=_dot2["default"].template(template),html=renderFn(this.context);this._canvasControls=document.createElement("div"),this._canvasControls.innerHTML=html,this._canvasControlsContainer.appendChild(this._canvasControls)}}},{key:"_initScrollbar",value:function(){var list=this._controls.querySelector(".imglykit-controls-list");list&&(this._scrollbar=new _libScrollbar2["default"](list.parentNode))}},{key:"_removeControls",value:function(){this._controls.parentNode.removeChild(this._controls),this._canvasControls&&this._canvasControls.parentNode.removeChild(this._canvasControls),this._scrollbar&&this._scrollbar.remove()}},{key:"_handleBackAndDoneButtons",value:function(){this._backButton=this._controls.querySelector(".imglykit-controls-back"),this._backButton&&this._backButton.addEventListener("click",this._onBackButtonClick.bind(this)),this._doneButton=this._controls.querySelector(".imglykit-controls-done"),this._doneButton&&this._doneButton.addEventListener("click",this._onDoneButtonClick.bind(this))}},{key:"_onBackButtonClick",value:function(){this._onBack(),this.emit("back")}},{key:"_onDoneButtonClick",value:function(){this._onDone(),this.emit("back")}},{key:"_highlightDoneButton",value:function(){this._doneButton.classList.add("highlighted")}},{key:"enter",value:function(){this._active=!0,this._ui.hideZoom(),this._renderAllControls(),this._handleBackAndDoneButtons(),this._enableCanvasControls(),this._onEnter()}},{key:"leave",value:function(){this._active=!1,this._ui.showZoom(),this._removeControls(),this._disableCanvasControls(),this._onLeave()}},{key:"_enableCanvasControls",value:function(){this._canvasControlsContainer.classList.remove("imglykit-canvas-controls-disabled")}},{key:"_disableCanvasControls",value:function(){this._canvasControlsContainer.classList.add("imglykit-canvas-controls-disabled")}},{key:"_onEnter",value:function(){}},{key:"_onLeave",value:function(){}},{key:"_onBack",value:function(){}},{key:"_onDone",value:function(){}},{key:"onZoom",value:function(){}},{key:"context",get:function(){return{helpers:this._helpers,identifier:this.identifier}}}]),Control}(_libEventEmitter2["default"]);Control.prototype.identifier=null,Control.extend=_libExtend2["default"],exports["default"]=Control,module.exports=exports["default"]},function(module,exports,__webpack_require__){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children=[],module.webpackPolyfill=1),module}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";exports["default"]={encode:function(input){var output="",chr1=void 0,chr2=void 0,chr3="",enc1=void 0,enc2=void 0,enc3=void 0,enc4="",i=0;do chr1=input[i++],chr2=input[i++],chr3=input[i++],enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+KEY_STR.charAt(enc1)+KEY_STR.charAt(enc2)+KEY_STR.charAt(enc3)+KEY_STR.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";while(i<input.length);return output},decode:function(input){var chr1=void 0,chr2=void 0,chr3="",enc1=void 0,enc2=void 0,enc3=void 0,enc4="",i=0,buf=[],base64test=/[^A-Za-z0-9\+\/\=]/g;if(base64test.exec(input))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do enc1=KEY_STR.indexOf(input.charAt(i++)),enc2=KEY_STR.indexOf(input.charAt(i++)),enc3=KEY_STR.indexOf(input.charAt(i++)),enc4=KEY_STR.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,buf.push(chr1),64!==enc3&&buf.push(chr2),64!==enc4&&buf.push(chr3),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";while(i<input.length);return buf}},module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x2=parent,_x3=property,_x4=receiver,_again=!0}},_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),Renderer=function(_EventEmitter){function Renderer(dimensions,canvas){_classCallCheck(this,Renderer),_get(Object.getPrototypeOf(Renderer.prototype),"constructor",this).call(this),this._canvas=canvas||this.createCanvas(),canvas||this.setSize(dimensions),this._context=this._getContext(),this._cache={}}return _inherits(Renderer,_EventEmitter),_createClass(Renderer,[{key:"cache",value:function(identifier){}},{key:"drawCached",value:function(identifier){}},{key:"createCanvas",value:function(width,height){var canvas,isBrowser="undefined"!=typeof window;if(isBrowser)canvas=document.createElement("canvas");else{var Canvas=__webpack_require__(53);canvas=new Canvas}return"undefined"!=typeof width&&(canvas.width=width),"undefined"!=typeof height&&(canvas.height=height),canvas}},{key:"getSize",value:function(){return new _libMathVector22["default"](this._canvas.width,this._canvas.height)}},{key:"setSize",value:function(dimensions){this._canvas.width=dimensions.x,this._canvas.height=dimensions.y}},{key:"_getContext",value:function(){throw new Error("Renderer#_getContext is abstract and not implemented in inherited class.")}},{key:"resizeTo",value:function(dimensions){throw new Error("Renderer#resizeTo is abstract and not implemented in inherited class.")}},{key:"drawImage",value:function(image){throw new Error("Renderer#drawImage is abstract and not implemented in inherited class.")}},{key:"renderFinal",value:function(){}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getContext",value:function(){return this._context}},{key:"setCanvas",value:function(canvas){this._canvas=canvas,this._context=this._getContext(),this.emit("new-canvas",this._canvas)}},{key:"setContext",value:function(context){this._context=context}},{key:"reset",value:function(){void 0===arguments[0]?!1:arguments[0]}},{key:"identifier",get:function(){return null}}],[{key:"isSupported",value:function(){throw new Error("Renderer#isSupported is abstract and not implemented in inherited class.")}}]),Renderer}(_libEventEmitter2["default"]);exports["default"]=Renderer,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){
return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Primitive=function(){function Primitive(options){_classCallCheck(this,Primitive),options=options||{},this._options=options}return _createClass(Primitive,[{key:"render",value:function(renderer){"webgl"===renderer.identifier?this.renderWebGL(renderer):this.renderCanvas(renderer)}},{key:"renderWebGL",value:function(renderer){throw new Error("Primitive#renderWebGL is abstract and not implemented in inherited class.")}},{key:"renderCanvas",value:function(renderer){throw new Error("Primitive#renderCanvas is abstract and not implemented in inherited class.")}}]),Primitive}();exports["default"]=Primitive,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Helpers=function(){function Helpers(kit,ui,options){_classCallCheck(this,Helpers),this._kit=kit,this._ui=ui,this._options=options}return _createClass(Helpers,[{key:"assetPath",value:function(asset){return this._options.assetsUrl+"/"+asset}}]),Helpers}();exports["default"]=Helpers,module.exports=exports["default"]},function(module,exports,__webpack_require__){function InstallDots(o){this.__path=o.path||"./","/"!==this.__path[this.__path.length-1]&&(this.__path+="/"),this.__destination=o.destination||this.__path,"/"!==this.__destination[this.__destination.length-1]&&(this.__destination+="/"),this.__global=o.global||"window.render",this.__rendermodule=o.rendermodule||{},this.__settings=o.templateSettings?copy(o.templateSettings,copy(doT.templateSettings)):void 0,this.__includes={}}function addexports(exports){for(var ret="",i=0;i<exports.length;i++)ret+="itself."+exports[i]+"="+exports[i]+";";return ret}function copy(o,to){to=to||{};for(var property in o)to[property]=o[property];return to}function readdata(path){var data=fs.readFileSync(path);return data?data.toString():void console.log("problems with "+path)}var fs=__webpack_require__(52),doT=module.exports=__webpack_require__(102);doT.process=function(options){return new InstallDots(options).compileAll()},InstallDots.prototype.compileToFile=function(path,template,def){def=def||{};var fn,modulename=path.substring(path.lastIndexOf("/")+1,path.lastIndexOf(".")),defs=copy(this.__includes,copy(def)),settings=this.__settings||doT.templateSettings,compileoptions=copy(settings),defaultcompiled=doT.template(template,settings,defs),exports=[],compiled="";for(var property in defs)defs[property]!==def[property]&&defs[property]!==this.__includes[property]&&(fn=void 0,"string"==typeof defs[property]?fn=doT.template(defs[property],settings,defs):"function"==typeof defs[property]?fn=defs[property]:defs[property].arg&&(compileoptions.varname=defs[property].arg,fn=doT.template(defs[property].text,compileoptions,defs)),fn&&(compiled+=fn.toString().replace("anonymous",property),exports.push(property)));compiled+=defaultcompiled.toString().replace("anonymous",modulename),fs.writeFileSync(path,"(function(){"+compiled+"var itself="+modulename+", _encodeHTML=("+doT.encodeHTMLSource.toString()+"("+(settings.doNotSkipEncoded||"")+"));"+addexports(exports)+"if(typeof module!=='undefined' && module.exports) module.exports=itself;else if(typeof define==='function')define(function(){return itself;});else {"+this.__global+"="+this.__global+"||{};"+this.__global+"['"+modulename+"']=itself;}}());")},InstallDots.prototype.compilePath=function(path){var data=readdata(path);return data?doT.template(data,this.__settings||doT.templateSettings,copy(this.__includes)):void 0},InstallDots.prototype.compileAll=function(){console.log("Compiling all doT templates...");var k,l,name,defFolder=this.__path,sources=fs.readdirSync(defFolder);for(k=0,l=sources.length;l>k;k++)name=sources[k],/\.def(\.dot|\.jst)?$/.test(name)&&(console.log("Loaded def "+name),this.__includes[name.substring(0,name.indexOf("."))]=readdata(defFolder+name));for(k=0,l=sources.length;l>k;k++)name=sources[k],/\.dot(\.def|\.jst)?$/.test(name)&&(console.log("Compiling "+name+" to function"),this.__rendermodule[name.substring(0,name.indexOf("."))]=this.compilePath(defFolder+name)),/\.jst(\.dot|\.def)?$/.test(name)&&(console.log("Compiling "+name+" to file"),this.compileToFile(this.__destination+name.substring(0,name.indexOf("."))+".js",readdata(defFolder+name)));return this.__rendermodule}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),_lodash=__webpack_require__(1),_lodash2=_interopRequireDefault(_lodash),Slider=function(_EventEmitter){function Slider(element,options){_classCallCheck(this,Slider),_get(Object.getPrototypeOf(Slider.prototype),"constructor",this).call(this),this._element=element,this._options=_lodash2["default"].defaults(options,{minValue:0,maxValue:1,defaultValue:0}),this._value=this._options.defaultValue,this._sliderElement=this._element.querySelector(".imglykit-slider-slider"),this._dotElement=this._element.querySelector(".imglykit-slider-dot"),this._centerDotElement=this._element.querySelector(".imglykit-slider-center-dot"),this._fillElement=this._element.querySelector(".imglykit-slider-fill"),this._backgroundElement=this._element.querySelector(".imglykit-slider-background"),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onCenterDotClick=this._onCenterDotClick.bind(this),this._onBackgroundClick=this._onBackgroundClick.bind(this),this._backgroundElement.addEventListener("click",this._onBackgroundClick),this._fillElement.addEventListener("click",this._onBackgroundClick),this._handleDot()}return _inherits(Slider,_EventEmitter),_createClass(Slider,[{key:"setValue",value:function(value){this._value=value;var _options=this._options,maxValue=_options.maxValue,minValue=_options.minValue,valueRange=maxValue-minValue,percentage=(value-minValue)/valueRange,sliderWidth=this._sliderElement.offsetWidth;this._setX(sliderWidth*percentage)}},{key:"_setX",value:function(x){this._xPosition=x,this._dotElement.style.left=""+x+"px";var halfSliderWidth=this._sliderElement.offsetWidth/2,relativeX=x-halfSliderWidth;this._fillElement.style.width=""+Math.abs(relativeX)+"px",0>relativeX?this._fillElement.style.left=halfSliderWidth-Math.abs(relativeX)+"px":this._fillElement.style.left=halfSliderWidth+"px"}},{key:"_handleDot",value:function(){this._dotElement.addEventListener("mousedown",this._onMouseDown),this._dotElement.addEventListener("touchstart",this._onMouseDown),this._centerDotElement&&this._centerDotElement.addEventListener("click",this._onCenterDotClick)}},{key:"_onCenterDotClick",value:function(){this.setValue(this._options.defaultValue),this.emit("update",this._value)}},{key:"_onBackgroundClick",value:function(e){var position=_libUtils2["default"].getEventPosition(e),sliderOffset=this._sliderElement.getBoundingClientRect();sliderOffset=new _libMathVector22["default"](sliderOffset.left,sliderOffset.y);var relativePosition=position.clone().subtract(sliderOffset);this._setX(relativePosition.x),this._updateValue()}},{key:"_onMouseDown",value:function(e){if("mousedown"!==e.type||0===e.button){e.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(e);document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp);var dotPosition=this._dotElement.getBoundingClientRect(),sliderPosition=this._sliderElement.getBoundingClientRect();this._initialSliderX=dotPosition.left-sliderPosition.left,this._initialMousePosition=mousePosition}}},{key:"_onMouseMove",value:function(e){e.preventDefault();var mousePosition=_libUtils2["default"].getEventPosition(e),mouseDiff=mousePosition.subtract(this._initialMousePosition),halfDotWidth=.5*this._dotElement.offsetWidth,newSliderX=this._initialSliderX+mouseDiff.x+halfDotWidth,sliderWidth=this._sliderElement.offsetWidth;newSliderX=Math.max(0,Math.min(newSliderX,sliderWidth)),this._setX(newSliderX),this._updateValue()}},{key:"_updateValue",value:function(){var sliderWidth=this._sliderElement.offsetWidth,_options2=this._options,minValue=_options2.minValue,maxValue=_options2.maxValue,percentage=this._xPosition/sliderWidth,value=minValue+(maxValue-minValue)*percentage;this.emit("update",value)}},{key:"_onMouseUp",value:function(){document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)}}],[{key:"template",get:function(){return'{{##def.slider:\n  <div class="imglykit-slider" id="{{=(typeof sliderId === "undefined"?\'\':sliderId)}}">\n    <div class="imglykit-slider-minus">\n      <img src="{{=it.helpers.assetPath(\'ui/night/slider/minus.png\') }}" />\n    </div>\n    <div class="imglykit-slider-slider">\n      <div class="imglykit-slider-background"></div>\n      <div class="imglykit-slider-fill"></div>\n      <div class="imglykit-slider-center-dot"></div>\n      <div class="imglykit-slider-dot"></div>\n    </div>\n    <div class="imglykit-slider-plus">\n      <img src="{{=it.helpers.assetPath(\'ui/night/slider/plus.png\') }}" />\n    </div>\n  </div>\n#}}\n'}}]),Slider}(_libEventEmitter2["default"]);exports["default"]=Slider,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_slider=__webpack_require__(99),_slider2=_interopRequireDefault(_slider),SimpleSlider=function(_Slider){function SimpleSlider(){_classCallCheck(this,SimpleSlider),null!=_Slider&&_Slider.apply(this,arguments)}return _inherits(SimpleSlider,_Slider),_createClass(SimpleSlider,[{key:"_setX",value:function(x){this._xPosition=x,this._dotElement.style.left=""+x+"px",this._fillElement.style.width=""+x+"px"}}],[{key:"template",get:function(){return'{{##def.simpleSlider:\n  <div class="imglykit-slider" id="{{=(typeof sliderId === "undefined"?\'\':sliderId)}}">\n    <div class="imglykit-slider-minus">\n      <img src="{{=it.helpers.assetPath(\'ui/night/slider/minus.png\') }}" />\n    </div>\n    <div class="imglykit-slider-slider">\n      <div class="imglykit-slider-background"></div>\n      <div class="imglykit-slider-fill"></div>\n      <div class="imglykit-slider-dot"></div>\n    </div>\n    <div class="imglykit-slider-plus">\n      <img src="{{=it.helpers.assetPath(\'ui/night/slider/plus.png\') }}" />\n    </div>\n  </div>\n#}}\n'}}]),SimpleSlider}(_slider2["default"]);exports["default"]=SimpleSlider,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _slicedToArray(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr)){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i["return"]&&_i["return"]()}finally{if(_d)throw _e}}return _arr}throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1;var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_libEventEmitter=__webpack_require__(72),_libEventEmitter2=_interopRequireDefault(_libEventEmitter),_libUtils=__webpack_require__(6),_libUtils2=_interopRequireDefault(_libUtils),_libColor=__webpack_require__(7),_libColor2=_interopRequireDefault(_libColor),_libMathVector2=__webpack_require__(50),_libMathVector22=_interopRequireDefault(_libMathVector2),ColorPicker=function(_EventEmitter){function ColorPicker(ui,element){_classCallCheck(this,ColorPicker),_get(Object.getPrototypeOf(ColorPicker.prototype),"constructor",this).call(this),this._ui=ui,this._element=element,this._visible=!1,this._loaded=!1,this._overlay=this._element.querySelector(".imglykit-color-picker-overlay"),this._currentColorCanvas=this._element.querySelector(".imglykit-color-picker-color"),this._alphaCanvas=this._element.querySelector("canvas.imglykit-color-picker-alpha"),this._alphaKnob=this._element.querySelector(".imglykit-color-picker-alpha-container .imglykit-transparent-knob"),this._hueCanvas=this._element.querySelector("canvas.imglykit-color-picker-hue"),this._hueKnob=this._element.querySelector(".imglykit-color-picker-hue-container .imglykit-transparent-knob"),this._saturationCanvas=this._element.querySelector("canvas.imglykit-color-picker-saturation"),this._saturationKnob=this._element.querySelector(".imglykit-color-picker-saturation-container .imglykit-transparent-knob"),this._transparencyImage=new Image,this._transparencyImage.src=ui.helpers.assetPath("ui/night/transparency.png"),this._transparencyImage.addEventListener("load",this._onTransparencyImageLoad.bind(this)),this._onAlphaCanvasDown=this._onAlphaCanvasDown.bind(this),this._onAlphaCanvasDrag=this._onAlphaCanvasDrag.bind(this),this._onAlphaCanvasUp=this._onAlphaCanvasUp.bind(this),this._onHueCanvasDown=this._onHueCanvasDown.bind(this),this._onHueCanvasDrag=this._onHueCanvasDrag.bind(this),this._onHueCanvasUp=this._onHueCanvasUp.bind(this),this._onSaturationCanvasDown=this._onSaturationCanvasDown.bind(this),this._onSaturationCanvasDrag=this._onSaturationCanvasDrag.bind(this),this._onSaturationCanvasUp=this._onSaturationCanvasUp.bind(this),this._onElementClick=this._onElementClick.bind(this),this._handleToggle(),this._handleAlphaKnob(),this._handleHueKnob(),this._handleSaturationKnob()}return _inherits(ColorPicker,_EventEmitter),_createClass(ColorPicker,[{key:"_onTransparencyImageLoad",value:function(){this._loaded=!0,this._render()}},{key:"_handleToggle",value:function(){this._element.addEventListener("click",this._onElementClick)}},{key:"_onElementClick",value:function(e){(e.target===this._element||e.target===this._currentColorCanvas)&&(this._visible?(this.hide(),this.emit("hide")):(this.show(),this.emit("show")))}},{key:"hide",value:function(){this._overlay.classList.remove("imglykit-visible"),this._visible=!1}},{key:"show",value:function(){this._overlay.classList.add("imglykit-visible"),this._visible=!0}},{key:"setValue",value:function(value){this._value=value.clone();var _value$toHSV=this._value.toHSV(),_value$toHSV2=_slicedToArray(_value$toHSV,3),h=_value$toHSV2[0],s=_value$toHSV2[1],v=_value$toHSV2[2];this._hsvColor={h:h,s:s,v:v},this._positionKnobs(),this._render()}},{key:"_positionKnobs",value:function(){this._positionAlphaKnob(),this._positionHueKnob(),this._positionSaturationKnob()}},{key:"_positionAlphaKnob",value:function(){var canvas=this._alphaCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),left=this._value.a*canvasSize.x;this._alphaKnob.style.left=""+left+"px"}},{key:"_positionHueKnob",value:function(){var canvas=this._hueCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),top=this._hsvColor.h*canvasSize.y;this._hueKnob.style.top=""+top+"px"}},{key:"_positionSaturationKnob",value:function(){var canvas=this._saturationCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),left=this._hsvColor.s*canvasSize.x;this._saturationKnob.style.left=""+left+"px";var top=(1-this._hsvColor.v)*canvasSize.y;this._saturationKnob.style.top=""+top+"px"}},{key:"_render",value:function(){this._loaded&&(this._renderCurrentColor(),this._renderAlpha(),this._renderHue(),this._renderSaturation())}},{key:"_renderCurrentColor",value:function(){var canvas=this._currentColorCanvas,context=canvas.getContext("2d"),pattern=context.createPattern(this._transparencyImage,"repeat");context.rect(0,0,canvas.width,canvas.height),context.fillStyle=pattern,context.fill(),context.fillStyle=this._value.toRGBA(),context.fill()}},{key:"_renderAlpha",value:function(){var canvas=this._alphaCanvas,context=canvas.getContext("2d"),pattern=context.createPattern(this._transparencyImage,"repeat");context.rect(0,0,canvas.width,canvas.height),context.fillStyle=pattern,context.fill();var gradient=context.createLinearGradient(0,0,canvas.width,canvas.height),color=this._value.clone();color.a=0,gradient.addColorStop(0,color.toRGBA()),gradient.addColorStop(1,this._value.toHex()),context.fillStyle=gradient,context.fill()}},{key:"_renderHue",value:function(){for(var canvas=this._hueCanvas,context=canvas.getContext("2d"),color=new _libColor2["default"],y=0;y<canvas.height;y++){var ratio=y/canvas.height;color.fromHSV(ratio,1,1),context.strokeStyle=color.toRGBA(),context.beginPath(),context.moveTo(0,y),context.lineTo(canvas.width,y),context.stroke()}}},{key:"_renderSaturation",value:function(){for(var canvas=this._saturationCanvas,context=canvas.getContext("2d"),imageData=context.getImageData(0,0,canvas.width,canvas.height),color=new _libColor2["default"](1,0,0,1),y=0;y<canvas.height;y++)for(var value=(canvas.height-y)/canvas.height,x=0;x<canvas.width;x++){var saturation=x/canvas.width;color.fromHSV(this._hsvColor.h,saturation,value);var r=color.r,g=color.g,b=color.b,a=color.a,index=4*(y*canvas.width+x);imageData.data[index]=255*r,imageData.data[index+1]=255*g,imageData.data[index+2]=255*b,imageData.data[index+3]=255*a}context.putImageData(imageData,0,0)}},{key:"_handleAlphaKnob",value:function(){this._alphaCanvas.addEventListener("mousedown",this._onAlphaCanvasDown),this._alphaCanvas.addEventListener("touchstart",this._onAlphaCanvasDown)}},{key:"_onAlphaCanvasDown",value:function(e){e.preventDefault(),this._onAlphaCanvasDrag(e),document.addEventListener("mousemove",this._onAlphaCanvasDrag),document.addEventListener("touchmove",this._onAlphaCanvasDrag),document.addEventListener("mouseup",this._onAlphaCanvasUp),document.addEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_onAlphaCanvasDrag",value:function(e){e.preventDefault();var canvas=this._alphaCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),mousePosition=_libUtils2["default"].getEventPosition(e),_canvas$getBoundingClientRect=canvas.getBoundingClientRect(),left=_canvas$getBoundingClientRect.left,top=_canvas$getBoundingClientRect.top,offset=new _libMathVector22["default"](left,top),relativePosition=mousePosition.subtract(offset);relativePosition.clamp(new _libMathVector22["default"](0,0),canvasSize),this._alphaKnob.style.left=""+relativePosition.x+"px",this._value.a=relativePosition.x/canvasSize.x,this._updateColor()}},{key:"_onAlphaCanvasUp",value:function(){document.removeEventListener("mousemove",this._onAlphaCanvasDrag),document.removeEventListener("touchmove",this._onAlphaCanvasDrag),document.removeEventListener("mouseup",this._onAlphaCanvasUp),document.removeEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_handleHueKnob",value:function(){this._hueCanvas.addEventListener("mousedown",this._onHueCanvasDown),this._hueCanvas.addEventListener("touchstart",this._onHueCanvasDown)}},{key:"_onHueCanvasDown",value:function(e){e.preventDefault(),this._onHueCanvasDrag(e),document.addEventListener("mousemove",this._onHueCanvasDrag),document.addEventListener("touchmove",this._onHueCanvasDrag),document.addEventListener("mouseup",this._onHueCanvasUp),document.addEventListener("touchend",this._onHueCanvasUp)}},{key:"_onHueCanvasDrag",value:function(e){e.preventDefault();var canvas=this._hueCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),mousePosition=_libUtils2["default"].getEventPosition(e),_canvas$getBoundingClientRect2=canvas.getBoundingClientRect(),left=_canvas$getBoundingClientRect2.left,top=_canvas$getBoundingClientRect2.top,offset=new _libMathVector22["default"](left,top),relativePosition=mousePosition.subtract(offset);relativePosition.clamp(new _libMathVector22["default"](0,0),canvasSize),this._hueKnob.style.top=""+relativePosition.y+"px",relativePosition.divide(canvasSize),this._hsvColor.h=relativePosition.y,this._updateColor()}},{key:"_onHueCanvasUp",value:function(){document.removeEventListener("mousemove",this._onHueCanvasDrag),document.removeEventListener("touchmove",this._onHueCanvasDrag),document.removeEventListener("mouseup",this._onHueCanvasUp),document.removeEventListener("touchend",this._onHueCanvasUp)}},{key:"_handleSaturationKnob",value:function(){this._saturationCanvas.addEventListener("mousedown",this._onSaturationCanvasDown),this._saturationCanvas.addEventListener("touchstart",this._onSaturationCanvasDown)}},{key:"_onSaturationCanvasDown",value:function(e){e.preventDefault(),this._onSaturationCanvasDrag(e),document.addEventListener("mousemove",this._onSaturationCanvasDrag),document.addEventListener("touchmove",this._onSaturationCanvasDrag),document.addEventListener("mouseup",this._onSaturationCanvasUp),document.addEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_onSaturationCanvasDrag",value:function(e){e.preventDefault();var canvas=this._saturationCanvas,canvasSize=new _libMathVector22["default"](canvas.width,canvas.height),mousePosition=_libUtils2["default"].getEventPosition(e),_canvas$getBoundingClientRect3=canvas.getBoundingClientRect(),left=_canvas$getBoundingClientRect3.left,top=_canvas$getBoundingClientRect3.top,offset=new _libMathVector22["default"](left,top),relativePosition=mousePosition.subtract(offset);relativePosition.clamp(0,canvas.width),this._saturationKnob.style.left=""+relativePosition.x+"px",this._saturationKnob.style.top=""+relativePosition.y+"px",relativePosition.divide(canvasSize),this._hsvColor.s=relativePosition.x,this._hsvColor.v=1-relativePosition.y,this._updateColor()}},{key:"_onSaturationCanvasUp",value:function(){document.removeEventListener("mousemove",this._onSaturationCanvasDrag),document.removeEventListener("touchmove",this._onSaturationCanvasDrag),document.removeEventListener("mouseup",this._onSaturationCanvasUp),document.removeEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_updateColor",value:function(){this._value.fromHSV(this._hsvColor.h,this._hsvColor.s,this._hsvColor.v),this.emit("update",this._value),this._render()}}],[{key:"template",get:function(){return'{{##def.colorpicker:\n  <div class="imglykit-color-picker" id="{{=(typeof colorpickerId === "undefined"?\'\':colorpickerId)}}">\n    <canvas class="imglykit-color-picker-color" width="34" height="34"></canvas>\n    <div class="imglykit-controls-item-label">{{=(typeof colorpickerLabel === "undefined"?\'\':colorpickerLabel)}}</div>\n\n    <div class="imglykit-color-picker-overlay">\n      <div class="imglykit-color-picker-alpha-container">\n        <canvas class="imglykit-color-picker-alpha" width="200" height="30"></canvas>\n        <div class="imglykit-transparent-knob"></div>\n      </div>\n\n      <div class="imglykit-color-picker-saturation-container">\n        <canvas class="imglykit-color-picker-saturation" width="160" height="160"></canvas>\n        <div class="imglykit-transparent-knob"></div>\n      </div>\n\n      <div class="imglykit-color-picker-hue-container">\n        <canvas class="imglykit-color-picker-hue" width="30" height="160"></canvas>\n        <div class="imglykit-transparent-knob"></div>\n      </div>\n    </div>\n  </div>\n#}}\n'}}]),ColorPicker}(_libEventEmitter2["default"]);exports["default"]=ColorPicker,module.exports=exports["default"]},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";function resolveDefs(c,block,def){return("string"==typeof block?block:block.toString()).replace(c.define||skip,function(m,code,assign,value){return 0===code.indexOf("def.")&&(code=code.substring(4)),code in def||(":"===assign?(c.defineParams&&value.replace(c.defineParams,function(m,param,v){def[code]={arg:param,text:v}}),code in def||(def[code]=value)):new Function("def","def['"+code+"']="+value)(def)),""}).replace(c.use||skip,function(m,code){c.useParams&&(code=code.replace(c.useParams,function(m,s,d,param){if(def[d]&&def[d].arg&&param){var rw=(d+":"+param).replace(/'|\\/g,"_");return def.__exp=def.__exp||{},def.__exp[rw]=def[d].text.replace(new RegExp("(^|[^\\w$])"+def[d].arg+"([^\\w$])","g"),"$1"+param+"$2"),s+"def.__exp['"+rw+"']"}}));var v=new Function("def","return "+code)(def);return v?resolveDefs(c,v,def):v})}function unescape(code){return code.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var _globals,doT={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};doT.encodeHTMLSource=function(doNotSkipEncoded){var encodeHTMLRules={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},matchHTML=doNotSkipEncoded?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(code){return code?code.toString().replace(matchHTML,function(m){return encodeHTMLRules[m]||m}):""}},_globals=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=doT:(__WEBPACK_AMD_DEFINE_RESULT__=function(){return doT}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)));var startend={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},skip=/$^/;doT.template=function(tmpl,c,def){c=c||doT.templateSettings;var needhtmlencode,indv,cse=c.append?startend.append:startend.split,sid=0,str=c.use||c.define?resolveDefs(c,tmpl,def||{}):tmpl;str=("var out='"+(c.strip?str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):str).replace(/'|\\/g,"\\$&").replace(c.interpolate||skip,function(m,code){return cse.start+unescape(code)+cse.end}).replace(c.encode||skip,function(m,code){return needhtmlencode=!0,cse.startencode+unescape(code)+cse.end}).replace(c.conditional||skip,function(m,elsecase,code){return elsecase?code?"';}else if("+unescape(code)+"){out+='":"';}else{out+='":code?"';if("+unescape(code)+"){out+='":"';}out+='"}).replace(c.iterate||skip,function(m,iterate,vname,iname){return iterate?(sid+=1,indv=iname||"i"+sid,iterate=unescape(iterate),"';var arr"+sid+"="+iterate+";if(arr"+sid+"){var "+vname+","+indv+"=-1,l"+sid+"=arr"+sid+".length-1;while("+indv+"<l"+sid+"){"+vname+"=arr"+sid+"["+indv+"+=1];out+='"):"';} } out+='"}).replace(c.evaluate||skip,function(m,code){return"';"+unescape(code)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),needhtmlencode&&(c.selfcontained||!_globals||_globals._encodeHTML||(_globals._encodeHTML=doT.encodeHTMLSource(c.doNotSkipEncoded)),
str="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+doT.encodeHTMLSource.toString()+"("+(c.doNotSkipEncoded||"")+"));"+str);try{return new Function(c.varname,str)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+str),e}},doT.compile=function(tmpl,def){return doT.template(tmpl,null,def)}}()}])});